const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DoZ3Ovpb.js","assets/react-OvXVS5lI.js","assets/three-qq_8ZfES.js","assets/index-DbcP2z3H.css"])))=>i.map(i=>d[i]);
import{r as _d,a as S1,g as _1}from"./react-OvXVS5lI.js";import{M as N1,V as Ne,S as id,C as E1,a as La,T as Ii,Q as Bp,b as Pe,R as M1,P as j1,c as ol,d as qe,O as w1,B as Hn,F as dt,e as Kt,U as sd,W as Fo,H as Ko,N as T1,f as $0,g as $t,A as pt,h as yt,i as C1,j as z1,k as D1,l as R1,m as A1,G as sa,n as In,o as k1,p as Xn,q as Wt,L as Tt,D as W0,r as O1,s as qi,t as al,u as Hi,v as vn,w as U1,x as gn,y as yn,z as Yi,E as rl,I as Gn,J as J0,K as L1,X as eg,Y as B1,Z as P1,_ as I1,$ as ld,a0 as H1,a1 as Pp,a2 as G1,a3 as q1}from"./three-qq_8ZfES.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const c of r)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function l(r){const c={};return r.integrity&&(c.integrity=r.integrity),r.referrerPolicy&&(c.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?c.credentials="include":r.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(r){if(r.ep)return;r.ep=!0;const c=l(r);fetch(r.href,c)}})();var Au={exports:{}},$s={};var Ip;function Y1(){if(Ip)return $s;Ip=1;var a=Symbol.for("react.transitional.element"),i=Symbol.for("react.fragment");function l(o,r,c){var d=null;if(c!==void 0&&(d=""+c),r.key!==void 0&&(d=""+r.key),"key"in r){c={};for(var m in r)m!=="key"&&(c[m]=r[m])}else c=r;return r=c.ref,{$$typeof:a,type:o,key:d,ref:r!==void 0?r:null,props:c}}return $s.Fragment=i,$s.jsx=l,$s.jsxs=l,$s}var Hp;function V1(){return Hp||(Hp=1,Au.exports=Y1()),Au.exports}var f=V1(),j=_d(),ku={exports:{}},Ws={},Ou={exports:{}},Uu={};var Gp;function X1(){return Gp||(Gp=1,(function(a){function i(U,L){var K=U.length;U.push(L);e:for(;0<K;){var fe=K-1>>>1,te=U[fe];if(0<r(te,L))U[fe]=L,U[K]=te,K=fe;else break e}}function l(U){return U.length===0?null:U[0]}function o(U){if(U.length===0)return null;var L=U[0],K=U.pop();if(K!==L){U[0]=K;e:for(var fe=0,te=U.length,Ae=te>>>1;fe<Ae;){var le=2*(fe+1)-1,ye=U[le],Le=le+1,et=U[Le];if(0>r(ye,K))Le<te&&0>r(et,ye)?(U[fe]=et,U[Le]=K,fe=Le):(U[fe]=ye,U[le]=K,fe=le);else if(Le<te&&0>r(et,K))U[fe]=et,U[Le]=K,fe=Le;else break e}}return L}function r(U,L){var K=U.sortIndex-L.sortIndex;return K!==0?K:U.id-L.id}if(a.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;a.unstable_now=function(){return c.now()}}else{var d=Date,m=d.now();a.unstable_now=function(){return d.now()-m}}var p=[],y=[],v=1,g=null,b=3,S=!1,_=!1,N=!1,M=!1,T=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,z=typeof setImmediate<"u"?setImmediate:null;function D(U){for(var L=l(y);L!==null;){if(L.callback===null)o(y);else if(L.startTime<=U)o(y),L.sortIndex=L.expirationTime,i(p,L);else break;L=l(y)}}function A(U){if(N=!1,D(U),!_)if(l(p)!==null)_=!0,q||(q=!0,ee());else{var L=l(y);L!==null&&Ee(A,L.startTime-U)}}var q=!1,I=-1,G=5,F=-1;function Z(){return M?!0:!(a.unstable_now()-F<G)}function J(){if(M=!1,q){var U=a.unstable_now();F=U;var L=!0;try{e:{_=!1,N&&(N=!1,w(I),I=-1),S=!0;var K=b;try{t:{for(D(U),g=l(p);g!==null&&!(g.expirationTime>U&&Z());){var fe=g.callback;if(typeof fe=="function"){g.callback=null,b=g.priorityLevel;var te=fe(g.expirationTime<=U);if(U=a.unstable_now(),typeof te=="function"){g.callback=te,D(U),L=!0;break t}g===l(p)&&o(p),D(U)}else o(p);g=l(p)}if(g!==null)L=!0;else{var Ae=l(y);Ae!==null&&Ee(A,Ae.startTime-U),L=!1}}break e}finally{g=null,b=K,S=!1}L=void 0}}finally{L?ee():q=!1}}}var ee;if(typeof z=="function")ee=function(){z(J)};else if(typeof MessageChannel<"u"){var re=new MessageChannel,de=re.port2;re.port1.onmessage=J,ee=function(){de.postMessage(null)}}else ee=function(){T(J,0)};function Ee(U,L){I=T(function(){U(a.unstable_now())},L)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(U){U.callback=null},a.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):G=0<U?Math.floor(1e3/U):5},a.unstable_getCurrentPriorityLevel=function(){return b},a.unstable_next=function(U){switch(b){case 1:case 2:case 3:var L=3;break;default:L=b}var K=b;b=L;try{return U()}finally{b=K}},a.unstable_requestPaint=function(){M=!0},a.unstable_runWithPriority=function(U,L){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var K=b;b=U;try{return L()}finally{b=K}},a.unstable_scheduleCallback=function(U,L,K){var fe=a.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?fe+K:fe):K=fe,U){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return te=K+te,U={id:v++,callback:L,priorityLevel:U,startTime:K,expirationTime:te,sortIndex:-1},K>fe?(U.sortIndex=K,i(y,U),l(p)===null&&U===l(y)&&(N?(w(I),I=-1):N=!0,Ee(A,K-fe))):(U.sortIndex=te,i(p,U),_||S||(_=!0,q||(q=!0,ee()))),U},a.unstable_shouldYield=Z,a.unstable_wrapCallback=function(U){var L=b;return function(){var K=b;b=L;try{return U.apply(this,arguments)}finally{b=K}}}})(Uu)),Uu}var qp;function Q1(){return qp||(qp=1,Ou.exports=X1()),Ou.exports}var Yp;function Z1(){if(Yp)return Ws;Yp=1;var a=Q1(),i=_d(),l=S1();function o(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function c(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function d(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function m(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function p(e){if(c(e)!==e)throw Error(o(188))}function y(e){var t=e.alternate;if(!t){if(t=c(e),t===null)throw Error(o(188));return t!==e?null:e}for(var n=e,s=t;;){var u=n.return;if(u===null)break;var h=u.alternate;if(h===null){if(s=u.return,s!==null){n=s;continue}break}if(u.child===h.child){for(h=u.child;h;){if(h===n)return p(u),e;if(h===s)return p(u),t;h=h.sibling}throw Error(o(188))}if(n.return!==s.return)n=u,s=h;else{for(var x=!1,E=u.child;E;){if(E===n){x=!0,n=u,s=h;break}if(E===s){x=!0,s=u,n=h;break}E=E.sibling}if(!x){for(E=h.child;E;){if(E===n){x=!0,n=h,s=u;break}if(E===s){x=!0,s=h,n=u;break}E=E.sibling}if(!x)throw Error(o(189))}}if(n.alternate!==s)throw Error(o(190))}if(n.tag!==3)throw Error(o(188));return n.stateNode.current===n?e:t}function v(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=v(e),t!==null)return t;e=e.sibling}return null}var g=Object.assign,b=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),w=Symbol.for("react.consumer"),z=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),q=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),G=Symbol.for("react.lazy"),F=Symbol.for("react.activity"),Z=Symbol.for("react.memo_cache_sentinel"),J=Symbol.iterator;function ee(e){return e===null||typeof e!="object"?null:(e=J&&e[J]||e["@@iterator"],typeof e=="function"?e:null)}var re=Symbol.for("react.client.reference");function de(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===re?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case N:return"Fragment";case T:return"Profiler";case M:return"StrictMode";case A:return"Suspense";case q:return"SuspenseList";case F:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case _:return"Portal";case z:return e.displayName||"Context";case w:return(e._context.displayName||"Context")+".Consumer";case D:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case I:return t=e.displayName||null,t!==null?t:de(e.type)||"Memo";case G:t=e._payload,e=e._init;try{return de(e(t))}catch{}}return null}var Ee=Array.isArray,U=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L=l.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K={pending:!1,data:null,method:null,action:null},fe=[],te=-1;function Ae(e){return{current:e}}function le(e){0>te||(e.current=fe[te],fe[te]=null,te--)}function ye(e,t){te++,fe[te]=e.current,e.current=t}var Le=Ae(null),et=Ae(null),vt=Ae(null),Qn=Ae(null);function Sn(e,t){switch(ye(vt,t),ye(et,e),ye(Le,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?op(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=op(t),e=rp(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}le(Le),ye(Le,e)}function ga(){le(Le),le(et),le(vt)}function Zn(e){e.memoizedState!==null&&ye(Qn,e);var t=Le.current,n=rp(t,e.type);t!==n&&(ye(et,e),ye(Le,n))}function ct(e){et.current===e&&(le(Le),le(et)),Qn.current===e&&(le(Qn),Qs._currentValue=K)}var tt,Wi;function oa(e){if(tt===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);tt=t&&t[1]||"",Wi=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+tt+e+Wi}var Ji=!1;function es(e,t){if(!e||Ji)return"";Ji=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var s={DetermineComponentFrameRoot:function(){try{if(t){var Q=function(){throw Error()};if(Object.defineProperty(Q.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Q,[])}catch(Y){var H=Y}Reflect.construct(e,[],Q)}else{try{Q.call()}catch(Y){H=Y}e.call(Q.prototype)}}else{try{throw Error()}catch(Y){H=Y}(Q=e())&&typeof Q.catch=="function"&&Q.catch(function(){})}}catch(Y){if(Y&&H&&typeof Y.stack=="string")return[Y.stack,H.stack]}return[null,null]}};s.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var u=Object.getOwnPropertyDescriptor(s.DetermineComponentFrameRoot,"name");u&&u.configurable&&Object.defineProperty(s.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var h=s.DetermineComponentFrameRoot(),x=h[0],E=h[1];if(x&&E){var C=x.split(`
`),P=E.split(`
`);for(u=s=0;s<C.length&&!C[s].includes("DetermineComponentFrameRoot");)s++;for(;u<P.length&&!P[u].includes("DetermineComponentFrameRoot");)u++;if(s===C.length||u===P.length)for(s=C.length-1,u=P.length-1;1<=s&&0<=u&&C[s]!==P[u];)u--;for(;1<=s&&0<=u;s--,u--)if(C[s]!==P[u]){if(s!==1||u!==1)do if(s--,u--,0>u||C[s]!==P[u]){var V=`
`+C[s].replace(" at new "," at ");return e.displayName&&V.includes("<anonymous>")&&(V=V.replace("<anonymous>",e.displayName)),V}while(1<=s&&0<=u);break}}}finally{Ji=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?oa(n):""}function _l(e,t){switch(e.tag){case 26:case 27:case 5:return oa(e.type);case 16:return oa("Lazy");case 13:return e.child!==t&&t!==null?oa("Suspense Fallback"):oa("Suspense");case 19:return oa("SuspenseList");case 0:case 15:return es(e.type,!1);case 11:return es(e.type.render,!1);case 1:return es(e.type,!0);case 31:return oa("Activity");default:return""}}function ts(e){try{var t="",n=null;do t+=_l(e,n),n=e,e=e.return;while(e);return t}catch(s){return`
Error generating stack: `+s.message+`
`+s.stack}}var Fn=Object.prototype.hasOwnProperty,as=a.unstable_scheduleCallback,ns=a.unstable_cancelCallback,yr=a.unstable_shouldYield,vr=a.unstable_requestPaint,ft=a.unstable_now,br=a.unstable_getCurrentPriorityLevel,Nl=a.unstable_ImmediatePriority,El=a.unstable_UserBlockingPriority,ra=a.unstable_NormalPriority,is=a.unstable_LowPriority,ss=a.unstable_IdlePriority,xr=a.log,Sr=a.unstable_setDisableYieldValue,Ga=null,ut=null;function ca(e){if(typeof xr=="function"&&Sr(e),ut&&typeof ut.setStrictMode=="function")try{ut.setStrictMode(Ga,e)}catch{}}var at=Math.clz32?Math.clz32:se,ls=Math.log,Yd=Math.LN2;function se(e){return e>>>=0,e===0?32:31-(ls(e)/Yd|0)|0}var Kn=256,$n=262144,qa=4194304;function ya(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Wn(e,t,n){var s=e.pendingLanes;if(s===0)return 0;var u=0,h=e.suspendedLanes,x=e.pingedLanes;e=e.warmLanes;var E=s&134217727;return E!==0?(s=E&~h,s!==0?u=ya(s):(x&=E,x!==0?u=ya(x):n||(n=E&~e,n!==0&&(u=ya(n))))):(E=s&~h,E!==0?u=ya(E):x!==0?u=ya(x):n||(n=s&~e,n!==0&&(u=ya(n)))),u===0?0:t!==0&&t!==u&&(t&h)===0&&(h=u&-u,n=t&-t,h>=n||h===32&&(n&4194048)!==0)?t:u}function ua(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function _r(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function va(){var e=qa;return qa<<=1,(qa&62914560)===0&&(qa=4194304),e}function bt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function O(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function oe(e,t,n,s,u,h){var x=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var E=e.entanglements,C=e.expirationTimes,P=e.hiddenUpdates;for(n=x&~n;0<n;){var V=31-at(n),Q=1<<V;E[V]=0,C[V]=-1;var H=P[V];if(H!==null)for(P[V]=null,V=0;V<H.length;V++){var Y=H[V];Y!==null&&(Y.lane&=-536870913)}n&=~Q}s!==0&&ht(e,s,0),h!==0&&u===0&&e.tag!==0&&(e.suspendedLanes|=h&~(x&~t))}function ht(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var s=31-at(t);e.entangledLanes|=t,e.entanglements[s]=e.entanglements[s]|1073741824|n&261930}function Ct(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var s=31-at(n),u=1<<s;u&t|e[s]&t&&(e[s]|=t),n&=~u}}function Jn(e,t){var n=t&-t;return n=(n&42)!==0?1:os(n),(n&(e.suspendedLanes|t))!==0?0:n}function os(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Nr(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Vd(){var e=L.p;return e!==0?e:(e=window.event,e===void 0?32:Dp(e.type))}function Xd(e,t){var n=L.p;try{return L.p=e,t()}finally{L.p=n}}var Ya=Math.random().toString(36).slice(2),nt="__reactFiber$"+Ya,xt="__reactProps$"+Ya,ei="__reactContainer$"+Ya,Er="__reactEvents$"+Ya,uy="__reactListeners$"+Ya,dy="__reactHandles$"+Ya,Qd="__reactResources$"+Ya,rs="__reactMarker$"+Ya;function Mr(e){delete e[nt],delete e[xt],delete e[Er],delete e[uy],delete e[dy]}function ti(e){var t=e[nt];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ei]||n[nt]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=pp(e);e!==null;){if(n=e[nt])return n;e=pp(e)}return t}e=n,n=e.parentNode}return null}function ai(e){if(e=e[nt]||e[ei]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function cs(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(o(33))}function ni(e){var t=e[Qd];return t||(t=e[Qd]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function We(e){e[rs]=!0}var Zd=new Set,Fd={};function _n(e,t){ii(e,t),ii(e+"Capture",t)}function ii(e,t){for(Fd[e]=t,e=0;e<t.length;e++)Zd.add(t[e])}var fy=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Kd={},$d={};function hy(e){return Fn.call($d,e)?!0:Fn.call(Kd,e)?!1:fy.test(e)?$d[e]=!0:(Kd[e]=!0,!1)}function Ml(e,t,n){if(hy(t))if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var s=t.toLowerCase().slice(0,5);if(s!=="data-"&&s!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+n)}}function jl(e,t,n){if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+n)}}function ba(e,t,n,s){if(s===null)e.removeAttribute(n);else{switch(typeof s){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttributeNS(t,n,""+s)}}function Pt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Wd(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function my(e,t,n){var s=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var u=s.get,h=s.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return u.call(this)},set:function(x){n=""+x,h.call(this,x)}}),Object.defineProperty(e,t,{enumerable:s.enumerable}),{getValue:function(){return n},setValue:function(x){n=""+x},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function jr(e){if(!e._valueTracker){var t=Wd(e)?"checked":"value";e._valueTracker=my(e,t,""+e[t])}}function Jd(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),s="";return e&&(s=Wd(e)?e.checked?"true":"false":e.value),e=s,e!==n?(t.setValue(e),!0):!1}function wl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var py=/[\n"\\]/g;function It(e){return e.replace(py,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function wr(e,t,n,s,u,h,x,E){e.name="",x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?e.type=x:e.removeAttribute("type"),t!=null?x==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+Pt(t)):e.value!==""+Pt(t)&&(e.value=""+Pt(t)):x!=="submit"&&x!=="reset"||e.removeAttribute("value"),t!=null?Tr(e,x,Pt(t)):n!=null?Tr(e,x,Pt(n)):s!=null&&e.removeAttribute("value"),u==null&&h!=null&&(e.defaultChecked=!!h),u!=null&&(e.checked=u&&typeof u!="function"&&typeof u!="symbol"),E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?e.name=""+Pt(E):e.removeAttribute("name")}function ef(e,t,n,s,u,h,x,E){if(h!=null&&typeof h!="function"&&typeof h!="symbol"&&typeof h!="boolean"&&(e.type=h),t!=null||n!=null){if(!(h!=="submit"&&h!=="reset"||t!=null)){jr(e);return}n=n!=null?""+Pt(n):"",t=t!=null?""+Pt(t):n,E||t===e.value||(e.value=t),e.defaultValue=t}s=s??u,s=typeof s!="function"&&typeof s!="symbol"&&!!s,e.checked=E?e.checked:!!s,e.defaultChecked=!!s,x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(e.name=x),jr(e)}function Tr(e,t,n){t==="number"&&wl(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function si(e,t,n,s){if(e=e.options,t){t={};for(var u=0;u<n.length;u++)t["$"+n[u]]=!0;for(n=0;n<e.length;n++)u=t.hasOwnProperty("$"+e[n].value),e[n].selected!==u&&(e[n].selected=u),u&&s&&(e[n].defaultSelected=!0)}else{for(n=""+Pt(n),t=null,u=0;u<e.length;u++){if(e[u].value===n){e[u].selected=!0,s&&(e[u].defaultSelected=!0);return}t!==null||e[u].disabled||(t=e[u])}t!==null&&(t.selected=!0)}}function tf(e,t,n){if(t!=null&&(t=""+Pt(t),t!==e.value&&(e.value=t),n==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=n!=null?""+Pt(n):""}function af(e,t,n,s){if(t==null){if(s!=null){if(n!=null)throw Error(o(92));if(Ee(s)){if(1<s.length)throw Error(o(93));s=s[0]}n=s}n==null&&(n=""),t=n}n=Pt(t),e.defaultValue=n,s=e.textContent,s===n&&s!==""&&s!==null&&(e.value=s),jr(e)}function li(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var gy=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function nf(e,t,n){var s=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?s?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":s?e.setProperty(t,n):typeof n!="number"||n===0||gy.has(t)?t==="float"?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function sf(e,t,n){if(t!=null&&typeof t!="object")throw Error(o(62));if(e=e.style,n!=null){for(var s in n)!n.hasOwnProperty(s)||t!=null&&t.hasOwnProperty(s)||(s.indexOf("--")===0?e.setProperty(s,""):s==="float"?e.cssFloat="":e[s]="");for(var u in t)s=t[u],t.hasOwnProperty(u)&&n[u]!==s&&nf(e,u,s)}else for(var h in t)t.hasOwnProperty(h)&&nf(e,h,t[h])}function Cr(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yy=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),vy=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Tl(e){return vy.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function xa(){}var zr=null;function Dr(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var oi=null,ri=null;function lf(e){var t=ai(e);if(t&&(e=t.stateNode)){var n=e[xt]||null;e:switch(e=t.stateNode,t.type){case"input":if(wr(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+It(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var s=n[t];if(s!==e&&s.form===e.form){var u=s[xt]||null;if(!u)throw Error(o(90));wr(s,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name)}}for(t=0;t<n.length;t++)s=n[t],s.form===e.form&&Jd(s)}break e;case"textarea":tf(e,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&si(e,!!n.multiple,t,!1)}}}var Rr=!1;function of(e,t,n){if(Rr)return e(t,n);Rr=!0;try{var s=e(t);return s}finally{if(Rr=!1,(oi!==null||ri!==null)&&(go(),oi&&(t=oi,e=ri,ri=oi=null,lf(t),e)))for(t=0;t<e.length;t++)lf(e[t])}}function us(e,t){var n=e.stateNode;if(n===null)return null;var s=n[xt]||null;if(s===null)return null;n=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(o(231,t,typeof n));return n}var Sa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ar=!1;if(Sa)try{var ds={};Object.defineProperty(ds,"passive",{get:function(){Ar=!0}}),window.addEventListener("test",ds,ds),window.removeEventListener("test",ds,ds)}catch{Ar=!1}var Va=null,kr=null,Cl=null;function rf(){if(Cl)return Cl;var e,t=kr,n=t.length,s,u="value"in Va?Va.value:Va.textContent,h=u.length;for(e=0;e<n&&t[e]===u[e];e++);var x=n-e;for(s=1;s<=x&&t[n-s]===u[h-s];s++);return Cl=u.slice(e,1<s?1-s:void 0)}function zl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Dl(){return!0}function cf(){return!1}function St(e){function t(n,s,u,h,x){this._reactName=n,this._targetInst=u,this.type=s,this.nativeEvent=h,this.target=x,this.currentTarget=null;for(var E in e)e.hasOwnProperty(E)&&(n=e[E],this[E]=n?n(h):h[E]);return this.isDefaultPrevented=(h.defaultPrevented!=null?h.defaultPrevented:h.returnValue===!1)?Dl:cf,this.isPropagationStopped=cf,this}return g(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Dl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Dl)},persist:function(){},isPersistent:Dl}),t}var Nn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Rl=St(Nn),fs=g({},Nn,{view:0,detail:0}),by=St(fs),Or,Ur,hs,Al=g({},fs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Br,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==hs&&(hs&&e.type==="mousemove"?(Or=e.screenX-hs.screenX,Ur=e.screenY-hs.screenY):Ur=Or=0,hs=e),Or)},movementY:function(e){return"movementY"in e?e.movementY:Ur}}),uf=St(Al),xy=g({},Al,{dataTransfer:0}),Sy=St(xy),_y=g({},fs,{relatedTarget:0}),Lr=St(_y),Ny=g({},Nn,{animationName:0,elapsedTime:0,pseudoElement:0}),Ey=St(Ny),My=g({},Nn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),jy=St(My),wy=g({},Nn,{data:0}),df=St(wy),Ty={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Cy={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zy={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Dy(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=zy[e])?!!t[e]:!1}function Br(){return Dy}var Ry=g({},fs,{key:function(e){if(e.key){var t=Ty[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=zl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Cy[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Br,charCode:function(e){return e.type==="keypress"?zl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?zl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Ay=St(Ry),ky=g({},Al,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ff=St(ky),Oy=g({},fs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Br}),Uy=St(Oy),Ly=g({},Nn,{propertyName:0,elapsedTime:0,pseudoElement:0}),By=St(Ly),Py=g({},Al,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Iy=St(Py),Hy=g({},Nn,{newState:0,oldState:0}),Gy=St(Hy),qy=[9,13,27,32],Pr=Sa&&"CompositionEvent"in window,ms=null;Sa&&"documentMode"in document&&(ms=document.documentMode);var Yy=Sa&&"TextEvent"in window&&!ms,hf=Sa&&(!Pr||ms&&8<ms&&11>=ms),mf=" ",pf=!1;function gf(e,t){switch(e){case"keyup":return qy.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function yf(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ci=!1;function Vy(e,t){switch(e){case"compositionend":return yf(t);case"keypress":return t.which!==32?null:(pf=!0,mf);case"textInput":return e=t.data,e===mf&&pf?null:e;default:return null}}function Xy(e,t){if(ci)return e==="compositionend"||!Pr&&gf(e,t)?(e=rf(),Cl=kr=Va=null,ci=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return hf&&t.locale!=="ko"?null:t.data;default:return null}}var Qy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function vf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Qy[e.type]:t==="textarea"}function bf(e,t,n,s){oi?ri?ri.push(s):ri=[s]:oi=s,t=No(t,"onChange"),0<t.length&&(n=new Rl("onChange","change",null,n,s),e.push({event:n,listeners:t}))}var ps=null,gs=null;function Zy(e){tp(e,0)}function kl(e){var t=cs(e);if(Jd(t))return e}function xf(e,t){if(e==="change")return t}var Sf=!1;if(Sa){var Ir;if(Sa){var Hr="oninput"in document;if(!Hr){var _f=document.createElement("div");_f.setAttribute("oninput","return;"),Hr=typeof _f.oninput=="function"}Ir=Hr}else Ir=!1;Sf=Ir&&(!document.documentMode||9<document.documentMode)}function Nf(){ps&&(ps.detachEvent("onpropertychange",Ef),gs=ps=null)}function Ef(e){if(e.propertyName==="value"&&kl(gs)){var t=[];bf(t,gs,e,Dr(e)),of(Zy,t)}}function Fy(e,t,n){e==="focusin"?(Nf(),ps=t,gs=n,ps.attachEvent("onpropertychange",Ef)):e==="focusout"&&Nf()}function Ky(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return kl(gs)}function $y(e,t){if(e==="click")return kl(t)}function Wy(e,t){if(e==="input"||e==="change")return kl(t)}function Jy(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var zt=typeof Object.is=="function"?Object.is:Jy;function ys(e,t){if(zt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var u=n[s];if(!Fn.call(t,u)||!zt(e[u],t[u]))return!1}return!0}function Mf(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function jf(e,t){var n=Mf(e);e=0;for(var s;n;){if(n.nodeType===3){if(s=e+n.textContent.length,e<=t&&s>=t)return{node:n,offset:t-e};e=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Mf(n)}}function wf(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?wf(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Tf(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=wl(e.document);t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=wl(e.document)}return t}function Gr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var ev=Sa&&"documentMode"in document&&11>=document.documentMode,ui=null,qr=null,vs=null,Yr=!1;function Cf(e,t,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Yr||ui==null||ui!==wl(s)||(s=ui,"selectionStart"in s&&Gr(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),vs&&ys(vs,s)||(vs=s,s=No(qr,"onSelect"),0<s.length&&(t=new Rl("onSelect","select",null,t,n),e.push({event:t,listeners:s}),t.target=ui)))}function En(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var di={animationend:En("Animation","AnimationEnd"),animationiteration:En("Animation","AnimationIteration"),animationstart:En("Animation","AnimationStart"),transitionrun:En("Transition","TransitionRun"),transitionstart:En("Transition","TransitionStart"),transitioncancel:En("Transition","TransitionCancel"),transitionend:En("Transition","TransitionEnd")},Vr={},zf={};Sa&&(zf=document.createElement("div").style,"AnimationEvent"in window||(delete di.animationend.animation,delete di.animationiteration.animation,delete di.animationstart.animation),"TransitionEvent"in window||delete di.transitionend.transition);function Mn(e){if(Vr[e])return Vr[e];if(!di[e])return e;var t=di[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in zf)return Vr[e]=t[n];return e}var Df=Mn("animationend"),Rf=Mn("animationiteration"),Af=Mn("animationstart"),tv=Mn("transitionrun"),av=Mn("transitionstart"),nv=Mn("transitioncancel"),kf=Mn("transitionend"),Of=new Map,Xr="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Xr.push("scrollEnd");function ea(e,t){Of.set(e,t),_n(t,[e])}var Ol=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},Ht=[],fi=0,Qr=0;function Ul(){for(var e=fi,t=Qr=fi=0;t<e;){var n=Ht[t];Ht[t++]=null;var s=Ht[t];Ht[t++]=null;var u=Ht[t];Ht[t++]=null;var h=Ht[t];if(Ht[t++]=null,s!==null&&u!==null){var x=s.pending;x===null?u.next=u:(u.next=x.next,x.next=u),s.pending=u}h!==0&&Uf(n,u,h)}}function Ll(e,t,n,s){Ht[fi++]=e,Ht[fi++]=t,Ht[fi++]=n,Ht[fi++]=s,Qr|=s,e.lanes|=s,e=e.alternate,e!==null&&(e.lanes|=s)}function Zr(e,t,n,s){return Ll(e,t,n,s),Bl(e)}function jn(e,t){return Ll(e,null,null,t),Bl(e)}function Uf(e,t,n){e.lanes|=n;var s=e.alternate;s!==null&&(s.lanes|=n);for(var u=!1,h=e.return;h!==null;)h.childLanes|=n,s=h.alternate,s!==null&&(s.childLanes|=n),h.tag===22&&(e=h.stateNode,e===null||e._visibility&1||(u=!0)),e=h,h=h.return;return e.tag===3?(h=e.stateNode,u&&t!==null&&(u=31-at(n),e=h.hiddenUpdates,s=e[u],s===null?e[u]=[t]:s.push(t),t.lane=n|536870912),h):null}function Bl(e){if(50<Is)throw Is=0,nu=null,Error(o(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var hi={};function iv(e,t,n,s){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dt(e,t,n,s){return new iv(e,t,n,s)}function Fr(e){return e=e.prototype,!(!e||!e.isReactComponent)}function _a(e,t){var n=e.alternate;return n===null?(n=Dt(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&65011712,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function Lf(e,t){e.flags&=65011714;var n=e.alternate;return n===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Pl(e,t,n,s,u,h){var x=0;if(s=e,typeof e=="function")Fr(e)&&(x=1);else if(typeof e=="string")x=c1(e,n,Le.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case F:return e=Dt(31,n,t,u),e.elementType=F,e.lanes=h,e;case N:return wn(n.children,u,h,t);case M:x=8,u|=24;break;case T:return e=Dt(12,n,t,u|2),e.elementType=T,e.lanes=h,e;case A:return e=Dt(13,n,t,u),e.elementType=A,e.lanes=h,e;case q:return e=Dt(19,n,t,u),e.elementType=q,e.lanes=h,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case z:x=10;break e;case w:x=9;break e;case D:x=11;break e;case I:x=14;break e;case G:x=16,s=null;break e}x=29,n=Error(o(130,e===null?"null":typeof e,"")),s=null}return t=Dt(x,n,t,u),t.elementType=e,t.type=s,t.lanes=h,t}function wn(e,t,n,s){return e=Dt(7,e,s,t),e.lanes=n,e}function Kr(e,t,n){return e=Dt(6,e,null,t),e.lanes=n,e}function Bf(e){var t=Dt(18,null,null,0);return t.stateNode=e,t}function $r(e,t,n){return t=Dt(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Pf=new WeakMap;function Gt(e,t){if(typeof e=="object"&&e!==null){var n=Pf.get(e);return n!==void 0?n:(t={value:e,source:t,stack:ts(t)},Pf.set(e,t),t)}return{value:e,source:t,stack:ts(t)}}var mi=[],pi=0,Il=null,bs=0,qt=[],Yt=0,Xa=null,da=1,fa="";function Na(e,t){mi[pi++]=bs,mi[pi++]=Il,Il=e,bs=t}function If(e,t,n){qt[Yt++]=da,qt[Yt++]=fa,qt[Yt++]=Xa,Xa=e;var s=da;e=fa;var u=32-at(s)-1;s&=~(1<<u),n+=1;var h=32-at(t)+u;if(30<h){var x=u-u%5;h=(s&(1<<x)-1).toString(32),s>>=x,u-=x,da=1<<32-at(t)+u|n<<u|s,fa=h+e}else da=1<<h|n<<u|s,fa=e}function Wr(e){e.return!==null&&(Na(e,1),If(e,1,0))}function Jr(e){for(;e===Il;)Il=mi[--pi],mi[pi]=null,bs=mi[--pi],mi[pi]=null;for(;e===Xa;)Xa=qt[--Yt],qt[Yt]=null,fa=qt[--Yt],qt[Yt]=null,da=qt[--Yt],qt[Yt]=null}function Hf(e,t){qt[Yt++]=da,qt[Yt++]=fa,qt[Yt++]=Xa,da=t.id,fa=t.overflow,Xa=e}var it=null,Oe=null,ve=!1,Qa=null,Vt=!1,ec=Error(o(519));function Za(e){var t=Error(o(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw xs(Gt(t,e)),ec}function Gf(e){var t=e.stateNode,n=e.type,s=e.memoizedProps;switch(t[nt]=e,t[xt]=s,n){case"dialog":me("cancel",t),me("close",t);break;case"iframe":case"object":case"embed":me("load",t);break;case"video":case"audio":for(n=0;n<Gs.length;n++)me(Gs[n],t);break;case"source":me("error",t);break;case"img":case"image":case"link":me("error",t),me("load",t);break;case"details":me("toggle",t);break;case"input":me("invalid",t),ef(t,s.value,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name,!0);break;case"select":me("invalid",t);break;case"textarea":me("invalid",t),af(t,s.value,s.defaultValue,s.children)}n=s.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||s.suppressHydrationWarning===!0||sp(t.textContent,n)?(s.popover!=null&&(me("beforetoggle",t),me("toggle",t)),s.onScroll!=null&&me("scroll",t),s.onScrollEnd!=null&&me("scrollend",t),s.onClick!=null&&(t.onclick=xa),t=!0):t=!1,t||Za(e,!0)}function qf(e){for(it=e.return;it;)switch(it.tag){case 5:case 31:case 13:Vt=!1;return;case 27:case 3:Vt=!0;return;default:it=it.return}}function gi(e){if(e!==it)return!1;if(!ve)return qf(e),ve=!0,!1;var t=e.tag,n;if((n=t!==3&&t!==27)&&((n=t===5)&&(n=e.type,n=!(n!=="form"&&n!=="button")||vu(e.type,e.memoizedProps)),n=!n),n&&Oe&&Za(e),qf(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(o(317));Oe=mp(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(o(317));Oe=mp(e)}else t===27?(t=Oe,cn(e.type)?(e=Nu,Nu=null,Oe=e):Oe=t):Oe=it?Qt(e.stateNode.nextSibling):null;return!0}function Tn(){Oe=it=null,ve=!1}function tc(){var e=Qa;return e!==null&&(Mt===null?Mt=e:Mt.push.apply(Mt,e),Qa=null),e}function xs(e){Qa===null?Qa=[e]:Qa.push(e)}var ac=Ae(null),Cn=null,Ea=null;function Fa(e,t,n){ye(ac,t._currentValue),t._currentValue=n}function Ma(e){e._currentValue=ac.current,le(ac)}function nc(e,t,n){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===n)break;e=e.return}}function ic(e,t,n,s){var u=e.child;for(u!==null&&(u.return=e);u!==null;){var h=u.dependencies;if(h!==null){var x=u.child;h=h.firstContext;e:for(;h!==null;){var E=h;h=u;for(var C=0;C<t.length;C++)if(E.context===t[C]){h.lanes|=n,E=h.alternate,E!==null&&(E.lanes|=n),nc(h.return,n,e),s||(x=null);break e}h=E.next}}else if(u.tag===18){if(x=u.return,x===null)throw Error(o(341));x.lanes|=n,h=x.alternate,h!==null&&(h.lanes|=n),nc(x,n,e),x=null}else x=u.child;if(x!==null)x.return=u;else for(x=u;x!==null;){if(x===e){x=null;break}if(u=x.sibling,u!==null){u.return=x.return,x=u;break}x=x.return}u=x}}function yi(e,t,n,s){e=null;for(var u=t,h=!1;u!==null;){if(!h){if((u.flags&524288)!==0)h=!0;else if((u.flags&262144)!==0)break}if(u.tag===10){var x=u.alternate;if(x===null)throw Error(o(387));if(x=x.memoizedProps,x!==null){var E=u.type;zt(u.pendingProps.value,x.value)||(e!==null?e.push(E):e=[E])}}else if(u===Qn.current){if(x=u.alternate,x===null)throw Error(o(387));x.memoizedState.memoizedState!==u.memoizedState.memoizedState&&(e!==null?e.push(Qs):e=[Qs])}u=u.return}e!==null&&ic(t,e,n,s),t.flags|=262144}function Hl(e){for(e=e.firstContext;e!==null;){if(!zt(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function zn(e){Cn=e,Ea=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function st(e){return Yf(Cn,e)}function Gl(e,t){return Cn===null&&zn(e),Yf(e,t)}function Yf(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},Ea===null){if(e===null)throw Error(o(308));Ea=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Ea=Ea.next=t;return n}var sv=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(n,s){e.push(s)}};this.abort=function(){t.aborted=!0,e.forEach(function(n){return n()})}},lv=a.unstable_scheduleCallback,ov=a.unstable_NormalPriority,Xe={$$typeof:z,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function sc(){return{controller:new sv,data:new Map,refCount:0}}function Ss(e){e.refCount--,e.refCount===0&&lv(ov,function(){e.controller.abort()})}var _s=null,lc=0,vi=0,bi=null;function rv(e,t){if(_s===null){var n=_s=[];lc=0,vi=cu(),bi={status:"pending",value:void 0,then:function(s){n.push(s)}}}return lc++,t.then(Vf,Vf),t}function Vf(){if(--lc===0&&_s!==null){bi!==null&&(bi.status="fulfilled");var e=_s;_s=null,vi=0,bi=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function cv(e,t){var n=[],s={status:"pending",value:null,reason:null,then:function(u){n.push(u)}};return e.then(function(){s.status="fulfilled",s.value=t;for(var u=0;u<n.length;u++)(0,n[u])(t)},function(u){for(s.status="rejected",s.reason=u,u=0;u<n.length;u++)(0,n[u])(void 0)}),s}var Xf=U.S;U.S=function(e,t){Cm=ft(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&rv(e,t),Xf!==null&&Xf(e,t)};var Dn=Ae(null);function oc(){var e=Dn.current;return e!==null?e:ke.pooledCache}function ql(e,t){t===null?ye(Dn,Dn.current):ye(Dn,t.pool)}function Qf(){var e=oc();return e===null?null:{parent:Xe._currentValue,pool:e}}var xi=Error(o(460)),rc=Error(o(474)),Yl=Error(o(542)),Vl={then:function(){}};function Zf(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Ff(e,t,n){switch(n=e[n],n===void 0?e.push(t):n!==t&&(t.then(xa,xa),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,$f(e),e;default:if(typeof t.status=="string")t.then(xa,xa);else{if(e=ke,e!==null&&100<e.shellSuspendCounter)throw Error(o(482));e=t,e.status="pending",e.then(function(s){if(t.status==="pending"){var u=t;u.status="fulfilled",u.value=s}},function(s){if(t.status==="pending"){var u=t;u.status="rejected",u.reason=s}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,$f(e),e}throw An=t,xi}}function Rn(e){try{var t=e._init;return t(e._payload)}catch(n){throw n!==null&&typeof n=="object"&&typeof n.then=="function"?(An=n,xi):n}}var An=null;function Kf(){if(An===null)throw Error(o(459));var e=An;return An=null,e}function $f(e){if(e===xi||e===Yl)throw Error(o(483))}var Si=null,Ns=0;function Xl(e){var t=Ns;return Ns+=1,Si===null&&(Si=[]),Ff(Si,e,t)}function Es(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function Ql(e,t){throw t.$$typeof===b?Error(o(525)):(e=Object.prototype.toString.call(t),Error(o(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Wf(e){function t(k,R){if(e){var B=k.deletions;B===null?(k.deletions=[R],k.flags|=16):B.push(R)}}function n(k,R){if(!e)return null;for(;R!==null;)t(k,R),R=R.sibling;return null}function s(k){for(var R=new Map;k!==null;)k.key!==null?R.set(k.key,k):R.set(k.index,k),k=k.sibling;return R}function u(k,R){return k=_a(k,R),k.index=0,k.sibling=null,k}function h(k,R,B){return k.index=B,e?(B=k.alternate,B!==null?(B=B.index,B<R?(k.flags|=67108866,R):B):(k.flags|=67108866,R)):(k.flags|=1048576,R)}function x(k){return e&&k.alternate===null&&(k.flags|=67108866),k}function E(k,R,B,X){return R===null||R.tag!==6?(R=Kr(B,k.mode,X),R.return=k,R):(R=u(R,B),R.return=k,R)}function C(k,R,B,X){var ne=B.type;return ne===N?V(k,R,B.props.children,X,B.key):R!==null&&(R.elementType===ne||typeof ne=="object"&&ne!==null&&ne.$$typeof===G&&Rn(ne)===R.type)?(R=u(R,B.props),Es(R,B),R.return=k,R):(R=Pl(B.type,B.key,B.props,null,k.mode,X),Es(R,B),R.return=k,R)}function P(k,R,B,X){return R===null||R.tag!==4||R.stateNode.containerInfo!==B.containerInfo||R.stateNode.implementation!==B.implementation?(R=$r(B,k.mode,X),R.return=k,R):(R=u(R,B.children||[]),R.return=k,R)}function V(k,R,B,X,ne){return R===null||R.tag!==7?(R=wn(B,k.mode,X,ne),R.return=k,R):(R=u(R,B),R.return=k,R)}function Q(k,R,B){if(typeof R=="string"&&R!==""||typeof R=="number"||typeof R=="bigint")return R=Kr(""+R,k.mode,B),R.return=k,R;if(typeof R=="object"&&R!==null){switch(R.$$typeof){case S:return B=Pl(R.type,R.key,R.props,null,k.mode,B),Es(B,R),B.return=k,B;case _:return R=$r(R,k.mode,B),R.return=k,R;case G:return R=Rn(R),Q(k,R,B)}if(Ee(R)||ee(R))return R=wn(R,k.mode,B,null),R.return=k,R;if(typeof R.then=="function")return Q(k,Xl(R),B);if(R.$$typeof===z)return Q(k,Gl(k,R),B);Ql(k,R)}return null}function H(k,R,B,X){var ne=R!==null?R.key:null;if(typeof B=="string"&&B!==""||typeof B=="number"||typeof B=="bigint")return ne!==null?null:E(k,R,""+B,X);if(typeof B=="object"&&B!==null){switch(B.$$typeof){case S:return B.key===ne?C(k,R,B,X):null;case _:return B.key===ne?P(k,R,B,X):null;case G:return B=Rn(B),H(k,R,B,X)}if(Ee(B)||ee(B))return ne!==null?null:V(k,R,B,X,null);if(typeof B.then=="function")return H(k,R,Xl(B),X);if(B.$$typeof===z)return H(k,R,Gl(k,B),X);Ql(k,B)}return null}function Y(k,R,B,X,ne){if(typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint")return k=k.get(B)||null,E(R,k,""+X,ne);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case S:return k=k.get(X.key===null?B:X.key)||null,C(R,k,X,ne);case _:return k=k.get(X.key===null?B:X.key)||null,P(R,k,X,ne);case G:return X=Rn(X),Y(k,R,B,X,ne)}if(Ee(X)||ee(X))return k=k.get(B)||null,V(R,k,X,ne,null);if(typeof X.then=="function")return Y(k,R,B,Xl(X),ne);if(X.$$typeof===z)return Y(k,R,B,Gl(R,X),ne);Ql(R,X)}return null}function W(k,R,B,X){for(var ne=null,be=null,ae=R,ue=R=0,ge=null;ae!==null&&ue<B.length;ue++){ae.index>ue?(ge=ae,ae=null):ge=ae.sibling;var xe=H(k,ae,B[ue],X);if(xe===null){ae===null&&(ae=ge);break}e&&ae&&xe.alternate===null&&t(k,ae),R=h(xe,R,ue),be===null?ne=xe:be.sibling=xe,be=xe,ae=ge}if(ue===B.length)return n(k,ae),ve&&Na(k,ue),ne;if(ae===null){for(;ue<B.length;ue++)ae=Q(k,B[ue],X),ae!==null&&(R=h(ae,R,ue),be===null?ne=ae:be.sibling=ae,be=ae);return ve&&Na(k,ue),ne}for(ae=s(ae);ue<B.length;ue++)ge=Y(ae,k,ue,B[ue],X),ge!==null&&(e&&ge.alternate!==null&&ae.delete(ge.key===null?ue:ge.key),R=h(ge,R,ue),be===null?ne=ge:be.sibling=ge,be=ge);return e&&ae.forEach(function(mn){return t(k,mn)}),ve&&Na(k,ue),ne}function ie(k,R,B,X){if(B==null)throw Error(o(151));for(var ne=null,be=null,ae=R,ue=R=0,ge=null,xe=B.next();ae!==null&&!xe.done;ue++,xe=B.next()){ae.index>ue?(ge=ae,ae=null):ge=ae.sibling;var mn=H(k,ae,xe.value,X);if(mn===null){ae===null&&(ae=ge);break}e&&ae&&mn.alternate===null&&t(k,ae),R=h(mn,R,ue),be===null?ne=mn:be.sibling=mn,be=mn,ae=ge}if(xe.done)return n(k,ae),ve&&Na(k,ue),ne;if(ae===null){for(;!xe.done;ue++,xe=B.next())xe=Q(k,xe.value,X),xe!==null&&(R=h(xe,R,ue),be===null?ne=xe:be.sibling=xe,be=xe);return ve&&Na(k,ue),ne}for(ae=s(ae);!xe.done;ue++,xe=B.next())xe=Y(ae,k,ue,xe.value,X),xe!==null&&(e&&xe.alternate!==null&&ae.delete(xe.key===null?ue:xe.key),R=h(xe,R,ue),be===null?ne=xe:be.sibling=xe,be=xe);return e&&ae.forEach(function(x1){return t(k,x1)}),ve&&Na(k,ue),ne}function ze(k,R,B,X){if(typeof B=="object"&&B!==null&&B.type===N&&B.key===null&&(B=B.props.children),typeof B=="object"&&B!==null){switch(B.$$typeof){case S:e:{for(var ne=B.key;R!==null;){if(R.key===ne){if(ne=B.type,ne===N){if(R.tag===7){n(k,R.sibling),X=u(R,B.props.children),X.return=k,k=X;break e}}else if(R.elementType===ne||typeof ne=="object"&&ne!==null&&ne.$$typeof===G&&Rn(ne)===R.type){n(k,R.sibling),X=u(R,B.props),Es(X,B),X.return=k,k=X;break e}n(k,R);break}else t(k,R);R=R.sibling}B.type===N?(X=wn(B.props.children,k.mode,X,B.key),X.return=k,k=X):(X=Pl(B.type,B.key,B.props,null,k.mode,X),Es(X,B),X.return=k,k=X)}return x(k);case _:e:{for(ne=B.key;R!==null;){if(R.key===ne)if(R.tag===4&&R.stateNode.containerInfo===B.containerInfo&&R.stateNode.implementation===B.implementation){n(k,R.sibling),X=u(R,B.children||[]),X.return=k,k=X;break e}else{n(k,R);break}else t(k,R);R=R.sibling}X=$r(B,k.mode,X),X.return=k,k=X}return x(k);case G:return B=Rn(B),ze(k,R,B,X)}if(Ee(B))return W(k,R,B,X);if(ee(B)){if(ne=ee(B),typeof ne!="function")throw Error(o(150));return B=ne.call(B),ie(k,R,B,X)}if(typeof B.then=="function")return ze(k,R,Xl(B),X);if(B.$$typeof===z)return ze(k,R,Gl(k,B),X);Ql(k,B)}return typeof B=="string"&&B!==""||typeof B=="number"||typeof B=="bigint"?(B=""+B,R!==null&&R.tag===6?(n(k,R.sibling),X=u(R,B),X.return=k,k=X):(n(k,R),X=Kr(B,k.mode,X),X.return=k,k=X),x(k)):n(k,R)}return function(k,R,B,X){try{Ns=0;var ne=ze(k,R,B,X);return Si=null,ne}catch(ae){if(ae===xi||ae===Yl)throw ae;var be=Dt(29,ae,null,k.mode);return be.lanes=X,be.return=k,be}finally{}}}var kn=Wf(!0),Jf=Wf(!1),Ka=!1;function cc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function uc(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function $a(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Wa(e,t,n){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,(_e&2)!==0){var u=s.pending;return u===null?t.next=t:(t.next=u.next,u.next=t),s.pending=t,t=Bl(e),Uf(e,null,n),t}return Ll(e,s,t,n),Bl(e)}function Ms(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194048)!==0)){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,Ct(e,n)}}function dc(e,t){var n=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var u=null,h=null;if(n=n.firstBaseUpdate,n!==null){do{var x={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};h===null?u=h=x:h=h.next=x,n=n.next}while(n!==null);h===null?u=h=t:h=h.next=t}else u=h=t;n={baseState:s.baseState,firstBaseUpdate:u,lastBaseUpdate:h,shared:s.shared,callbacks:s.callbacks},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var fc=!1;function js(){if(fc){var e=bi;if(e!==null)throw e}}function ws(e,t,n,s){fc=!1;var u=e.updateQueue;Ka=!1;var h=u.firstBaseUpdate,x=u.lastBaseUpdate,E=u.shared.pending;if(E!==null){u.shared.pending=null;var C=E,P=C.next;C.next=null,x===null?h=P:x.next=P,x=C;var V=e.alternate;V!==null&&(V=V.updateQueue,E=V.lastBaseUpdate,E!==x&&(E===null?V.firstBaseUpdate=P:E.next=P,V.lastBaseUpdate=C))}if(h!==null){var Q=u.baseState;x=0,V=P=C=null,E=h;do{var H=E.lane&-536870913,Y=H!==E.lane;if(Y?(pe&H)===H:(s&H)===H){H!==0&&H===vi&&(fc=!0),V!==null&&(V=V.next={lane:0,tag:E.tag,payload:E.payload,callback:null,next:null});e:{var W=e,ie=E;H=t;var ze=n;switch(ie.tag){case 1:if(W=ie.payload,typeof W=="function"){Q=W.call(ze,Q,H);break e}Q=W;break e;case 3:W.flags=W.flags&-65537|128;case 0:if(W=ie.payload,H=typeof W=="function"?W.call(ze,Q,H):W,H==null)break e;Q=g({},Q,H);break e;case 2:Ka=!0}}H=E.callback,H!==null&&(e.flags|=64,Y&&(e.flags|=8192),Y=u.callbacks,Y===null?u.callbacks=[H]:Y.push(H))}else Y={lane:H,tag:E.tag,payload:E.payload,callback:E.callback,next:null},V===null?(P=V=Y,C=Q):V=V.next=Y,x|=H;if(E=E.next,E===null){if(E=u.shared.pending,E===null)break;Y=E,E=Y.next,Y.next=null,u.lastBaseUpdate=Y,u.shared.pending=null}}while(!0);V===null&&(C=Q),u.baseState=C,u.firstBaseUpdate=P,u.lastBaseUpdate=V,h===null&&(u.shared.lanes=0),nn|=x,e.lanes=x,e.memoizedState=Q}}function eh(e,t){if(typeof e!="function")throw Error(o(191,e));e.call(t)}function th(e,t){var n=e.callbacks;if(n!==null)for(e.callbacks=null,e=0;e<n.length;e++)eh(n[e],t)}var _i=Ae(null),Zl=Ae(0);function ah(e,t){e=ka,ye(Zl,e),ye(_i,t),ka=e|t.baseLanes}function hc(){ye(Zl,ka),ye(_i,_i.current)}function mc(){ka=Zl.current,le(_i),le(Zl)}var Rt=Ae(null),Xt=null;function Ja(e){var t=e.alternate;ye(Ye,Ye.current&1),ye(Rt,e),Xt===null&&(t===null||_i.current!==null||t.memoizedState!==null)&&(Xt=e)}function pc(e){ye(Ye,Ye.current),ye(Rt,e),Xt===null&&(Xt=e)}function nh(e){e.tag===22?(ye(Ye,Ye.current),ye(Rt,e),Xt===null&&(Xt=e)):en()}function en(){ye(Ye,Ye.current),ye(Rt,Rt.current)}function At(e){le(Rt),Xt===e&&(Xt=null),le(Ye)}var Ye=Ae(0);function Fl(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||Su(n)||_u(n)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ja=0,ce=null,Te=null,Qe=null,Kl=!1,Ni=!1,On=!1,$l=0,Ts=0,Ei=null,uv=0;function He(){throw Error(o(321))}function gc(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!zt(e[n],t[n]))return!1;return!0}function yc(e,t,n,s,u,h){return ja=h,ce=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,U.H=e===null||e.memoizedState===null?Ih:Rc,On=!1,h=n(s,u),On=!1,Ni&&(h=sh(t,n,s,u)),ih(e),h}function ih(e){U.H=Ds;var t=Te!==null&&Te.next!==null;if(ja=0,Qe=Te=ce=null,Kl=!1,Ts=0,Ei=null,t)throw Error(o(300));e===null||Ze||(e=e.dependencies,e!==null&&Hl(e)&&(Ze=!0))}function sh(e,t,n,s){ce=e;var u=0;do{if(Ni&&(Ei=null),Ts=0,Ni=!1,25<=u)throw Error(o(301));if(u+=1,Qe=Te=null,e.updateQueue!=null){var h=e.updateQueue;h.lastEffect=null,h.events=null,h.stores=null,h.memoCache!=null&&(h.memoCache.index=0)}U.H=Hh,h=t(n,s)}while(Ni);return h}function dv(){var e=U.H,t=e.useState()[0];return t=typeof t.then=="function"?Cs(t):t,e=e.useState()[0],(Te!==null?Te.memoizedState:null)!==e&&(ce.flags|=1024),t}function vc(){var e=$l!==0;return $l=0,e}function bc(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function xc(e){if(Kl){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Kl=!1}ja=0,Qe=Te=ce=null,Ni=!1,Ts=$l=0,Ei=null}function mt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Qe===null?ce.memoizedState=Qe=e:Qe=Qe.next=e,Qe}function Ve(){if(Te===null){var e=ce.alternate;e=e!==null?e.memoizedState:null}else e=Te.next;var t=Qe===null?ce.memoizedState:Qe.next;if(t!==null)Qe=t,Te=e;else{if(e===null)throw ce.alternate===null?Error(o(467)):Error(o(310));Te=e,e={memoizedState:Te.memoizedState,baseState:Te.baseState,baseQueue:Te.baseQueue,queue:Te.queue,next:null},Qe===null?ce.memoizedState=Qe=e:Qe=Qe.next=e}return Qe}function Wl(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Cs(e){var t=Ts;return Ts+=1,Ei===null&&(Ei=[]),e=Ff(Ei,e,t),t=ce,(Qe===null?t.memoizedState:Qe.next)===null&&(t=t.alternate,U.H=t===null||t.memoizedState===null?Ih:Rc),e}function Jl(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Cs(e);if(e.$$typeof===z)return st(e)}throw Error(o(438,String(e)))}function Sc(e){var t=null,n=ce.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var s=ce.alternate;s!==null&&(s=s.updateQueue,s!==null&&(s=s.memoCache,s!=null&&(t={data:s.data.map(function(u){return u.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=Wl(),ce.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(e),s=0;s<e;s++)n[s]=Z;return t.index++,n}function wa(e,t){return typeof t=="function"?t(e):t}function eo(e){var t=Ve();return _c(t,Te,e)}function _c(e,t,n){var s=e.queue;if(s===null)throw Error(o(311));s.lastRenderedReducer=n;var u=e.baseQueue,h=s.pending;if(h!==null){if(u!==null){var x=u.next;u.next=h.next,h.next=x}t.baseQueue=u=h,s.pending=null}if(h=e.baseState,u===null)e.memoizedState=h;else{t=u.next;var E=x=null,C=null,P=t,V=!1;do{var Q=P.lane&-536870913;if(Q!==P.lane?(pe&Q)===Q:(ja&Q)===Q){var H=P.revertLane;if(H===0)C!==null&&(C=C.next={lane:0,revertLane:0,gesture:null,action:P.action,hasEagerState:P.hasEagerState,eagerState:P.eagerState,next:null}),Q===vi&&(V=!0);else if((ja&H)===H){P=P.next,H===vi&&(V=!0);continue}else Q={lane:0,revertLane:P.revertLane,gesture:null,action:P.action,hasEagerState:P.hasEagerState,eagerState:P.eagerState,next:null},C===null?(E=C=Q,x=h):C=C.next=Q,ce.lanes|=H,nn|=H;Q=P.action,On&&n(h,Q),h=P.hasEagerState?P.eagerState:n(h,Q)}else H={lane:Q,revertLane:P.revertLane,gesture:P.gesture,action:P.action,hasEagerState:P.hasEagerState,eagerState:P.eagerState,next:null},C===null?(E=C=H,x=h):C=C.next=H,ce.lanes|=Q,nn|=Q;P=P.next}while(P!==null&&P!==t);if(C===null?x=h:C.next=E,!zt(h,e.memoizedState)&&(Ze=!0,V&&(n=bi,n!==null)))throw n;e.memoizedState=h,e.baseState=x,e.baseQueue=C,s.lastRenderedState=h}return u===null&&(s.lanes=0),[e.memoizedState,s.dispatch]}function Nc(e){var t=Ve(),n=t.queue;if(n===null)throw Error(o(311));n.lastRenderedReducer=e;var s=n.dispatch,u=n.pending,h=t.memoizedState;if(u!==null){n.pending=null;var x=u=u.next;do h=e(h,x.action),x=x.next;while(x!==u);zt(h,t.memoizedState)||(Ze=!0),t.memoizedState=h,t.baseQueue===null&&(t.baseState=h),n.lastRenderedState=h}return[h,s]}function lh(e,t,n){var s=ce,u=Ve(),h=ve;if(h){if(n===void 0)throw Error(o(407));n=n()}else n=t();var x=!zt((Te||u).memoizedState,n);if(x&&(u.memoizedState=n,Ze=!0),u=u.queue,jc(ch.bind(null,s,u,e),[e]),u.getSnapshot!==t||x||Qe!==null&&Qe.memoizedState.tag&1){if(s.flags|=2048,Mi(9,{destroy:void 0},rh.bind(null,s,u,n,t),null),ke===null)throw Error(o(349));h||(ja&127)!==0||oh(s,t,n)}return n}function oh(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=ce.updateQueue,t===null?(t=Wl(),ce.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function rh(e,t,n,s){t.value=n,t.getSnapshot=s,uh(t)&&dh(e)}function ch(e,t,n){return n(function(){uh(t)&&dh(e)})}function uh(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!zt(e,n)}catch{return!0}}function dh(e){var t=jn(e,2);t!==null&&jt(t,e,2)}function Ec(e){var t=mt();if(typeof e=="function"){var n=e;if(e=n(),On){ca(!0);try{n()}finally{ca(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:wa,lastRenderedState:e},t}function fh(e,t,n,s){return e.baseState=n,_c(e,Te,typeof s=="function"?s:wa)}function fv(e,t,n,s,u){if(no(e))throw Error(o(485));if(e=t.action,e!==null){var h={payload:u,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(x){h.listeners.push(x)}};U.T!==null?n(!0):h.isTransition=!1,s(h),n=t.pending,n===null?(h.next=t.pending=h,hh(t,h)):(h.next=n.next,t.pending=n.next=h)}}function hh(e,t){var n=t.action,s=t.payload,u=e.state;if(t.isTransition){var h=U.T,x={};U.T=x;try{var E=n(u,s),C=U.S;C!==null&&C(x,E),mh(e,t,E)}catch(P){Mc(e,t,P)}finally{h!==null&&x.types!==null&&(h.types=x.types),U.T=h}}else try{h=n(u,s),mh(e,t,h)}catch(P){Mc(e,t,P)}}function mh(e,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(s){ph(e,t,s)},function(s){return Mc(e,t,s)}):ph(e,t,n)}function ph(e,t,n){t.status="fulfilled",t.value=n,gh(t),e.state=n,t=e.pending,t!==null&&(n=t.next,n===t?e.pending=null:(n=n.next,t.next=n,hh(e,n)))}function Mc(e,t,n){var s=e.pending;if(e.pending=null,s!==null){s=s.next;do t.status="rejected",t.reason=n,gh(t),t=t.next;while(t!==s)}e.action=null}function gh(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function yh(e,t){return t}function vh(e,t){if(ve){var n=ke.formState;if(n!==null){e:{var s=ce;if(ve){if(Oe){t:{for(var u=Oe,h=Vt;u.nodeType!==8;){if(!h){u=null;break t}if(u=Qt(u.nextSibling),u===null){u=null;break t}}h=u.data,u=h==="F!"||h==="F"?u:null}if(u){Oe=Qt(u.nextSibling),s=u.data==="F!";break e}}Za(s)}s=!1}s&&(t=n[0])}}return n=mt(),n.memoizedState=n.baseState=t,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:yh,lastRenderedState:t},n.queue=s,n=Lh.bind(null,ce,s),s.dispatch=n,s=Ec(!1),h=Dc.bind(null,ce,!1,s.queue),s=mt(),u={state:t,dispatch:null,action:e,pending:null},s.queue=u,n=fv.bind(null,ce,u,h,n),u.dispatch=n,s.memoizedState=e,[t,n,!1]}function bh(e){var t=Ve();return xh(t,Te,e)}function xh(e,t,n){if(t=_c(e,t,yh)[0],e=eo(wa)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var s=Cs(t)}catch(x){throw x===xi?Yl:x}else s=t;t=Ve();var u=t.queue,h=u.dispatch;return n!==t.memoizedState&&(ce.flags|=2048,Mi(9,{destroy:void 0},hv.bind(null,u,n),null)),[s,h,e]}function hv(e,t){e.action=t}function Sh(e){var t=Ve(),n=Te;if(n!==null)return xh(t,n,e);Ve(),t=t.memoizedState,n=Ve();var s=n.queue.dispatch;return n.memoizedState=e,[t,s,!1]}function Mi(e,t,n,s){return e={tag:e,create:n,deps:s,inst:t,next:null},t=ce.updateQueue,t===null&&(t=Wl(),ce.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=e.next=e:(s=n.next,n.next=e,e.next=s,t.lastEffect=e),e}function _h(){return Ve().memoizedState}function to(e,t,n,s){var u=mt();ce.flags|=e,u.memoizedState=Mi(1|t,{destroy:void 0},n,s===void 0?null:s)}function ao(e,t,n,s){var u=Ve();s=s===void 0?null:s;var h=u.memoizedState.inst;Te!==null&&s!==null&&gc(s,Te.memoizedState.deps)?u.memoizedState=Mi(t,h,n,s):(ce.flags|=e,u.memoizedState=Mi(1|t,h,n,s))}function Nh(e,t){to(8390656,8,e,t)}function jc(e,t){ao(2048,8,e,t)}function mv(e){ce.flags|=4;var t=ce.updateQueue;if(t===null)t=Wl(),ce.updateQueue=t,t.events=[e];else{var n=t.events;n===null?t.events=[e]:n.push(e)}}function Eh(e){var t=Ve().memoizedState;return mv({ref:t,nextImpl:e}),function(){if((_e&2)!==0)throw Error(o(440));return t.impl.apply(void 0,arguments)}}function Mh(e,t){return ao(4,2,e,t)}function jh(e,t){return ao(4,4,e,t)}function wh(e,t){if(typeof t=="function"){e=e();var n=t(e);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Th(e,t,n){n=n!=null?n.concat([e]):null,ao(4,4,wh.bind(null,t,e),n)}function wc(){}function Ch(e,t){var n=Ve();t=t===void 0?null:t;var s=n.memoizedState;return t!==null&&gc(t,s[1])?s[0]:(n.memoizedState=[e,t],e)}function zh(e,t){var n=Ve();t=t===void 0?null:t;var s=n.memoizedState;if(t!==null&&gc(t,s[1]))return s[0];if(s=e(),On){ca(!0);try{e()}finally{ca(!1)}}return n.memoizedState=[s,t],s}function Tc(e,t,n){return n===void 0||(ja&1073741824)!==0&&(pe&261930)===0?e.memoizedState=t:(e.memoizedState=n,e=Dm(),ce.lanes|=e,nn|=e,n)}function Dh(e,t,n,s){return zt(n,t)?n:_i.current!==null?(e=Tc(e,n,s),zt(e,t)||(Ze=!0),e):(ja&42)===0||(ja&1073741824)!==0&&(pe&261930)===0?(Ze=!0,e.memoizedState=n):(e=Dm(),ce.lanes|=e,nn|=e,t)}function Rh(e,t,n,s,u){var h=L.p;L.p=h!==0&&8>h?h:8;var x=U.T,E={};U.T=E,Dc(e,!1,t,n);try{var C=u(),P=U.S;if(P!==null&&P(E,C),C!==null&&typeof C=="object"&&typeof C.then=="function"){var V=cv(C,s);zs(e,t,V,Ut(e))}else zs(e,t,s,Ut(e))}catch(Q){zs(e,t,{then:function(){},status:"rejected",reason:Q},Ut())}finally{L.p=h,x!==null&&E.types!==null&&(x.types=E.types),U.T=x}}function pv(){}function Cc(e,t,n,s){if(e.tag!==5)throw Error(o(476));var u=Ah(e).queue;Rh(e,u,t,K,n===null?pv:function(){return kh(e),n(s)})}function Ah(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:K,baseState:K,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:wa,lastRenderedState:K},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:wa,lastRenderedState:n},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function kh(e){var t=Ah(e);t.next===null&&(t=e.alternate.memoizedState),zs(e,t.next.queue,{},Ut())}function zc(){return st(Qs)}function Oh(){return Ve().memoizedState}function Uh(){return Ve().memoizedState}function gv(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var n=Ut();e=$a(n);var s=Wa(t,e,n);s!==null&&(jt(s,t,n),Ms(s,t,n)),t={cache:sc()},e.payload=t;return}t=t.return}}function yv(e,t,n){var s=Ut();n={lane:s,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},no(e)?Bh(t,n):(n=Zr(e,t,n,s),n!==null&&(jt(n,e,s),Ph(n,t,s)))}function Lh(e,t,n){var s=Ut();zs(e,t,n,s)}function zs(e,t,n,s){var u={lane:s,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(no(e))Bh(t,u);else{var h=e.alternate;if(e.lanes===0&&(h===null||h.lanes===0)&&(h=t.lastRenderedReducer,h!==null))try{var x=t.lastRenderedState,E=h(x,n);if(u.hasEagerState=!0,u.eagerState=E,zt(E,x))return Ll(e,t,u,0),ke===null&&Ul(),!1}catch{}finally{}if(n=Zr(e,t,u,s),n!==null)return jt(n,e,s),Ph(n,t,s),!0}return!1}function Dc(e,t,n,s){if(s={lane:2,revertLane:cu(),gesture:null,action:s,hasEagerState:!1,eagerState:null,next:null},no(e)){if(t)throw Error(o(479))}else t=Zr(e,n,s,2),t!==null&&jt(t,e,2)}function no(e){var t=e.alternate;return e===ce||t!==null&&t===ce}function Bh(e,t){Ni=Kl=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ph(e,t,n){if((n&4194048)!==0){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,Ct(e,n)}}var Ds={readContext:st,use:Jl,useCallback:He,useContext:He,useEffect:He,useImperativeHandle:He,useLayoutEffect:He,useInsertionEffect:He,useMemo:He,useReducer:He,useRef:He,useState:He,useDebugValue:He,useDeferredValue:He,useTransition:He,useSyncExternalStore:He,useId:He,useHostTransitionStatus:He,useFormState:He,useActionState:He,useOptimistic:He,useMemoCache:He,useCacheRefresh:He};Ds.useEffectEvent=He;var Ih={readContext:st,use:Jl,useCallback:function(e,t){return mt().memoizedState=[e,t===void 0?null:t],e},useContext:st,useEffect:Nh,useImperativeHandle:function(e,t,n){n=n!=null?n.concat([e]):null,to(4194308,4,wh.bind(null,t,e),n)},useLayoutEffect:function(e,t){return to(4194308,4,e,t)},useInsertionEffect:function(e,t){to(4,2,e,t)},useMemo:function(e,t){var n=mt();t=t===void 0?null:t;var s=e();if(On){ca(!0);try{e()}finally{ca(!1)}}return n.memoizedState=[s,t],s},useReducer:function(e,t,n){var s=mt();if(n!==void 0){var u=n(t);if(On){ca(!0);try{n(t)}finally{ca(!1)}}}else u=t;return s.memoizedState=s.baseState=u,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:u},s.queue=e,e=e.dispatch=yv.bind(null,ce,e),[s.memoizedState,e]},useRef:function(e){var t=mt();return e={current:e},t.memoizedState=e},useState:function(e){e=Ec(e);var t=e.queue,n=Lh.bind(null,ce,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:wc,useDeferredValue:function(e,t){var n=mt();return Tc(n,e,t)},useTransition:function(){var e=Ec(!1);return e=Rh.bind(null,ce,e.queue,!0,!1),mt().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var s=ce,u=mt();if(ve){if(n===void 0)throw Error(o(407));n=n()}else{if(n=t(),ke===null)throw Error(o(349));(pe&127)!==0||oh(s,t,n)}u.memoizedState=n;var h={value:n,getSnapshot:t};return u.queue=h,Nh(ch.bind(null,s,h,e),[e]),s.flags|=2048,Mi(9,{destroy:void 0},rh.bind(null,s,h,n,t),null),n},useId:function(){var e=mt(),t=ke.identifierPrefix;if(ve){var n=fa,s=da;n=(s&~(1<<32-at(s)-1)).toString(32)+n,t="_"+t+"R_"+n,n=$l++,0<n&&(t+="H"+n.toString(32)),t+="_"}else n=uv++,t="_"+t+"r_"+n.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:zc,useFormState:vh,useActionState:vh,useOptimistic:function(e){var t=mt();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=Dc.bind(null,ce,!0,n),n.dispatch=t,[e,t]},useMemoCache:Sc,useCacheRefresh:function(){return mt().memoizedState=gv.bind(null,ce)},useEffectEvent:function(e){var t=mt(),n={impl:e};return t.memoizedState=n,function(){if((_e&2)!==0)throw Error(o(440));return n.impl.apply(void 0,arguments)}}},Rc={readContext:st,use:Jl,useCallback:Ch,useContext:st,useEffect:jc,useImperativeHandle:Th,useInsertionEffect:Mh,useLayoutEffect:jh,useMemo:zh,useReducer:eo,useRef:_h,useState:function(){return eo(wa)},useDebugValue:wc,useDeferredValue:function(e,t){var n=Ve();return Dh(n,Te.memoizedState,e,t)},useTransition:function(){var e=eo(wa)[0],t=Ve().memoizedState;return[typeof e=="boolean"?e:Cs(e),t]},useSyncExternalStore:lh,useId:Oh,useHostTransitionStatus:zc,useFormState:bh,useActionState:bh,useOptimistic:function(e,t){var n=Ve();return fh(n,Te,e,t)},useMemoCache:Sc,useCacheRefresh:Uh};Rc.useEffectEvent=Eh;var Hh={readContext:st,use:Jl,useCallback:Ch,useContext:st,useEffect:jc,useImperativeHandle:Th,useInsertionEffect:Mh,useLayoutEffect:jh,useMemo:zh,useReducer:Nc,useRef:_h,useState:function(){return Nc(wa)},useDebugValue:wc,useDeferredValue:function(e,t){var n=Ve();return Te===null?Tc(n,e,t):Dh(n,Te.memoizedState,e,t)},useTransition:function(){var e=Nc(wa)[0],t=Ve().memoizedState;return[typeof e=="boolean"?e:Cs(e),t]},useSyncExternalStore:lh,useId:Oh,useHostTransitionStatus:zc,useFormState:Sh,useActionState:Sh,useOptimistic:function(e,t){var n=Ve();return Te!==null?fh(n,Te,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:Sc,useCacheRefresh:Uh};Hh.useEffectEvent=Eh;function Ac(e,t,n,s){t=e.memoizedState,n=n(s,t),n=n==null?t:g({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var kc={enqueueSetState:function(e,t,n){e=e._reactInternals;var s=Ut(),u=$a(s);u.payload=t,n!=null&&(u.callback=n),t=Wa(e,u,s),t!==null&&(jt(t,e,s),Ms(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var s=Ut(),u=$a(s);u.tag=1,u.payload=t,n!=null&&(u.callback=n),t=Wa(e,u,s),t!==null&&(jt(t,e,s),Ms(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ut(),s=$a(n);s.tag=2,t!=null&&(s.callback=t),t=Wa(e,s,n),t!==null&&(jt(t,e,n),Ms(t,e,n))}};function Gh(e,t,n,s,u,h,x){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,h,x):t.prototype&&t.prototype.isPureReactComponent?!ys(n,s)||!ys(u,h):!0}function qh(e,t,n,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,s),t.state!==e&&kc.enqueueReplaceState(t,t.state,null)}function Un(e,t){var n=t;if("ref"in t){n={};for(var s in t)s!=="ref"&&(n[s]=t[s])}if(e=e.defaultProps){n===t&&(n=g({},n));for(var u in e)n[u]===void 0&&(n[u]=e[u])}return n}function Yh(e){Ol(e)}function Vh(e){console.error(e)}function Xh(e){Ol(e)}function io(e,t){try{var n=e.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(s){setTimeout(function(){throw s})}}function Qh(e,t,n){try{var s=e.onCaughtError;s(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(u){setTimeout(function(){throw u})}}function Oc(e,t,n){return n=$a(n),n.tag=3,n.payload={element:null},n.callback=function(){io(e,t)},n}function Zh(e){return e=$a(e),e.tag=3,e}function Fh(e,t,n,s){var u=n.type.getDerivedStateFromError;if(typeof u=="function"){var h=s.value;e.payload=function(){return u(h)},e.callback=function(){Qh(t,n,s)}}var x=n.stateNode;x!==null&&typeof x.componentDidCatch=="function"&&(e.callback=function(){Qh(t,n,s),typeof u!="function"&&(sn===null?sn=new Set([this]):sn.add(this));var E=s.stack;this.componentDidCatch(s.value,{componentStack:E!==null?E:""})})}function vv(e,t,n,s,u){if(n.flags|=32768,s!==null&&typeof s=="object"&&typeof s.then=="function"){if(t=n.alternate,t!==null&&yi(t,n,u,!0),n=Rt.current,n!==null){switch(n.tag){case 31:case 13:return Xt===null?yo():n.alternate===null&&Ge===0&&(Ge=3),n.flags&=-257,n.flags|=65536,n.lanes=u,s===Vl?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([s]):t.add(s),lu(e,s,u)),!1;case 22:return n.flags|=65536,s===Vl?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([s])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([s]):n.add(s)),lu(e,s,u)),!1}throw Error(o(435,n.tag))}return lu(e,s,u),yo(),!1}if(ve)return t=Rt.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=u,s!==ec&&(e=Error(o(422),{cause:s}),xs(Gt(e,n)))):(s!==ec&&(t=Error(o(423),{cause:s}),xs(Gt(t,n))),e=e.current.alternate,e.flags|=65536,u&=-u,e.lanes|=u,s=Gt(s,n),u=Oc(e.stateNode,s,u),dc(e,u),Ge!==4&&(Ge=2)),!1;var h=Error(o(520),{cause:s});if(h=Gt(h,n),Ps===null?Ps=[h]:Ps.push(h),Ge!==4&&(Ge=2),t===null)return!0;s=Gt(s,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=u&-u,n.lanes|=e,e=Oc(n.stateNode,s,e),dc(n,e),!1;case 1:if(t=n.type,h=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||h!==null&&typeof h.componentDidCatch=="function"&&(sn===null||!sn.has(h))))return n.flags|=65536,u&=-u,n.lanes|=u,u=Zh(u),Fh(u,e,n,s),dc(n,u),!1}n=n.return}while(n!==null);return!1}var Uc=Error(o(461)),Ze=!1;function lt(e,t,n,s){t.child=e===null?Jf(t,null,n,s):kn(t,e.child,n,s)}function Kh(e,t,n,s,u){n=n.render;var h=t.ref;if("ref"in s){var x={};for(var E in s)E!=="ref"&&(x[E]=s[E])}else x=s;return zn(t),s=yc(e,t,n,x,h,u),E=vc(),e!==null&&!Ze?(bc(e,t,u),Ta(e,t,u)):(ve&&E&&Wr(t),t.flags|=1,lt(e,t,s,u),t.child)}function $h(e,t,n,s,u){if(e===null){var h=n.type;return typeof h=="function"&&!Fr(h)&&h.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=h,Wh(e,t,h,s,u)):(e=Pl(n.type,null,s,t,t.mode,u),e.ref=t.ref,e.return=t,t.child=e)}if(h=e.child,!Yc(e,u)){var x=h.memoizedProps;if(n=n.compare,n=n!==null?n:ys,n(x,s)&&e.ref===t.ref)return Ta(e,t,u)}return t.flags|=1,e=_a(h,s),e.ref=t.ref,e.return=t,t.child=e}function Wh(e,t,n,s,u){if(e!==null){var h=e.memoizedProps;if(ys(h,s)&&e.ref===t.ref)if(Ze=!1,t.pendingProps=s=h,Yc(e,u))(e.flags&131072)!==0&&(Ze=!0);else return t.lanes=e.lanes,Ta(e,t,u)}return Lc(e,t,n,s,u)}function Jh(e,t,n,s){var u=s.children,h=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.mode==="hidden"){if((t.flags&128)!==0){if(h=h!==null?h.baseLanes|n:n,e!==null){for(s=t.child=e.child,u=0;s!==null;)u=u|s.lanes|s.childLanes,s=s.sibling;s=u&~h}else s=0,t.child=null;return em(e,t,h,n,s)}if((n&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&ql(t,h!==null?h.cachePool:null),h!==null?ah(t,h):hc(),nh(t);else return s=t.lanes=536870912,em(e,t,h!==null?h.baseLanes|n:n,n,s)}else h!==null?(ql(t,h.cachePool),ah(t,h),en(),t.memoizedState=null):(e!==null&&ql(t,null),hc(),en());return lt(e,t,u,n),t.child}function Rs(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function em(e,t,n,s,u){var h=oc();return h=h===null?null:{parent:Xe._currentValue,pool:h},t.memoizedState={baseLanes:n,cachePool:h},e!==null&&ql(t,null),hc(),nh(t),e!==null&&yi(e,t,s,!0),t.childLanes=u,null}function so(e,t){return t=oo({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function tm(e,t,n){return kn(t,e.child,null,n),e=so(t,t.pendingProps),e.flags|=2,At(t),t.memoizedState=null,e}function bv(e,t,n){var s=t.pendingProps,u=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(ve){if(s.mode==="hidden")return e=so(t,s),t.lanes=536870912,Rs(null,e);if(pc(t),(e=Oe)?(e=hp(e,Vt),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Xa!==null?{id:da,overflow:fa}:null,retryLane:536870912,hydrationErrors:null},n=Bf(e),n.return=t,t.child=n,it=t,Oe=null)):e=null,e===null)throw Za(t);return t.lanes=536870912,null}return so(t,s)}var h=e.memoizedState;if(h!==null){var x=h.dehydrated;if(pc(t),u)if(t.flags&256)t.flags&=-257,t=tm(e,t,n);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(o(558));else if(Ze||yi(e,t,n,!1),u=(n&e.childLanes)!==0,Ze||u){if(s=ke,s!==null&&(x=Jn(s,n),x!==0&&x!==h.retryLane))throw h.retryLane=x,jn(e,x),jt(s,e,x),Uc;yo(),t=tm(e,t,n)}else e=h.treeContext,Oe=Qt(x.nextSibling),it=t,ve=!0,Qa=null,Vt=!1,e!==null&&Hf(t,e),t=so(t,s),t.flags|=4096;return t}return e=_a(e.child,{mode:s.mode,children:s.children}),e.ref=t.ref,t.child=e,e.return=t,e}function lo(e,t){var n=t.ref;if(n===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(o(284));(e===null||e.ref!==n)&&(t.flags|=4194816)}}function Lc(e,t,n,s,u){return zn(t),n=yc(e,t,n,s,void 0,u),s=vc(),e!==null&&!Ze?(bc(e,t,u),Ta(e,t,u)):(ve&&s&&Wr(t),t.flags|=1,lt(e,t,n,u),t.child)}function am(e,t,n,s,u,h){return zn(t),t.updateQueue=null,n=sh(t,s,n,u),ih(e),s=vc(),e!==null&&!Ze?(bc(e,t,h),Ta(e,t,h)):(ve&&s&&Wr(t),t.flags|=1,lt(e,t,n,h),t.child)}function nm(e,t,n,s,u){if(zn(t),t.stateNode===null){var h=hi,x=n.contextType;typeof x=="object"&&x!==null&&(h=st(x)),h=new n(s,h),t.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,h.updater=kc,t.stateNode=h,h._reactInternals=t,h=t.stateNode,h.props=s,h.state=t.memoizedState,h.refs={},cc(t),x=n.contextType,h.context=typeof x=="object"&&x!==null?st(x):hi,h.state=t.memoizedState,x=n.getDerivedStateFromProps,typeof x=="function"&&(Ac(t,n,x,s),h.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof h.getSnapshotBeforeUpdate=="function"||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(x=h.state,typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount(),x!==h.state&&kc.enqueueReplaceState(h,h.state,null),ws(t,s,h,u),js(),h.state=t.memoizedState),typeof h.componentDidMount=="function"&&(t.flags|=4194308),s=!0}else if(e===null){h=t.stateNode;var E=t.memoizedProps,C=Un(n,E);h.props=C;var P=h.context,V=n.contextType;x=hi,typeof V=="object"&&V!==null&&(x=st(V));var Q=n.getDerivedStateFromProps;V=typeof Q=="function"||typeof h.getSnapshotBeforeUpdate=="function",E=t.pendingProps!==E,V||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(E||P!==x)&&qh(t,h,s,x),Ka=!1;var H=t.memoizedState;h.state=H,ws(t,s,h,u),js(),P=t.memoizedState,E||H!==P||Ka?(typeof Q=="function"&&(Ac(t,n,Q,s),P=t.memoizedState),(C=Ka||Gh(t,n,C,s,H,P,x))?(V||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount()),typeof h.componentDidMount=="function"&&(t.flags|=4194308)):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=P),h.props=s,h.state=P,h.context=x,s=C):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{h=t.stateNode,uc(e,t),x=t.memoizedProps,V=Un(n,x),h.props=V,Q=t.pendingProps,H=h.context,P=n.contextType,C=hi,typeof P=="object"&&P!==null&&(C=st(P)),E=n.getDerivedStateFromProps,(P=typeof E=="function"||typeof h.getSnapshotBeforeUpdate=="function")||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(x!==Q||H!==C)&&qh(t,h,s,C),Ka=!1,H=t.memoizedState,h.state=H,ws(t,s,h,u),js();var Y=t.memoizedState;x!==Q||H!==Y||Ka||e!==null&&e.dependencies!==null&&Hl(e.dependencies)?(typeof E=="function"&&(Ac(t,n,E,s),Y=t.memoizedState),(V=Ka||Gh(t,n,V,s,H,Y,C)||e!==null&&e.dependencies!==null&&Hl(e.dependencies))?(P||typeof h.UNSAFE_componentWillUpdate!="function"&&typeof h.componentWillUpdate!="function"||(typeof h.componentWillUpdate=="function"&&h.componentWillUpdate(s,Y,C),typeof h.UNSAFE_componentWillUpdate=="function"&&h.UNSAFE_componentWillUpdate(s,Y,C)),typeof h.componentDidUpdate=="function"&&(t.flags|=4),typeof h.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof h.componentDidUpdate!="function"||x===e.memoizedProps&&H===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||x===e.memoizedProps&&H===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=Y),h.props=s,h.state=Y,h.context=C,s=V):(typeof h.componentDidUpdate!="function"||x===e.memoizedProps&&H===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||x===e.memoizedProps&&H===e.memoizedState||(t.flags|=1024),s=!1)}return h=s,lo(e,t),s=(t.flags&128)!==0,h||s?(h=t.stateNode,n=s&&typeof n.getDerivedStateFromError!="function"?null:h.render(),t.flags|=1,e!==null&&s?(t.child=kn(t,e.child,null,u),t.child=kn(t,null,n,u)):lt(e,t,n,u),t.memoizedState=h.state,e=t.child):e=Ta(e,t,u),e}function im(e,t,n,s){return Tn(),t.flags|=256,lt(e,t,n,s),t.child}var Bc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Pc(e){return{baseLanes:e,cachePool:Qf()}}function Ic(e,t,n){return e=e!==null?e.childLanes&~n:0,t&&(e|=Ot),e}function sm(e,t,n){var s=t.pendingProps,u=!1,h=(t.flags&128)!==0,x;if((x=h)||(x=e!==null&&e.memoizedState===null?!1:(Ye.current&2)!==0),x&&(u=!0,t.flags&=-129),x=(t.flags&32)!==0,t.flags&=-33,e===null){if(ve){if(u?Ja(t):en(),(e=Oe)?(e=hp(e,Vt),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Xa!==null?{id:da,overflow:fa}:null,retryLane:536870912,hydrationErrors:null},n=Bf(e),n.return=t,t.child=n,it=t,Oe=null)):e=null,e===null)throw Za(t);return _u(e)?t.lanes=32:t.lanes=536870912,null}var E=s.children;return s=s.fallback,u?(en(),u=t.mode,E=oo({mode:"hidden",children:E},u),s=wn(s,u,n,null),E.return=t,s.return=t,E.sibling=s,t.child=E,s=t.child,s.memoizedState=Pc(n),s.childLanes=Ic(e,x,n),t.memoizedState=Bc,Rs(null,s)):(Ja(t),Hc(t,E))}var C=e.memoizedState;if(C!==null&&(E=C.dehydrated,E!==null)){if(h)t.flags&256?(Ja(t),t.flags&=-257,t=Gc(e,t,n)):t.memoizedState!==null?(en(),t.child=e.child,t.flags|=128,t=null):(en(),E=s.fallback,u=t.mode,s=oo({mode:"visible",children:s.children},u),E=wn(E,u,n,null),E.flags|=2,s.return=t,E.return=t,s.sibling=E,t.child=s,kn(t,e.child,null,n),s=t.child,s.memoizedState=Pc(n),s.childLanes=Ic(e,x,n),t.memoizedState=Bc,t=Rs(null,s));else if(Ja(t),_u(E)){if(x=E.nextSibling&&E.nextSibling.dataset,x)var P=x.dgst;x=P,s=Error(o(419)),s.stack="",s.digest=x,xs({value:s,source:null,stack:null}),t=Gc(e,t,n)}else if(Ze||yi(e,t,n,!1),x=(n&e.childLanes)!==0,Ze||x){if(x=ke,x!==null&&(s=Jn(x,n),s!==0&&s!==C.retryLane))throw C.retryLane=s,jn(e,s),jt(x,e,s),Uc;Su(E)||yo(),t=Gc(e,t,n)}else Su(E)?(t.flags|=192,t.child=e.child,t=null):(e=C.treeContext,Oe=Qt(E.nextSibling),it=t,ve=!0,Qa=null,Vt=!1,e!==null&&Hf(t,e),t=Hc(t,s.children),t.flags|=4096);return t}return u?(en(),E=s.fallback,u=t.mode,C=e.child,P=C.sibling,s=_a(C,{mode:"hidden",children:s.children}),s.subtreeFlags=C.subtreeFlags&65011712,P!==null?E=_a(P,E):(E=wn(E,u,n,null),E.flags|=2),E.return=t,s.return=t,s.sibling=E,t.child=s,Rs(null,s),s=t.child,E=e.child.memoizedState,E===null?E=Pc(n):(u=E.cachePool,u!==null?(C=Xe._currentValue,u=u.parent!==C?{parent:C,pool:C}:u):u=Qf(),E={baseLanes:E.baseLanes|n,cachePool:u}),s.memoizedState=E,s.childLanes=Ic(e,x,n),t.memoizedState=Bc,Rs(e.child,s)):(Ja(t),n=e.child,e=n.sibling,n=_a(n,{mode:"visible",children:s.children}),n.return=t,n.sibling=null,e!==null&&(x=t.deletions,x===null?(t.deletions=[e],t.flags|=16):x.push(e)),t.child=n,t.memoizedState=null,n)}function Hc(e,t){return t=oo({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function oo(e,t){return e=Dt(22,e,null,t),e.lanes=0,e}function Gc(e,t,n){return kn(t,e.child,null,n),e=Hc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function lm(e,t,n){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),nc(e.return,t,n)}function qc(e,t,n,s,u,h){var x=e.memoizedState;x===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:u,treeForkCount:h}:(x.isBackwards=t,x.rendering=null,x.renderingStartTime=0,x.last=s,x.tail=n,x.tailMode=u,x.treeForkCount=h)}function om(e,t,n){var s=t.pendingProps,u=s.revealOrder,h=s.tail;s=s.children;var x=Ye.current,E=(x&2)!==0;if(E?(x=x&1|2,t.flags|=128):x&=1,ye(Ye,x),lt(e,t,s,n),s=ve?bs:0,!E&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&lm(e,n,t);else if(e.tag===19)lm(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(u){case"forwards":for(n=t.child,u=null;n!==null;)e=n.alternate,e!==null&&Fl(e)===null&&(u=n),n=n.sibling;n=u,n===null?(u=t.child,t.child=null):(u=n.sibling,n.sibling=null),qc(t,!1,u,n,h,s);break;case"backwards":case"unstable_legacy-backwards":for(n=null,u=t.child,t.child=null;u!==null;){if(e=u.alternate,e!==null&&Fl(e)===null){t.child=u;break}e=u.sibling,u.sibling=n,n=u,u=e}qc(t,!0,n,null,h,s);break;case"together":qc(t,!1,null,null,void 0,s);break;default:t.memoizedState=null}return t.child}function Ta(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),nn|=t.lanes,(n&t.childLanes)===0)if(e!==null){if(yi(e,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(o(153));if(t.child!==null){for(e=t.child,n=_a(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=_a(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Yc(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&Hl(e)))}function xv(e,t,n){switch(t.tag){case 3:Sn(t,t.stateNode.containerInfo),Fa(t,Xe,e.memoizedState.cache),Tn();break;case 27:case 5:Zn(t);break;case 4:Sn(t,t.stateNode.containerInfo);break;case 10:Fa(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,pc(t),null;break;case 13:var s=t.memoizedState;if(s!==null)return s.dehydrated!==null?(Ja(t),t.flags|=128,null):(n&t.child.childLanes)!==0?sm(e,t,n):(Ja(t),e=Ta(e,t,n),e!==null?e.sibling:null);Ja(t);break;case 19:var u=(e.flags&128)!==0;if(s=(n&t.childLanes)!==0,s||(yi(e,t,n,!1),s=(n&t.childLanes)!==0),u){if(s)return om(e,t,n);t.flags|=128}if(u=t.memoizedState,u!==null&&(u.rendering=null,u.tail=null,u.lastEffect=null),ye(Ye,Ye.current),s)break;return null;case 22:return t.lanes=0,Jh(e,t,n,t.pendingProps);case 24:Fa(t,Xe,e.memoizedState.cache)}return Ta(e,t,n)}function rm(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps)Ze=!0;else{if(!Yc(e,n)&&(t.flags&128)===0)return Ze=!1,xv(e,t,n);Ze=(e.flags&131072)!==0}else Ze=!1,ve&&(t.flags&1048576)!==0&&If(t,bs,t.index);switch(t.lanes=0,t.tag){case 16:e:{var s=t.pendingProps;if(e=Rn(t.elementType),t.type=e,typeof e=="function")Fr(e)?(s=Un(e,s),t.tag=1,t=nm(null,t,e,s,n)):(t.tag=0,t=Lc(null,t,e,s,n));else{if(e!=null){var u=e.$$typeof;if(u===D){t.tag=11,t=Kh(null,t,e,s,n);break e}else if(u===I){t.tag=14,t=$h(null,t,e,s,n);break e}}throw t=de(e)||e,Error(o(306,t,""))}}return t;case 0:return Lc(e,t,t.type,t.pendingProps,n);case 1:return s=t.type,u=Un(s,t.pendingProps),nm(e,t,s,u,n);case 3:e:{if(Sn(t,t.stateNode.containerInfo),e===null)throw Error(o(387));s=t.pendingProps;var h=t.memoizedState;u=h.element,uc(e,t),ws(t,s,null,n);var x=t.memoizedState;if(s=x.cache,Fa(t,Xe,s),s!==h.cache&&ic(t,[Xe],n,!0),js(),s=x.element,h.isDehydrated)if(h={element:s,isDehydrated:!1,cache:x.cache},t.updateQueue.baseState=h,t.memoizedState=h,t.flags&256){t=im(e,t,s,n);break e}else if(s!==u){u=Gt(Error(o(424)),t),xs(u),t=im(e,t,s,n);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(Oe=Qt(e.firstChild),it=t,ve=!0,Qa=null,Vt=!0,n=Jf(t,null,s,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(Tn(),s===u){t=Ta(e,t,n);break e}lt(e,t,s,n)}t=t.child}return t;case 26:return lo(e,t),e===null?(n=bp(t.type,null,t.pendingProps,null))?t.memoizedState=n:ve||(n=t.type,e=t.pendingProps,s=Eo(vt.current).createElement(n),s[nt]=t,s[xt]=e,ot(s,n,e),We(s),t.stateNode=s):t.memoizedState=bp(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Zn(t),e===null&&ve&&(s=t.stateNode=gp(t.type,t.pendingProps,vt.current),it=t,Vt=!0,u=Oe,cn(t.type)?(Nu=u,Oe=Qt(s.firstChild)):Oe=u),lt(e,t,t.pendingProps.children,n),lo(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&ve&&((u=s=Oe)&&(s=Kv(s,t.type,t.pendingProps,Vt),s!==null?(t.stateNode=s,it=t,Oe=Qt(s.firstChild),Vt=!1,u=!0):u=!1),u||Za(t)),Zn(t),u=t.type,h=t.pendingProps,x=e!==null?e.memoizedProps:null,s=h.children,vu(u,h)?s=null:x!==null&&vu(u,x)&&(t.flags|=32),t.memoizedState!==null&&(u=yc(e,t,dv,null,null,n),Qs._currentValue=u),lo(e,t),lt(e,t,s,n),t.child;case 6:return e===null&&ve&&((e=n=Oe)&&(n=$v(n,t.pendingProps,Vt),n!==null?(t.stateNode=n,it=t,Oe=null,e=!0):e=!1),e||Za(t)),null;case 13:return sm(e,t,n);case 4:return Sn(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=kn(t,null,s,n):lt(e,t,s,n),t.child;case 11:return Kh(e,t,t.type,t.pendingProps,n);case 7:return lt(e,t,t.pendingProps,n),t.child;case 8:return lt(e,t,t.pendingProps.children,n),t.child;case 12:return lt(e,t,t.pendingProps.children,n),t.child;case 10:return s=t.pendingProps,Fa(t,t.type,s.value),lt(e,t,s.children,n),t.child;case 9:return u=t.type._context,s=t.pendingProps.children,zn(t),u=st(u),s=s(u),t.flags|=1,lt(e,t,s,n),t.child;case 14:return $h(e,t,t.type,t.pendingProps,n);case 15:return Wh(e,t,t.type,t.pendingProps,n);case 19:return om(e,t,n);case 31:return bv(e,t,n);case 22:return Jh(e,t,n,t.pendingProps);case 24:return zn(t),s=st(Xe),e===null?(u=oc(),u===null&&(u=ke,h=sc(),u.pooledCache=h,h.refCount++,h!==null&&(u.pooledCacheLanes|=n),u=h),t.memoizedState={parent:s,cache:u},cc(t),Fa(t,Xe,u)):((e.lanes&n)!==0&&(uc(e,t),ws(t,null,null,n),js()),u=e.memoizedState,h=t.memoizedState,u.parent!==s?(u={parent:s,cache:s},t.memoizedState=u,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=u),Fa(t,Xe,s)):(s=h.cache,Fa(t,Xe,s),s!==u.cache&&ic(t,[Xe],n,!0))),lt(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(o(156,t.tag))}function Ca(e){e.flags|=4}function Vc(e,t,n,s,u){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(u&335544128)===u)if(e.stateNode.complete)e.flags|=8192;else if(Om())e.flags|=8192;else throw An=Vl,rc}else e.flags&=-16777217}function cm(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!Ep(t))if(Om())e.flags|=8192;else throw An=Vl,rc}function ro(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?va():536870912,e.lanes|=t,Ci|=t)}function As(e,t){if(!ve)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function Ue(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,s=0;if(t)for(var u=e.child;u!==null;)n|=u.lanes|u.childLanes,s|=u.subtreeFlags&65011712,s|=u.flags&65011712,u.return=e,u=u.sibling;else for(u=e.child;u!==null;)n|=u.lanes|u.childLanes,s|=u.subtreeFlags,s|=u.flags,u.return=e,u=u.sibling;return e.subtreeFlags|=s,e.childLanes=n,t}function Sv(e,t,n){var s=t.pendingProps;switch(Jr(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ue(t),null;case 1:return Ue(t),null;case 3:return n=t.stateNode,s=null,e!==null&&(s=e.memoizedState.cache),t.memoizedState.cache!==s&&(t.flags|=2048),Ma(Xe),ga(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(gi(t)?Ca(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,tc())),Ue(t),null;case 26:var u=t.type,h=t.memoizedState;return e===null?(Ca(t),h!==null?(Ue(t),cm(t,h)):(Ue(t),Vc(t,u,null,s,n))):h?h!==e.memoizedState?(Ca(t),Ue(t),cm(t,h)):(Ue(t),t.flags&=-16777217):(e=e.memoizedProps,e!==s&&Ca(t),Ue(t),Vc(t,u,e,s,n)),null;case 27:if(ct(t),n=vt.current,u=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==s&&Ca(t);else{if(!s){if(t.stateNode===null)throw Error(o(166));return Ue(t),null}e=Le.current,gi(t)?Gf(t):(e=gp(u,s,n),t.stateNode=e,Ca(t))}return Ue(t),null;case 5:if(ct(t),u=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==s&&Ca(t);else{if(!s){if(t.stateNode===null)throw Error(o(166));return Ue(t),null}if(h=Le.current,gi(t))Gf(t);else{var x=Eo(vt.current);switch(h){case 1:h=x.createElementNS("http://www.w3.org/2000/svg",u);break;case 2:h=x.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;default:switch(u){case"svg":h=x.createElementNS("http://www.w3.org/2000/svg",u);break;case"math":h=x.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;case"script":h=x.createElement("div"),h.innerHTML="<script><\/script>",h=h.removeChild(h.firstChild);break;case"select":h=typeof s.is=="string"?x.createElement("select",{is:s.is}):x.createElement("select"),s.multiple?h.multiple=!0:s.size&&(h.size=s.size);break;default:h=typeof s.is=="string"?x.createElement(u,{is:s.is}):x.createElement(u)}}h[nt]=t,h[xt]=s;e:for(x=t.child;x!==null;){if(x.tag===5||x.tag===6)h.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===t)break e;for(;x.sibling===null;){if(x.return===null||x.return===t)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}t.stateNode=h;e:switch(ot(h,u,s),u){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&Ca(t)}}return Ue(t),Vc(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==s&&Ca(t);else{if(typeof s!="string"&&t.stateNode===null)throw Error(o(166));if(e=vt.current,gi(t)){if(e=t.stateNode,n=t.memoizedProps,s=null,u=it,u!==null)switch(u.tag){case 27:case 5:s=u.memoizedProps}e[nt]=t,e=!!(e.nodeValue===n||s!==null&&s.suppressHydrationWarning===!0||sp(e.nodeValue,n)),e||Za(t,!0)}else e=Eo(e).createTextNode(s),e[nt]=t,t.stateNode=e}return Ue(t),null;case 31:if(n=t.memoizedState,e===null||e.memoizedState!==null){if(s=gi(t),n!==null){if(e===null){if(!s)throw Error(o(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(o(557));e[nt]=t}else Tn(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Ue(t),e=!1}else n=tc(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return t.flags&256?(At(t),t):(At(t),null);if((t.flags&128)!==0)throw Error(o(558))}return Ue(t),null;case 13:if(s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(u=gi(t),s!==null&&s.dehydrated!==null){if(e===null){if(!u)throw Error(o(318));if(u=t.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(o(317));u[nt]=t}else Tn(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Ue(t),u=!1}else u=tc(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=u),u=!0;if(!u)return t.flags&256?(At(t),t):(At(t),null)}return At(t),(t.flags&128)!==0?(t.lanes=n,t):(n=s!==null,e=e!==null&&e.memoizedState!==null,n&&(s=t.child,u=null,s.alternate!==null&&s.alternate.memoizedState!==null&&s.alternate.memoizedState.cachePool!==null&&(u=s.alternate.memoizedState.cachePool.pool),h=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(h=s.memoizedState.cachePool.pool),h!==u&&(s.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),ro(t,t.updateQueue),Ue(t),null);case 4:return ga(),e===null&&hu(t.stateNode.containerInfo),Ue(t),null;case 10:return Ma(t.type),Ue(t),null;case 19:if(le(Ye),s=t.memoizedState,s===null)return Ue(t),null;if(u=(t.flags&128)!==0,h=s.rendering,h===null)if(u)As(s,!1);else{if(Ge!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(h=Fl(e),h!==null){for(t.flags|=128,As(s,!1),e=h.updateQueue,t.updateQueue=e,ro(t,e),t.subtreeFlags=0,e=n,n=t.child;n!==null;)Lf(n,e),n=n.sibling;return ye(Ye,Ye.current&1|2),ve&&Na(t,s.treeForkCount),t.child}e=e.sibling}s.tail!==null&&ft()>mo&&(t.flags|=128,u=!0,As(s,!1),t.lanes=4194304)}else{if(!u)if(e=Fl(h),e!==null){if(t.flags|=128,u=!0,e=e.updateQueue,t.updateQueue=e,ro(t,e),As(s,!0),s.tail===null&&s.tailMode==="hidden"&&!h.alternate&&!ve)return Ue(t),null}else 2*ft()-s.renderingStartTime>mo&&n!==536870912&&(t.flags|=128,u=!0,As(s,!1),t.lanes=4194304);s.isBackwards?(h.sibling=t.child,t.child=h):(e=s.last,e!==null?e.sibling=h:t.child=h,s.last=h)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=ft(),e.sibling=null,n=Ye.current,ye(Ye,u?n&1|2:n&1),ve&&Na(t,s.treeForkCount),e):(Ue(t),null);case 22:case 23:return At(t),mc(),s=t.memoizedState!==null,e!==null?e.memoizedState!==null!==s&&(t.flags|=8192):s&&(t.flags|=8192),s?(n&536870912)!==0&&(t.flags&128)===0&&(Ue(t),t.subtreeFlags&6&&(t.flags|=8192)):Ue(t),n=t.updateQueue,n!==null&&ro(t,n.retryQueue),n=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),s=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(s=t.memoizedState.cachePool.pool),s!==n&&(t.flags|=2048),e!==null&&le(Dn),null;case 24:return n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Ma(Xe),Ue(t),null;case 25:return null;case 30:return null}throw Error(o(156,t.tag))}function _v(e,t){switch(Jr(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ma(Xe),ga(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return ct(t),null;case 31:if(t.memoizedState!==null){if(At(t),t.alternate===null)throw Error(o(340));Tn()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(At(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(o(340));Tn()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return le(Ye),null;case 4:return ga(),null;case 10:return Ma(t.type),null;case 22:case 23:return At(t),mc(),e!==null&&le(Dn),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return Ma(Xe),null;case 25:return null;default:return null}}function um(e,t){switch(Jr(t),t.tag){case 3:Ma(Xe),ga();break;case 26:case 27:case 5:ct(t);break;case 4:ga();break;case 31:t.memoizedState!==null&&At(t);break;case 13:At(t);break;case 19:le(Ye);break;case 10:Ma(t.type);break;case 22:case 23:At(t),mc(),e!==null&&le(Dn);break;case 24:Ma(Xe)}}function ks(e,t){try{var n=t.updateQueue,s=n!==null?n.lastEffect:null;if(s!==null){var u=s.next;n=u;do{if((n.tag&e)===e){s=void 0;var h=n.create,x=n.inst;s=h(),x.destroy=s}n=n.next}while(n!==u)}}catch(E){je(t,t.return,E)}}function tn(e,t,n){try{var s=t.updateQueue,u=s!==null?s.lastEffect:null;if(u!==null){var h=u.next;s=h;do{if((s.tag&e)===e){var x=s.inst,E=x.destroy;if(E!==void 0){x.destroy=void 0,u=t;var C=n,P=E;try{P()}catch(V){je(u,C,V)}}}s=s.next}while(s!==h)}}catch(V){je(t,t.return,V)}}function dm(e){var t=e.updateQueue;if(t!==null){var n=e.stateNode;try{th(t,n)}catch(s){je(e,e.return,s)}}}function fm(e,t,n){n.props=Un(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(s){je(e,t,s)}}function Os(e,t){try{var n=e.ref;if(n!==null){switch(e.tag){case 26:case 27:case 5:var s=e.stateNode;break;case 30:s=e.stateNode;break;default:s=e.stateNode}typeof n=="function"?e.refCleanup=n(s):n.current=s}}catch(u){je(e,t,u)}}function ha(e,t){var n=e.ref,s=e.refCleanup;if(n!==null)if(typeof s=="function")try{s()}catch(u){je(e,t,u)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(u){je(e,t,u)}else n.current=null}function hm(e){var t=e.type,n=e.memoizedProps,s=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&s.focus();break e;case"img":n.src?s.src=n.src:n.srcSet&&(s.srcset=n.srcSet)}}catch(u){je(e,e.return,u)}}function Xc(e,t,n){try{var s=e.stateNode;Yv(s,e.type,n,t),s[xt]=t}catch(u){je(e,e.return,u)}}function mm(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&cn(e.type)||e.tag===4}function Qc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||mm(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&cn(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Zc(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(e,t):(t=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,t.appendChild(e),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=xa));else if(s!==4&&(s===27&&cn(e.type)&&(n=e.stateNode,t=null),e=e.child,e!==null))for(Zc(e,t,n),e=e.sibling;e!==null;)Zc(e,t,n),e=e.sibling}function co(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(s!==4&&(s===27&&cn(e.type)&&(n=e.stateNode),e=e.child,e!==null))for(co(e,t,n),e=e.sibling;e!==null;)co(e,t,n),e=e.sibling}function pm(e){var t=e.stateNode,n=e.memoizedProps;try{for(var s=e.type,u=t.attributes;u.length;)t.removeAttributeNode(u[0]);ot(t,s,n),t[nt]=e,t[xt]=n}catch(h){je(e,e.return,h)}}var za=!1,Fe=!1,Fc=!1,gm=typeof WeakSet=="function"?WeakSet:Set,Je=null;function Nv(e,t){if(e=e.containerInfo,gu=Do,e=Tf(e),Gr(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var u=s.anchorOffset,h=s.focusNode;s=s.focusOffset;try{n.nodeType,h.nodeType}catch{n=null;break e}var x=0,E=-1,C=-1,P=0,V=0,Q=e,H=null;t:for(;;){for(var Y;Q!==n||u!==0&&Q.nodeType!==3||(E=x+u),Q!==h||s!==0&&Q.nodeType!==3||(C=x+s),Q.nodeType===3&&(x+=Q.nodeValue.length),(Y=Q.firstChild)!==null;)H=Q,Q=Y;for(;;){if(Q===e)break t;if(H===n&&++P===u&&(E=x),H===h&&++V===s&&(C=x),(Y=Q.nextSibling)!==null)break;Q=H,H=Q.parentNode}Q=Y}n=E===-1||C===-1?null:{start:E,end:C}}else n=null}n=n||{start:0,end:0}}else n=null;for(yu={focusedElem:e,selectionRange:n},Do=!1,Je=t;Je!==null;)if(t=Je,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Je=e;else for(;Je!==null;){switch(t=Je,h=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(n=0;n<e.length;n++)u=e[n],u.ref.impl=u.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&h!==null){e=void 0,n=t,u=h.memoizedProps,h=h.memoizedState,s=n.stateNode;try{var W=Un(n.type,u);e=s.getSnapshotBeforeUpdate(W,h),s.__reactInternalSnapshotBeforeUpdate=e}catch(ie){je(n,n.return,ie)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,n=e.nodeType,n===9)xu(e);else if(n===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":xu(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(o(163))}if(e=t.sibling,e!==null){e.return=t.return,Je=e;break}Je=t.return}}function ym(e,t,n){var s=n.flags;switch(n.tag){case 0:case 11:case 15:Ra(e,n),s&4&&ks(5,n);break;case 1:if(Ra(e,n),s&4)if(e=n.stateNode,t===null)try{e.componentDidMount()}catch(x){je(n,n.return,x)}else{var u=Un(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(u,t,e.__reactInternalSnapshotBeforeUpdate)}catch(x){je(n,n.return,x)}}s&64&&dm(n),s&512&&Os(n,n.return);break;case 3:if(Ra(e,n),s&64&&(e=n.updateQueue,e!==null)){if(t=null,n.child!==null)switch(n.child.tag){case 27:case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}try{th(e,t)}catch(x){je(n,n.return,x)}}break;case 27:t===null&&s&4&&pm(n);case 26:case 5:Ra(e,n),t===null&&s&4&&hm(n),s&512&&Os(n,n.return);break;case 12:Ra(e,n);break;case 31:Ra(e,n),s&4&&xm(e,n);break;case 13:Ra(e,n),s&4&&Sm(e,n),s&64&&(e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(n=Rv.bind(null,n),Wv(e,n))));break;case 22:if(s=n.memoizedState!==null||za,!s){t=t!==null&&t.memoizedState!==null||Fe,u=za;var h=Fe;za=s,(Fe=t)&&!h?Aa(e,n,(n.subtreeFlags&8772)!==0):Ra(e,n),za=u,Fe=h}break;case 30:break;default:Ra(e,n)}}function vm(e){var t=e.alternate;t!==null&&(e.alternate=null,vm(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&Mr(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Be=null,_t=!1;function Da(e,t,n){for(n=n.child;n!==null;)bm(e,t,n),n=n.sibling}function bm(e,t,n){if(ut&&typeof ut.onCommitFiberUnmount=="function")try{ut.onCommitFiberUnmount(Ga,n)}catch{}switch(n.tag){case 26:Fe||ha(n,t),Da(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:Fe||ha(n,t);var s=Be,u=_t;cn(n.type)&&(Be=n.stateNode,_t=!1),Da(e,t,n),Ys(n.stateNode),Be=s,_t=u;break;case 5:Fe||ha(n,t);case 6:if(s=Be,u=_t,Be=null,Da(e,t,n),Be=s,_t=u,Be!==null)if(_t)try{(Be.nodeType===9?Be.body:Be.nodeName==="HTML"?Be.ownerDocument.body:Be).removeChild(n.stateNode)}catch(h){je(n,t,h)}else try{Be.removeChild(n.stateNode)}catch(h){je(n,t,h)}break;case 18:Be!==null&&(_t?(e=Be,dp(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,n.stateNode),Li(e)):dp(Be,n.stateNode));break;case 4:s=Be,u=_t,Be=n.stateNode.containerInfo,_t=!0,Da(e,t,n),Be=s,_t=u;break;case 0:case 11:case 14:case 15:tn(2,n,t),Fe||tn(4,n,t),Da(e,t,n);break;case 1:Fe||(ha(n,t),s=n.stateNode,typeof s.componentWillUnmount=="function"&&fm(n,t,s)),Da(e,t,n);break;case 21:Da(e,t,n);break;case 22:Fe=(s=Fe)||n.memoizedState!==null,Da(e,t,n),Fe=s;break;default:Da(e,t,n)}}function xm(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Li(e)}catch(n){je(t,t.return,n)}}}function Sm(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Li(e)}catch(n){je(t,t.return,n)}}function Ev(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new gm),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new gm),t;default:throw Error(o(435,e.tag))}}function uo(e,t){var n=Ev(e);t.forEach(function(s){if(!n.has(s)){n.add(s);var u=Av.bind(null,e,s);s.then(u,u)}})}function Nt(e,t){var n=t.deletions;if(n!==null)for(var s=0;s<n.length;s++){var u=n[s],h=e,x=t,E=x;e:for(;E!==null;){switch(E.tag){case 27:if(cn(E.type)){Be=E.stateNode,_t=!1;break e}break;case 5:Be=E.stateNode,_t=!1;break e;case 3:case 4:Be=E.stateNode.containerInfo,_t=!0;break e}E=E.return}if(Be===null)throw Error(o(160));bm(h,x,u),Be=null,_t=!1,h=u.alternate,h!==null&&(h.return=null),u.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)_m(t,e),t=t.sibling}var ta=null;function _m(e,t){var n=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Nt(t,e),Et(e),s&4&&(tn(3,e,e.return),ks(3,e),tn(5,e,e.return));break;case 1:Nt(t,e),Et(e),s&512&&(Fe||n===null||ha(n,n.return)),s&64&&za&&(e=e.updateQueue,e!==null&&(s=e.callbacks,s!==null&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=n===null?s:n.concat(s))));break;case 26:var u=ta;if(Nt(t,e),Et(e),s&512&&(Fe||n===null||ha(n,n.return)),s&4){var h=n!==null?n.memoizedState:null;if(s=e.memoizedState,n===null)if(s===null)if(e.stateNode===null){e:{s=e.type,n=e.memoizedProps,u=u.ownerDocument||u;t:switch(s){case"title":h=u.getElementsByTagName("title")[0],(!h||h[rs]||h[nt]||h.namespaceURI==="http://www.w3.org/2000/svg"||h.hasAttribute("itemprop"))&&(h=u.createElement(s),u.head.insertBefore(h,u.querySelector("head > title"))),ot(h,s,n),h[nt]=e,We(h),s=h;break e;case"link":var x=_p("link","href",u).get(s+(n.href||""));if(x){for(var E=0;E<x.length;E++)if(h=x[E],h.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&h.getAttribute("rel")===(n.rel==null?null:n.rel)&&h.getAttribute("title")===(n.title==null?null:n.title)&&h.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){x.splice(E,1);break t}}h=u.createElement(s),ot(h,s,n),u.head.appendChild(h);break;case"meta":if(x=_p("meta","content",u).get(s+(n.content||""))){for(E=0;E<x.length;E++)if(h=x[E],h.getAttribute("content")===(n.content==null?null:""+n.content)&&h.getAttribute("name")===(n.name==null?null:n.name)&&h.getAttribute("property")===(n.property==null?null:n.property)&&h.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&h.getAttribute("charset")===(n.charSet==null?null:n.charSet)){x.splice(E,1);break t}}h=u.createElement(s),ot(h,s,n),u.head.appendChild(h);break;default:throw Error(o(468,s))}h[nt]=e,We(h),s=h}e.stateNode=s}else Np(u,e.type,e.stateNode);else e.stateNode=Sp(u,s,e.memoizedProps);else h!==s?(h===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):h.count--,s===null?Np(u,e.type,e.stateNode):Sp(u,s,e.memoizedProps)):s===null&&e.stateNode!==null&&Xc(e,e.memoizedProps,n.memoizedProps)}break;case 27:Nt(t,e),Et(e),s&512&&(Fe||n===null||ha(n,n.return)),n!==null&&s&4&&Xc(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Nt(t,e),Et(e),s&512&&(Fe||n===null||ha(n,n.return)),e.flags&32){u=e.stateNode;try{li(u,"")}catch(W){je(e,e.return,W)}}s&4&&e.stateNode!=null&&(u=e.memoizedProps,Xc(e,u,n!==null?n.memoizedProps:u)),s&1024&&(Fc=!0);break;case 6:if(Nt(t,e),Et(e),s&4){if(e.stateNode===null)throw Error(o(162));s=e.memoizedProps,n=e.stateNode;try{n.nodeValue=s}catch(W){je(e,e.return,W)}}break;case 3:if(wo=null,u=ta,ta=Mo(t.containerInfo),Nt(t,e),ta=u,Et(e),s&4&&n!==null&&n.memoizedState.isDehydrated)try{Li(t.containerInfo)}catch(W){je(e,e.return,W)}Fc&&(Fc=!1,Nm(e));break;case 4:s=ta,ta=Mo(e.stateNode.containerInfo),Nt(t,e),Et(e),ta=s;break;case 12:Nt(t,e),Et(e);break;case 31:Nt(t,e),Et(e),s&4&&(s=e.updateQueue,s!==null&&(e.updateQueue=null,uo(e,s)));break;case 13:Nt(t,e),Et(e),e.child.flags&8192&&e.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(ho=ft()),s&4&&(s=e.updateQueue,s!==null&&(e.updateQueue=null,uo(e,s)));break;case 22:u=e.memoizedState!==null;var C=n!==null&&n.memoizedState!==null,P=za,V=Fe;if(za=P||u,Fe=V||C,Nt(t,e),Fe=V,za=P,Et(e),s&8192)e:for(t=e.stateNode,t._visibility=u?t._visibility&-2:t._visibility|1,u&&(n===null||C||za||Fe||Ln(e)),n=null,t=e;;){if(t.tag===5||t.tag===26){if(n===null){C=n=t;try{if(h=C.stateNode,u)x=h.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none";else{E=C.stateNode;var Q=C.memoizedProps.style,H=Q!=null&&Q.hasOwnProperty("display")?Q.display:null;E.style.display=H==null||typeof H=="boolean"?"":(""+H).trim()}}catch(W){je(C,C.return,W)}}}else if(t.tag===6){if(n===null){C=t;try{C.stateNode.nodeValue=u?"":C.memoizedProps}catch(W){je(C,C.return,W)}}}else if(t.tag===18){if(n===null){C=t;try{var Y=C.stateNode;u?fp(Y,!0):fp(C.stateNode,!1)}catch(W){je(C,C.return,W)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}s&4&&(s=e.updateQueue,s!==null&&(n=s.retryQueue,n!==null&&(s.retryQueue=null,uo(e,n))));break;case 19:Nt(t,e),Et(e),s&4&&(s=e.updateQueue,s!==null&&(e.updateQueue=null,uo(e,s)));break;case 30:break;case 21:break;default:Nt(t,e),Et(e)}}function Et(e){var t=e.flags;if(t&2){try{for(var n,s=e.return;s!==null;){if(mm(s)){n=s;break}s=s.return}if(n==null)throw Error(o(160));switch(n.tag){case 27:var u=n.stateNode,h=Qc(e);co(e,h,u);break;case 5:var x=n.stateNode;n.flags&32&&(li(x,""),n.flags&=-33);var E=Qc(e);co(e,E,x);break;case 3:case 4:var C=n.stateNode.containerInfo,P=Qc(e);Zc(e,P,C);break;default:throw Error(o(161))}}catch(V){je(e,e.return,V)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Nm(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;Nm(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function Ra(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)ym(e,t.alternate,t),t=t.sibling}function Ln(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:tn(4,t,t.return),Ln(t);break;case 1:ha(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&fm(t,t.return,n),Ln(t);break;case 27:Ys(t.stateNode);case 26:case 5:ha(t,t.return),Ln(t);break;case 22:t.memoizedState===null&&Ln(t);break;case 30:Ln(t);break;default:Ln(t)}e=e.sibling}}function Aa(e,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var s=t.alternate,u=e,h=t,x=h.flags;switch(h.tag){case 0:case 11:case 15:Aa(u,h,n),ks(4,h);break;case 1:if(Aa(u,h,n),s=h,u=s.stateNode,typeof u.componentDidMount=="function")try{u.componentDidMount()}catch(P){je(s,s.return,P)}if(s=h,u=s.updateQueue,u!==null){var E=s.stateNode;try{var C=u.shared.hiddenCallbacks;if(C!==null)for(u.shared.hiddenCallbacks=null,u=0;u<C.length;u++)eh(C[u],E)}catch(P){je(s,s.return,P)}}n&&x&64&&dm(h),Os(h,h.return);break;case 27:pm(h);case 26:case 5:Aa(u,h,n),n&&s===null&&x&4&&hm(h),Os(h,h.return);break;case 12:Aa(u,h,n);break;case 31:Aa(u,h,n),n&&x&4&&xm(u,h);break;case 13:Aa(u,h,n),n&&x&4&&Sm(u,h);break;case 22:h.memoizedState===null&&Aa(u,h,n),Os(h,h.return);break;case 30:break;default:Aa(u,h,n)}t=t.sibling}}function Kc(e,t){var n=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==n&&(e!=null&&e.refCount++,n!=null&&Ss(n))}function $c(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Ss(e))}function aa(e,t,n,s){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Em(e,t,n,s),t=t.sibling}function Em(e,t,n,s){var u=t.flags;switch(t.tag){case 0:case 11:case 15:aa(e,t,n,s),u&2048&&ks(9,t);break;case 1:aa(e,t,n,s);break;case 3:aa(e,t,n,s),u&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Ss(e)));break;case 12:if(u&2048){aa(e,t,n,s),e=t.stateNode;try{var h=t.memoizedProps,x=h.id,E=h.onPostCommit;typeof E=="function"&&E(x,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(C){je(t,t.return,C)}}else aa(e,t,n,s);break;case 31:aa(e,t,n,s);break;case 13:aa(e,t,n,s);break;case 23:break;case 22:h=t.stateNode,x=t.alternate,t.memoizedState!==null?h._visibility&2?aa(e,t,n,s):Us(e,t):h._visibility&2?aa(e,t,n,s):(h._visibility|=2,ji(e,t,n,s,(t.subtreeFlags&10256)!==0||!1)),u&2048&&Kc(x,t);break;case 24:aa(e,t,n,s),u&2048&&$c(t.alternate,t);break;default:aa(e,t,n,s)}}function ji(e,t,n,s,u){for(u=u&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var h=e,x=t,E=n,C=s,P=x.flags;switch(x.tag){case 0:case 11:case 15:ji(h,x,E,C,u),ks(8,x);break;case 23:break;case 22:var V=x.stateNode;x.memoizedState!==null?V._visibility&2?ji(h,x,E,C,u):Us(h,x):(V._visibility|=2,ji(h,x,E,C,u)),u&&P&2048&&Kc(x.alternate,x);break;case 24:ji(h,x,E,C,u),u&&P&2048&&$c(x.alternate,x);break;default:ji(h,x,E,C,u)}t=t.sibling}}function Us(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=e,s=t,u=s.flags;switch(s.tag){case 22:Us(n,s),u&2048&&Kc(s.alternate,s);break;case 24:Us(n,s),u&2048&&$c(s.alternate,s);break;default:Us(n,s)}t=t.sibling}}var Ls=8192;function wi(e,t,n){if(e.subtreeFlags&Ls)for(e=e.child;e!==null;)Mm(e,t,n),e=e.sibling}function Mm(e,t,n){switch(e.tag){case 26:wi(e,t,n),e.flags&Ls&&e.memoizedState!==null&&u1(n,ta,e.memoizedState,e.memoizedProps);break;case 5:wi(e,t,n);break;case 3:case 4:var s=ta;ta=Mo(e.stateNode.containerInfo),wi(e,t,n),ta=s;break;case 22:e.memoizedState===null&&(s=e.alternate,s!==null&&s.memoizedState!==null?(s=Ls,Ls=16777216,wi(e,t,n),Ls=s):wi(e,t,n));break;default:wi(e,t,n)}}function jm(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function Bs(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var s=t[n];Je=s,Tm(s,e)}jm(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)wm(e),e=e.sibling}function wm(e){switch(e.tag){case 0:case 11:case 15:Bs(e),e.flags&2048&&tn(9,e,e.return);break;case 3:Bs(e);break;case 12:Bs(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,fo(e)):Bs(e);break;default:Bs(e)}}function fo(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var s=t[n];Je=s,Tm(s,e)}jm(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:tn(8,t,t.return),fo(t);break;case 22:n=t.stateNode,n._visibility&2&&(n._visibility&=-3,fo(t));break;default:fo(t)}e=e.sibling}}function Tm(e,t){for(;Je!==null;){var n=Je;switch(n.tag){case 0:case 11:case 15:tn(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var s=n.memoizedState.cachePool.pool;s!=null&&s.refCount++}break;case 24:Ss(n.memoizedState.cache)}if(s=n.child,s!==null)s.return=n,Je=s;else e:for(n=e;Je!==null;){s=Je;var u=s.sibling,h=s.return;if(vm(s),s===n){Je=null;break e}if(u!==null){u.return=h,Je=u;break e}Je=h}}}var Mv={getCacheForType:function(e){var t=st(Xe),n=t.data.get(e);return n===void 0&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return st(Xe).controller.signal}},jv=typeof WeakMap=="function"?WeakMap:Map,_e=0,ke=null,he=null,pe=0,Me=0,kt=null,an=!1,Ti=!1,Wc=!1,ka=0,Ge=0,nn=0,Bn=0,Jc=0,Ot=0,Ci=0,Ps=null,Mt=null,eu=!1,ho=0,Cm=0,mo=1/0,po=null,sn=null,Ke=0,ln=null,zi=null,Oa=0,tu=0,au=null,zm=null,Is=0,nu=null;function Ut(){return(_e&2)!==0&&pe!==0?pe&-pe:U.T!==null?cu():Vd()}function Dm(){if(Ot===0)if((pe&536870912)===0||ve){var e=$n;$n<<=1,($n&3932160)===0&&($n=262144),Ot=e}else Ot=536870912;return e=Rt.current,e!==null&&(e.flags|=32),Ot}function jt(e,t,n){(e===ke&&(Me===2||Me===9)||e.cancelPendingCommit!==null)&&(Di(e,0),on(e,pe,Ot,!1)),O(e,n),((_e&2)===0||e!==ke)&&(e===ke&&((_e&2)===0&&(Bn|=n),Ge===4&&on(e,pe,Ot,!1)),ma(e))}function Rm(e,t,n){if((_e&6)!==0)throw Error(o(327));var s=!n&&(t&127)===0&&(t&e.expiredLanes)===0||ua(e,t),u=s?Cv(e,t):su(e,t,!0),h=s;do{if(u===0){Ti&&!s&&on(e,t,0,!1);break}else{if(n=e.current.alternate,h&&!wv(n)){u=su(e,t,!1),h=!1;continue}if(u===2){if(h=t,e.errorRecoveryDisabledLanes&h)var x=0;else x=e.pendingLanes&-536870913,x=x!==0?x:x&536870912?536870912:0;if(x!==0){t=x;e:{var E=e;u=Ps;var C=E.current.memoizedState.isDehydrated;if(C&&(Di(E,x).flags|=256),x=su(E,x,!1),x!==2){if(Wc&&!C){E.errorRecoveryDisabledLanes|=h,Bn|=h,u=4;break e}h=Mt,Mt=u,h!==null&&(Mt===null?Mt=h:Mt.push.apply(Mt,h))}u=x}if(h=!1,u!==2)continue}}if(u===1){Di(e,0),on(e,t,0,!0);break}e:{switch(s=e,h=u,h){case 0:case 1:throw Error(o(345));case 4:if((t&4194048)!==t)break;case 6:on(s,t,Ot,!an);break e;case 2:Mt=null;break;case 3:case 5:break;default:throw Error(o(329))}if((t&62914560)===t&&(u=ho+300-ft(),10<u)){if(on(s,t,Ot,!an),Wn(s,0,!0)!==0)break e;Oa=t,s.timeoutHandle=cp(Am.bind(null,s,n,Mt,po,eu,t,Ot,Bn,Ci,an,h,"Throttled",-0,0),u);break e}Am(s,n,Mt,po,eu,t,Ot,Bn,Ci,an,h,null,-0,0)}}break}while(!0);ma(e)}function Am(e,t,n,s,u,h,x,E,C,P,V,Q,H,Y){if(e.timeoutHandle=-1,Q=t.subtreeFlags,Q&8192||(Q&16785408)===16785408){Q={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:xa},Mm(t,h,Q);var W=(h&62914560)===h?ho-ft():(h&4194048)===h?Cm-ft():0;if(W=d1(Q,W),W!==null){Oa=h,e.cancelPendingCommit=W(Hm.bind(null,e,t,h,n,s,u,x,E,C,V,Q,null,H,Y)),on(e,h,x,!P);return}}Hm(e,t,h,n,s,u,x,E,C)}function wv(e){for(var t=e;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var s=0;s<n.length;s++){var u=n[s],h=u.getSnapshot;u=u.value;try{if(!zt(h(),u))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function on(e,t,n,s){t&=~Jc,t&=~Bn,e.suspendedLanes|=t,e.pingedLanes&=~t,s&&(e.warmLanes|=t),s=e.expirationTimes;for(var u=t;0<u;){var h=31-at(u),x=1<<h;s[h]=-1,u&=~x}n!==0&&ht(e,n,t)}function go(){return(_e&6)===0?(Hs(0),!1):!0}function iu(){if(he!==null){if(Me===0)var e=he.return;else e=he,Ea=Cn=null,xc(e),Si=null,Ns=0,e=he;for(;e!==null;)um(e.alternate,e),e=e.return;he=null}}function Di(e,t){var n=e.timeoutHandle;n!==-1&&(e.timeoutHandle=-1,Qv(n)),n=e.cancelPendingCommit,n!==null&&(e.cancelPendingCommit=null,n()),Oa=0,iu(),ke=e,he=n=_a(e.current,null),pe=t,Me=0,kt=null,an=!1,Ti=ua(e,t),Wc=!1,Ci=Ot=Jc=Bn=nn=Ge=0,Mt=Ps=null,eu=!1,(t&8)!==0&&(t|=t&32);var s=e.entangledLanes;if(s!==0)for(e=e.entanglements,s&=t;0<s;){var u=31-at(s),h=1<<u;t|=e[u],s&=~h}return ka=t,Ul(),n}function km(e,t){ce=null,U.H=Ds,t===xi||t===Yl?(t=Kf(),Me=3):t===rc?(t=Kf(),Me=4):Me=t===Uc?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,kt=t,he===null&&(Ge=1,io(e,Gt(t,e.current)))}function Om(){var e=Rt.current;return e===null?!0:(pe&4194048)===pe?Xt===null:(pe&62914560)===pe||(pe&536870912)!==0?e===Xt:!1}function Um(){var e=U.H;return U.H=Ds,e===null?Ds:e}function Lm(){var e=U.A;return U.A=Mv,e}function yo(){Ge=4,an||(pe&4194048)!==pe&&Rt.current!==null||(Ti=!0),(nn&134217727)===0&&(Bn&134217727)===0||ke===null||on(ke,pe,Ot,!1)}function su(e,t,n){var s=_e;_e|=2;var u=Um(),h=Lm();(ke!==e||pe!==t)&&(po=null,Di(e,t)),t=!1;var x=Ge;e:do try{if(Me!==0&&he!==null){var E=he,C=kt;switch(Me){case 8:iu(),x=6;break e;case 3:case 2:case 9:case 6:Rt.current===null&&(t=!0);var P=Me;if(Me=0,kt=null,Ri(e,E,C,P),n&&Ti){x=0;break e}break;default:P=Me,Me=0,kt=null,Ri(e,E,C,P)}}Tv(),x=Ge;break}catch(V){km(e,V)}while(!0);return t&&e.shellSuspendCounter++,Ea=Cn=null,_e=s,U.H=u,U.A=h,he===null&&(ke=null,pe=0,Ul()),x}function Tv(){for(;he!==null;)Bm(he)}function Cv(e,t){var n=_e;_e|=2;var s=Um(),u=Lm();ke!==e||pe!==t?(po=null,mo=ft()+500,Di(e,t)):Ti=ua(e,t);e:do try{if(Me!==0&&he!==null){t=he;var h=kt;t:switch(Me){case 1:Me=0,kt=null,Ri(e,t,h,1);break;case 2:case 9:if(Zf(h)){Me=0,kt=null,Pm(t);break}t=function(){Me!==2&&Me!==9||ke!==e||(Me=7),ma(e)},h.then(t,t);break e;case 3:Me=7;break e;case 4:Me=5;break e;case 7:Zf(h)?(Me=0,kt=null,Pm(t)):(Me=0,kt=null,Ri(e,t,h,7));break;case 5:var x=null;switch(he.tag){case 26:x=he.memoizedState;case 5:case 27:var E=he;if(x?Ep(x):E.stateNode.complete){Me=0,kt=null;var C=E.sibling;if(C!==null)he=C;else{var P=E.return;P!==null?(he=P,vo(P)):he=null}break t}}Me=0,kt=null,Ri(e,t,h,5);break;case 6:Me=0,kt=null,Ri(e,t,h,6);break;case 8:iu(),Ge=6;break e;default:throw Error(o(462))}}zv();break}catch(V){km(e,V)}while(!0);return Ea=Cn=null,U.H=s,U.A=u,_e=n,he!==null?0:(ke=null,pe=0,Ul(),Ge)}function zv(){for(;he!==null&&!yr();)Bm(he)}function Bm(e){var t=rm(e.alternate,e,ka);e.memoizedProps=e.pendingProps,t===null?vo(e):he=t}function Pm(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=am(n,t,t.pendingProps,t.type,void 0,pe);break;case 11:t=am(n,t,t.pendingProps,t.type.render,t.ref,pe);break;case 5:xc(t);default:um(n,t),t=he=Lf(t,ka),t=rm(n,t,ka)}e.memoizedProps=e.pendingProps,t===null?vo(e):he=t}function Ri(e,t,n,s){Ea=Cn=null,xc(t),Si=null,Ns=0;var u=t.return;try{if(vv(e,u,t,n,pe)){Ge=1,io(e,Gt(n,e.current)),he=null;return}}catch(h){if(u!==null)throw he=u,h;Ge=1,io(e,Gt(n,e.current)),he=null;return}t.flags&32768?(ve||s===1?e=!0:Ti||(pe&536870912)!==0?e=!1:(an=e=!0,(s===2||s===9||s===3||s===6)&&(s=Rt.current,s!==null&&s.tag===13&&(s.flags|=16384))),Im(t,e)):vo(t)}function vo(e){var t=e;do{if((t.flags&32768)!==0){Im(t,an);return}e=t.return;var n=Sv(t.alternate,t,ka);if(n!==null){he=n;return}if(t=t.sibling,t!==null){he=t;return}he=t=e}while(t!==null);Ge===0&&(Ge=5)}function Im(e,t){do{var n=_v(e.alternate,e);if(n!==null){n.flags&=32767,he=n;return}if(n=e.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(e=e.sibling,e!==null)){he=e;return}he=e=n}while(e!==null);Ge=6,he=null}function Hm(e,t,n,s,u,h,x,E,C){e.cancelPendingCommit=null;do bo();while(Ke!==0);if((_e&6)!==0)throw Error(o(327));if(t!==null){if(t===e.current)throw Error(o(177));if(h=t.lanes|t.childLanes,h|=Qr,oe(e,n,h,x,E,C),e===ke&&(he=ke=null,pe=0),zi=t,ln=e,Oa=n,tu=h,au=u,zm=s,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,kv(ra,function(){return Xm(),null})):(e.callbackNode=null,e.callbackPriority=0),s=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||s){s=U.T,U.T=null,u=L.p,L.p=2,x=_e,_e|=4;try{Nv(e,t,n)}finally{_e=x,L.p=u,U.T=s}}Ke=1,Gm(),qm(),Ym()}}function Gm(){if(Ke===1){Ke=0;var e=ln,t=zi,n=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||n){n=U.T,U.T=null;var s=L.p;L.p=2;var u=_e;_e|=4;try{_m(t,e);var h=yu,x=Tf(e.containerInfo),E=h.focusedElem,C=h.selectionRange;if(x!==E&&E&&E.ownerDocument&&wf(E.ownerDocument.documentElement,E)){if(C!==null&&Gr(E)){var P=C.start,V=C.end;if(V===void 0&&(V=P),"selectionStart"in E)E.selectionStart=P,E.selectionEnd=Math.min(V,E.value.length);else{var Q=E.ownerDocument||document,H=Q&&Q.defaultView||window;if(H.getSelection){var Y=H.getSelection(),W=E.textContent.length,ie=Math.min(C.start,W),ze=C.end===void 0?ie:Math.min(C.end,W);!Y.extend&&ie>ze&&(x=ze,ze=ie,ie=x);var k=jf(E,ie),R=jf(E,ze);if(k&&R&&(Y.rangeCount!==1||Y.anchorNode!==k.node||Y.anchorOffset!==k.offset||Y.focusNode!==R.node||Y.focusOffset!==R.offset)){var B=Q.createRange();B.setStart(k.node,k.offset),Y.removeAllRanges(),ie>ze?(Y.addRange(B),Y.extend(R.node,R.offset)):(B.setEnd(R.node,R.offset),Y.addRange(B))}}}}for(Q=[],Y=E;Y=Y.parentNode;)Y.nodeType===1&&Q.push({element:Y,left:Y.scrollLeft,top:Y.scrollTop});for(typeof E.focus=="function"&&E.focus(),E=0;E<Q.length;E++){var X=Q[E];X.element.scrollLeft=X.left,X.element.scrollTop=X.top}}Do=!!gu,yu=gu=null}finally{_e=u,L.p=s,U.T=n}}e.current=t,Ke=2}}function qm(){if(Ke===2){Ke=0;var e=ln,t=zi,n=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||n){n=U.T,U.T=null;var s=L.p;L.p=2;var u=_e;_e|=4;try{ym(e,t.alternate,t)}finally{_e=u,L.p=s,U.T=n}}Ke=3}}function Ym(){if(Ke===4||Ke===3){Ke=0,vr();var e=ln,t=zi,n=Oa,s=zm;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?Ke=5:(Ke=0,zi=ln=null,Vm(e,e.pendingLanes));var u=e.pendingLanes;if(u===0&&(sn=null),Nr(n),t=t.stateNode,ut&&typeof ut.onCommitFiberRoot=="function")try{ut.onCommitFiberRoot(Ga,t,void 0,(t.current.flags&128)===128)}catch{}if(s!==null){t=U.T,u=L.p,L.p=2,U.T=null;try{for(var h=e.onRecoverableError,x=0;x<s.length;x++){var E=s[x];h(E.value,{componentStack:E.stack})}}finally{U.T=t,L.p=u}}(Oa&3)!==0&&bo(),ma(e),u=e.pendingLanes,(n&261930)!==0&&(u&42)!==0?e===nu?Is++:(Is=0,nu=e):Is=0,Hs(0)}}function Vm(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,Ss(t)))}function bo(){return Gm(),qm(),Ym(),Xm()}function Xm(){if(Ke!==5)return!1;var e=ln,t=tu;tu=0;var n=Nr(Oa),s=U.T,u=L.p;try{L.p=32>n?32:n,U.T=null,n=au,au=null;var h=ln,x=Oa;if(Ke=0,zi=ln=null,Oa=0,(_e&6)!==0)throw Error(o(331));var E=_e;if(_e|=4,wm(h.current),Em(h,h.current,x,n),_e=E,Hs(0,!1),ut&&typeof ut.onPostCommitFiberRoot=="function")try{ut.onPostCommitFiberRoot(Ga,h)}catch{}return!0}finally{L.p=u,U.T=s,Vm(e,t)}}function Qm(e,t,n){t=Gt(n,t),t=Oc(e.stateNode,t,2),e=Wa(e,t,2),e!==null&&(O(e,2),ma(e))}function je(e,t,n){if(e.tag===3)Qm(e,e,n);else for(;t!==null;){if(t.tag===3){Qm(t,e,n);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(sn===null||!sn.has(s))){e=Gt(n,e),n=Zh(2),s=Wa(t,n,2),s!==null&&(Fh(n,s,t,e),O(s,2),ma(s));break}}t=t.return}}function lu(e,t,n){var s=e.pingCache;if(s===null){s=e.pingCache=new jv;var u=new Set;s.set(t,u)}else u=s.get(t),u===void 0&&(u=new Set,s.set(t,u));u.has(n)||(Wc=!0,u.add(n),e=Dv.bind(null,e,t,n),t.then(e,e))}function Dv(e,t,n){var s=e.pingCache;s!==null&&s.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,ke===e&&(pe&n)===n&&(Ge===4||Ge===3&&(pe&62914560)===pe&&300>ft()-ho?(_e&2)===0&&Di(e,0):Jc|=n,Ci===pe&&(Ci=0)),ma(e)}function Zm(e,t){t===0&&(t=va()),e=jn(e,t),e!==null&&(O(e,t),ma(e))}function Rv(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Zm(e,n)}function Av(e,t){var n=0;switch(e.tag){case 31:case 13:var s=e.stateNode,u=e.memoizedState;u!==null&&(n=u.retryLane);break;case 19:s=e.stateNode;break;case 22:s=e.stateNode._retryCache;break;default:throw Error(o(314))}s!==null&&s.delete(t),Zm(e,n)}function kv(e,t){return as(e,t)}var xo=null,Ai=null,ou=!1,So=!1,ru=!1,rn=0;function ma(e){e!==Ai&&e.next===null&&(Ai===null?xo=Ai=e:Ai=Ai.next=e),So=!0,ou||(ou=!0,Uv())}function Hs(e,t){if(!ru&&So){ru=!0;do for(var n=!1,s=xo;s!==null;){if(e!==0){var u=s.pendingLanes;if(u===0)var h=0;else{var x=s.suspendedLanes,E=s.pingedLanes;h=(1<<31-at(42|e)+1)-1,h&=u&~(x&~E),h=h&201326741?h&201326741|1:h?h|2:0}h!==0&&(n=!0,Wm(s,h))}else h=pe,h=Wn(s,s===ke?h:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),(h&3)===0||ua(s,h)||(n=!0,Wm(s,h));s=s.next}while(n);ru=!1}}function Ov(){Fm()}function Fm(){So=ou=!1;var e=0;rn!==0&&Xv()&&(e=rn);for(var t=ft(),n=null,s=xo;s!==null;){var u=s.next,h=Km(s,t);h===0?(s.next=null,n===null?xo=u:n.next=u,u===null&&(Ai=n)):(n=s,(e!==0||(h&3)!==0)&&(So=!0)),s=u}Ke!==0&&Ke!==5||Hs(e),rn!==0&&(rn=0)}function Km(e,t){for(var n=e.suspendedLanes,s=e.pingedLanes,u=e.expirationTimes,h=e.pendingLanes&-62914561;0<h;){var x=31-at(h),E=1<<x,C=u[x];C===-1?((E&n)===0||(E&s)!==0)&&(u[x]=_r(E,t)):C<=t&&(e.expiredLanes|=E),h&=~E}if(t=ke,n=pe,n=Wn(e,e===t?n:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),s=e.callbackNode,n===0||e===t&&(Me===2||Me===9)||e.cancelPendingCommit!==null)return s!==null&&s!==null&&ns(s),e.callbackNode=null,e.callbackPriority=0;if((n&3)===0||ua(e,n)){if(t=n&-n,t===e.callbackPriority)return t;switch(s!==null&&ns(s),Nr(n)){case 2:case 8:n=El;break;case 32:n=ra;break;case 268435456:n=ss;break;default:n=ra}return s=$m.bind(null,e),n=as(n,s),e.callbackPriority=t,e.callbackNode=n,t}return s!==null&&s!==null&&ns(s),e.callbackPriority=2,e.callbackNode=null,2}function $m(e,t){if(Ke!==0&&Ke!==5)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(bo()&&e.callbackNode!==n)return null;var s=pe;return s=Wn(e,e===ke?s:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),s===0?null:(Rm(e,s,t),Km(e,ft()),e.callbackNode!=null&&e.callbackNode===n?$m.bind(null,e):null)}function Wm(e,t){if(bo())return null;Rm(e,t,!0)}function Uv(){Zv(function(){(_e&6)!==0?as(Nl,Ov):Fm()})}function cu(){if(rn===0){var e=vi;e===0&&(e=Kn,Kn<<=1,(Kn&261888)===0&&(Kn=256)),rn=e}return rn}function Jm(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Tl(""+e)}function ep(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function Lv(e,t,n,s,u){if(t==="submit"&&n&&n.stateNode===u){var h=Jm((u[xt]||null).action),x=s.submitter;x&&(t=(t=x[xt]||null)?Jm(t.formAction):x.getAttribute("formAction"),t!==null&&(h=t,x=null));var E=new Rl("action","action",null,s,u);e.push({event:E,listeners:[{instance:null,listener:function(){if(s.defaultPrevented){if(rn!==0){var C=x?ep(u,x):new FormData(u);Cc(n,{pending:!0,data:C,method:u.method,action:h},null,C)}}else typeof h=="function"&&(E.preventDefault(),C=x?ep(u,x):new FormData(u),Cc(n,{pending:!0,data:C,method:u.method,action:h},h,C))},currentTarget:u}]})}}for(var uu=0;uu<Xr.length;uu++){var du=Xr[uu],Bv=du.toLowerCase(),Pv=du[0].toUpperCase()+du.slice(1);ea(Bv,"on"+Pv)}ea(Df,"onAnimationEnd"),ea(Rf,"onAnimationIteration"),ea(Af,"onAnimationStart"),ea("dblclick","onDoubleClick"),ea("focusin","onFocus"),ea("focusout","onBlur"),ea(tv,"onTransitionRun"),ea(av,"onTransitionStart"),ea(nv,"onTransitionCancel"),ea(kf,"onTransitionEnd"),ii("onMouseEnter",["mouseout","mouseover"]),ii("onMouseLeave",["mouseout","mouseover"]),ii("onPointerEnter",["pointerout","pointerover"]),ii("onPointerLeave",["pointerout","pointerover"]),_n("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),_n("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),_n("onBeforeInput",["compositionend","keypress","textInput","paste"]),_n("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),_n("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),_n("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Iv=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Gs));function tp(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var s=e[n],u=s.event;s=s.listeners;e:{var h=void 0;if(t)for(var x=s.length-1;0<=x;x--){var E=s[x],C=E.instance,P=E.currentTarget;if(E=E.listener,C!==h&&u.isPropagationStopped())break e;h=E,u.currentTarget=P;try{h(u)}catch(V){Ol(V)}u.currentTarget=null,h=C}else for(x=0;x<s.length;x++){if(E=s[x],C=E.instance,P=E.currentTarget,E=E.listener,C!==h&&u.isPropagationStopped())break e;h=E,u.currentTarget=P;try{h(u)}catch(V){Ol(V)}u.currentTarget=null,h=C}}}}function me(e,t){var n=t[Er];n===void 0&&(n=t[Er]=new Set);var s=e+"__bubble";n.has(s)||(ap(t,e,2,!1),n.add(s))}function fu(e,t,n){var s=0;t&&(s|=4),ap(n,e,s,t)}var _o="_reactListening"+Math.random().toString(36).slice(2);function hu(e){if(!e[_o]){e[_o]=!0,Zd.forEach(function(n){n!=="selectionchange"&&(Iv.has(n)||fu(n,!1,e),fu(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[_o]||(t[_o]=!0,fu("selectionchange",!1,t))}}function ap(e,t,n,s){switch(Dp(t)){case 2:var u=m1;break;case 8:u=p1;break;default:u=Tu}n=u.bind(null,t,n,e),u=void 0,!Ar||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(u=!0),s?u!==void 0?e.addEventListener(t,n,{capture:!0,passive:u}):e.addEventListener(t,n,!0):u!==void 0?e.addEventListener(t,n,{passive:u}):e.addEventListener(t,n,!1)}function mu(e,t,n,s,u){var h=s;if((t&1)===0&&(t&2)===0&&s!==null)e:for(;;){if(s===null)return;var x=s.tag;if(x===3||x===4){var E=s.stateNode.containerInfo;if(E===u)break;if(x===4)for(x=s.return;x!==null;){var C=x.tag;if((C===3||C===4)&&x.stateNode.containerInfo===u)return;x=x.return}for(;E!==null;){if(x=ti(E),x===null)return;if(C=x.tag,C===5||C===6||C===26||C===27){s=h=x;continue e}E=E.parentNode}}s=s.return}of(function(){var P=h,V=Dr(n),Q=[];e:{var H=Of.get(e);if(H!==void 0){var Y=Rl,W=e;switch(e){case"keypress":if(zl(n)===0)break e;case"keydown":case"keyup":Y=Ay;break;case"focusin":W="focus",Y=Lr;break;case"focusout":W="blur",Y=Lr;break;case"beforeblur":case"afterblur":Y=Lr;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Y=uf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Y=Sy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Y=Uy;break;case Df:case Rf:case Af:Y=Ey;break;case kf:Y=By;break;case"scroll":case"scrollend":Y=by;break;case"wheel":Y=Iy;break;case"copy":case"cut":case"paste":Y=jy;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Y=ff;break;case"toggle":case"beforetoggle":Y=Gy}var ie=(t&4)!==0,ze=!ie&&(e==="scroll"||e==="scrollend"),k=ie?H!==null?H+"Capture":null:H;ie=[];for(var R=P,B;R!==null;){var X=R;if(B=X.stateNode,X=X.tag,X!==5&&X!==26&&X!==27||B===null||k===null||(X=us(R,k),X!=null&&ie.push(qs(R,X,B))),ze)break;R=R.return}0<ie.length&&(H=new Y(H,W,null,n,V),Q.push({event:H,listeners:ie}))}}if((t&7)===0){e:{if(H=e==="mouseover"||e==="pointerover",Y=e==="mouseout"||e==="pointerout",H&&n!==zr&&(W=n.relatedTarget||n.fromElement)&&(ti(W)||W[ei]))break e;if((Y||H)&&(H=V.window===V?V:(H=V.ownerDocument)?H.defaultView||H.parentWindow:window,Y?(W=n.relatedTarget||n.toElement,Y=P,W=W?ti(W):null,W!==null&&(ze=c(W),ie=W.tag,W!==ze||ie!==5&&ie!==27&&ie!==6)&&(W=null)):(Y=null,W=P),Y!==W)){if(ie=uf,X="onMouseLeave",k="onMouseEnter",R="mouse",(e==="pointerout"||e==="pointerover")&&(ie=ff,X="onPointerLeave",k="onPointerEnter",R="pointer"),ze=Y==null?H:cs(Y),B=W==null?H:cs(W),H=new ie(X,R+"leave",Y,n,V),H.target=ze,H.relatedTarget=B,X=null,ti(V)===P&&(ie=new ie(k,R+"enter",W,n,V),ie.target=B,ie.relatedTarget=ze,X=ie),ze=X,Y&&W)t:{for(ie=Hv,k=Y,R=W,B=0,X=k;X;X=ie(X))B++;X=0;for(var ne=R;ne;ne=ie(ne))X++;for(;0<B-X;)k=ie(k),B--;for(;0<X-B;)R=ie(R),X--;for(;B--;){if(k===R||R!==null&&k===R.alternate){ie=k;break t}k=ie(k),R=ie(R)}ie=null}else ie=null;Y!==null&&np(Q,H,Y,ie,!1),W!==null&&ze!==null&&np(Q,ze,W,ie,!0)}}e:{if(H=P?cs(P):window,Y=H.nodeName&&H.nodeName.toLowerCase(),Y==="select"||Y==="input"&&H.type==="file")var be=xf;else if(vf(H))if(Sf)be=Wy;else{be=Ky;var ae=Fy}else Y=H.nodeName,!Y||Y.toLowerCase()!=="input"||H.type!=="checkbox"&&H.type!=="radio"?P&&Cr(P.elementType)&&(be=xf):be=$y;if(be&&(be=be(e,P))){bf(Q,be,n,V);break e}ae&&ae(e,H,P),e==="focusout"&&P&&H.type==="number"&&P.memoizedProps.value!=null&&Tr(H,"number",H.value)}switch(ae=P?cs(P):window,e){case"focusin":(vf(ae)||ae.contentEditable==="true")&&(ui=ae,qr=P,vs=null);break;case"focusout":vs=qr=ui=null;break;case"mousedown":Yr=!0;break;case"contextmenu":case"mouseup":case"dragend":Yr=!1,Cf(Q,n,V);break;case"selectionchange":if(ev)break;case"keydown":case"keyup":Cf(Q,n,V)}var ue;if(Pr)e:{switch(e){case"compositionstart":var ge="onCompositionStart";break e;case"compositionend":ge="onCompositionEnd";break e;case"compositionupdate":ge="onCompositionUpdate";break e}ge=void 0}else ci?gf(e,n)&&(ge="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(ge="onCompositionStart");ge&&(hf&&n.locale!=="ko"&&(ci||ge!=="onCompositionStart"?ge==="onCompositionEnd"&&ci&&(ue=rf()):(Va=V,kr="value"in Va?Va.value:Va.textContent,ci=!0)),ae=No(P,ge),0<ae.length&&(ge=new df(ge,e,null,n,V),Q.push({event:ge,listeners:ae}),ue?ge.data=ue:(ue=yf(n),ue!==null&&(ge.data=ue)))),(ue=Yy?Vy(e,n):Xy(e,n))&&(ge=No(P,"onBeforeInput"),0<ge.length&&(ae=new df("onBeforeInput","beforeinput",null,n,V),Q.push({event:ae,listeners:ge}),ae.data=ue)),Lv(Q,e,P,n,V)}tp(Q,t)})}function qs(e,t,n){return{instance:e,listener:t,currentTarget:n}}function No(e,t){for(var n=t+"Capture",s=[];e!==null;){var u=e,h=u.stateNode;if(u=u.tag,u!==5&&u!==26&&u!==27||h===null||(u=us(e,n),u!=null&&s.unshift(qs(e,u,h)),u=us(e,t),u!=null&&s.push(qs(e,u,h))),e.tag===3)return s;e=e.return}return[]}function Hv(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function np(e,t,n,s,u){for(var h=t._reactName,x=[];n!==null&&n!==s;){var E=n,C=E.alternate,P=E.stateNode;if(E=E.tag,C!==null&&C===s)break;E!==5&&E!==26&&E!==27||P===null||(C=P,u?(P=us(n,h),P!=null&&x.unshift(qs(n,P,C))):u||(P=us(n,h),P!=null&&x.push(qs(n,P,C)))),n=n.return}x.length!==0&&e.push({event:t,listeners:x})}var Gv=/\r\n?/g,qv=/\u0000|\uFFFD/g;function ip(e){return(typeof e=="string"?e:""+e).replace(Gv,`
`).replace(qv,"")}function sp(e,t){return t=ip(t),ip(e)===t}function Ce(e,t,n,s,u,h){switch(n){case"children":typeof s=="string"?t==="body"||t==="textarea"&&s===""||li(e,s):(typeof s=="number"||typeof s=="bigint")&&t!=="body"&&li(e,""+s);break;case"className":jl(e,"class",s);break;case"tabIndex":jl(e,"tabindex",s);break;case"dir":case"role":case"viewBox":case"width":case"height":jl(e,n,s);break;case"style":sf(e,s,h);break;case"data":if(t!=="object"){jl(e,"data",s);break}case"src":case"href":if(s===""&&(t!=="a"||n!=="href")){e.removeAttribute(n);break}if(s==null||typeof s=="function"||typeof s=="symbol"||typeof s=="boolean"){e.removeAttribute(n);break}s=Tl(""+s),e.setAttribute(n,s);break;case"action":case"formAction":if(typeof s=="function"){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof h=="function"&&(n==="formAction"?(t!=="input"&&Ce(e,t,"name",u.name,u,null),Ce(e,t,"formEncType",u.formEncType,u,null),Ce(e,t,"formMethod",u.formMethod,u,null),Ce(e,t,"formTarget",u.formTarget,u,null)):(Ce(e,t,"encType",u.encType,u,null),Ce(e,t,"method",u.method,u,null),Ce(e,t,"target",u.target,u,null)));if(s==null||typeof s=="symbol"||typeof s=="boolean"){e.removeAttribute(n);break}s=Tl(""+s),e.setAttribute(n,s);break;case"onClick":s!=null&&(e.onclick=xa);break;case"onScroll":s!=null&&me("scroll",e);break;case"onScrollEnd":s!=null&&me("scrollend",e);break;case"dangerouslySetInnerHTML":if(s!=null){if(typeof s!="object"||!("__html"in s))throw Error(o(61));if(n=s.__html,n!=null){if(u.children!=null)throw Error(o(60));e.innerHTML=n}}break;case"multiple":e.multiple=s&&typeof s!="function"&&typeof s!="symbol";break;case"muted":e.muted=s&&typeof s!="function"&&typeof s!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(s==null||typeof s=="function"||typeof s=="boolean"||typeof s=="symbol"){e.removeAttribute("xlink:href");break}n=Tl(""+s),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":s!=null&&typeof s!="function"&&typeof s!="symbol"?e.setAttribute(n,""+s):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":s&&typeof s!="function"&&typeof s!="symbol"?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":s===!0?e.setAttribute(n,""):s!==!1&&s!=null&&typeof s!="function"&&typeof s!="symbol"?e.setAttribute(n,s):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":s!=null&&typeof s!="function"&&typeof s!="symbol"&&!isNaN(s)&&1<=s?e.setAttribute(n,s):e.removeAttribute(n);break;case"rowSpan":case"start":s==null||typeof s=="function"||typeof s=="symbol"||isNaN(s)?e.removeAttribute(n):e.setAttribute(n,s);break;case"popover":me("beforetoggle",e),me("toggle",e),Ml(e,"popover",s);break;case"xlinkActuate":ba(e,"http://www.w3.org/1999/xlink","xlink:actuate",s);break;case"xlinkArcrole":ba(e,"http://www.w3.org/1999/xlink","xlink:arcrole",s);break;case"xlinkRole":ba(e,"http://www.w3.org/1999/xlink","xlink:role",s);break;case"xlinkShow":ba(e,"http://www.w3.org/1999/xlink","xlink:show",s);break;case"xlinkTitle":ba(e,"http://www.w3.org/1999/xlink","xlink:title",s);break;case"xlinkType":ba(e,"http://www.w3.org/1999/xlink","xlink:type",s);break;case"xmlBase":ba(e,"http://www.w3.org/XML/1998/namespace","xml:base",s);break;case"xmlLang":ba(e,"http://www.w3.org/XML/1998/namespace","xml:lang",s);break;case"xmlSpace":ba(e,"http://www.w3.org/XML/1998/namespace","xml:space",s);break;case"is":Ml(e,"is",s);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=yy.get(n)||n,Ml(e,n,s))}}function pu(e,t,n,s,u,h){switch(n){case"style":sf(e,s,h);break;case"dangerouslySetInnerHTML":if(s!=null){if(typeof s!="object"||!("__html"in s))throw Error(o(61));if(n=s.__html,n!=null){if(u.children!=null)throw Error(o(60));e.innerHTML=n}}break;case"children":typeof s=="string"?li(e,s):(typeof s=="number"||typeof s=="bigint")&&li(e,""+s);break;case"onScroll":s!=null&&me("scroll",e);break;case"onScrollEnd":s!=null&&me("scrollend",e);break;case"onClick":s!=null&&(e.onclick=xa);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Fd.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(u=n.endsWith("Capture"),t=n.slice(2,u?n.length-7:void 0),h=e[xt]||null,h=h!=null?h[n]:null,typeof h=="function"&&e.removeEventListener(t,h,u),typeof s=="function")){typeof h!="function"&&h!==null&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,s,u);break e}n in e?e[n]=s:s===!0?e.setAttribute(n,""):Ml(e,n,s)}}}function ot(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":me("error",e),me("load",e);var s=!1,u=!1,h;for(h in n)if(n.hasOwnProperty(h)){var x=n[h];if(x!=null)switch(h){case"src":s=!0;break;case"srcSet":u=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,t));default:Ce(e,t,h,x,n,null)}}u&&Ce(e,t,"srcSet",n.srcSet,n,null),s&&Ce(e,t,"src",n.src,n,null);return;case"input":me("invalid",e);var E=h=x=u=null,C=null,P=null;for(s in n)if(n.hasOwnProperty(s)){var V=n[s];if(V!=null)switch(s){case"name":u=V;break;case"type":x=V;break;case"checked":C=V;break;case"defaultChecked":P=V;break;case"value":h=V;break;case"defaultValue":E=V;break;case"children":case"dangerouslySetInnerHTML":if(V!=null)throw Error(o(137,t));break;default:Ce(e,t,s,V,n,null)}}ef(e,h,E,C,P,x,u,!1);return;case"select":me("invalid",e),s=x=h=null;for(u in n)if(n.hasOwnProperty(u)&&(E=n[u],E!=null))switch(u){case"value":h=E;break;case"defaultValue":x=E;break;case"multiple":s=E;default:Ce(e,t,u,E,n,null)}t=h,n=x,e.multiple=!!s,t!=null?si(e,!!s,t,!1):n!=null&&si(e,!!s,n,!0);return;case"textarea":me("invalid",e),h=u=s=null;for(x in n)if(n.hasOwnProperty(x)&&(E=n[x],E!=null))switch(x){case"value":s=E;break;case"defaultValue":u=E;break;case"children":h=E;break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(o(91));break;default:Ce(e,t,x,E,n,null)}af(e,s,u,h);return;case"option":for(C in n)if(n.hasOwnProperty(C)&&(s=n[C],s!=null))switch(C){case"selected":e.selected=s&&typeof s!="function"&&typeof s!="symbol";break;default:Ce(e,t,C,s,n,null)}return;case"dialog":me("beforetoggle",e),me("toggle",e),me("cancel",e),me("close",e);break;case"iframe":case"object":me("load",e);break;case"video":case"audio":for(s=0;s<Gs.length;s++)me(Gs[s],e);break;case"image":me("error",e),me("load",e);break;case"details":me("toggle",e);break;case"embed":case"source":case"link":me("error",e),me("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(P in n)if(n.hasOwnProperty(P)&&(s=n[P],s!=null))switch(P){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,t));default:Ce(e,t,P,s,n,null)}return;default:if(Cr(t)){for(V in n)n.hasOwnProperty(V)&&(s=n[V],s!==void 0&&pu(e,t,V,s,n,void 0));return}}for(E in n)n.hasOwnProperty(E)&&(s=n[E],s!=null&&Ce(e,t,E,s,n,null))}function Yv(e,t,n,s){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var u=null,h=null,x=null,E=null,C=null,P=null,V=null;for(Y in n){var Q=n[Y];if(n.hasOwnProperty(Y)&&Q!=null)switch(Y){case"checked":break;case"value":break;case"defaultValue":C=Q;default:s.hasOwnProperty(Y)||Ce(e,t,Y,null,s,Q)}}for(var H in s){var Y=s[H];if(Q=n[H],s.hasOwnProperty(H)&&(Y!=null||Q!=null))switch(H){case"type":h=Y;break;case"name":u=Y;break;case"checked":P=Y;break;case"defaultChecked":V=Y;break;case"value":x=Y;break;case"defaultValue":E=Y;break;case"children":case"dangerouslySetInnerHTML":if(Y!=null)throw Error(o(137,t));break;default:Y!==Q&&Ce(e,t,H,Y,s,Q)}}wr(e,x,E,C,P,V,h,u);return;case"select":Y=x=E=H=null;for(h in n)if(C=n[h],n.hasOwnProperty(h)&&C!=null)switch(h){case"value":break;case"multiple":Y=C;default:s.hasOwnProperty(h)||Ce(e,t,h,null,s,C)}for(u in s)if(h=s[u],C=n[u],s.hasOwnProperty(u)&&(h!=null||C!=null))switch(u){case"value":H=h;break;case"defaultValue":E=h;break;case"multiple":x=h;default:h!==C&&Ce(e,t,u,h,s,C)}t=E,n=x,s=Y,H!=null?si(e,!!n,H,!1):!!s!=!!n&&(t!=null?si(e,!!n,t,!0):si(e,!!n,n?[]:"",!1));return;case"textarea":Y=H=null;for(E in n)if(u=n[E],n.hasOwnProperty(E)&&u!=null&&!s.hasOwnProperty(E))switch(E){case"value":break;case"children":break;default:Ce(e,t,E,null,s,u)}for(x in s)if(u=s[x],h=n[x],s.hasOwnProperty(x)&&(u!=null||h!=null))switch(x){case"value":H=u;break;case"defaultValue":Y=u;break;case"children":break;case"dangerouslySetInnerHTML":if(u!=null)throw Error(o(91));break;default:u!==h&&Ce(e,t,x,u,s,h)}tf(e,H,Y);return;case"option":for(var W in n)if(H=n[W],n.hasOwnProperty(W)&&H!=null&&!s.hasOwnProperty(W))switch(W){case"selected":e.selected=!1;break;default:Ce(e,t,W,null,s,H)}for(C in s)if(H=s[C],Y=n[C],s.hasOwnProperty(C)&&H!==Y&&(H!=null||Y!=null))switch(C){case"selected":e.selected=H&&typeof H!="function"&&typeof H!="symbol";break;default:Ce(e,t,C,H,s,Y)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ie in n)H=n[ie],n.hasOwnProperty(ie)&&H!=null&&!s.hasOwnProperty(ie)&&Ce(e,t,ie,null,s,H);for(P in s)if(H=s[P],Y=n[P],s.hasOwnProperty(P)&&H!==Y&&(H!=null||Y!=null))switch(P){case"children":case"dangerouslySetInnerHTML":if(H!=null)throw Error(o(137,t));break;default:Ce(e,t,P,H,s,Y)}return;default:if(Cr(t)){for(var ze in n)H=n[ze],n.hasOwnProperty(ze)&&H!==void 0&&!s.hasOwnProperty(ze)&&pu(e,t,ze,void 0,s,H);for(V in s)H=s[V],Y=n[V],!s.hasOwnProperty(V)||H===Y||H===void 0&&Y===void 0||pu(e,t,V,H,s,Y);return}}for(var k in n)H=n[k],n.hasOwnProperty(k)&&H!=null&&!s.hasOwnProperty(k)&&Ce(e,t,k,null,s,H);for(Q in s)H=s[Q],Y=n[Q],!s.hasOwnProperty(Q)||H===Y||H==null&&Y==null||Ce(e,t,Q,H,s,Y)}function lp(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Vv(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,n=performance.getEntriesByType("resource"),s=0;s<n.length;s++){var u=n[s],h=u.transferSize,x=u.initiatorType,E=u.duration;if(h&&E&&lp(x)){for(x=0,E=u.responseEnd,s+=1;s<n.length;s++){var C=n[s],P=C.startTime;if(P>E)break;var V=C.transferSize,Q=C.initiatorType;V&&lp(Q)&&(C=C.responseEnd,x+=V*(C<E?1:(E-P)/(C-P)))}if(--s,t+=8*(h+x)/(u.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var gu=null,yu=null;function Eo(e){return e.nodeType===9?e:e.ownerDocument}function op(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function rp(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function vu(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var bu=null;function Xv(){var e=window.event;return e&&e.type==="popstate"?e===bu?!1:(bu=e,!0):(bu=null,!1)}var cp=typeof setTimeout=="function"?setTimeout:void 0,Qv=typeof clearTimeout=="function"?clearTimeout:void 0,up=typeof Promise=="function"?Promise:void 0,Zv=typeof queueMicrotask=="function"?queueMicrotask:typeof up<"u"?function(e){return up.resolve(null).then(e).catch(Fv)}:cp;function Fv(e){setTimeout(function(){throw e})}function cn(e){return e==="head"}function dp(e,t){var n=t,s=0;do{var u=n.nextSibling;if(e.removeChild(n),u&&u.nodeType===8)if(n=u.data,n==="/$"||n==="/&"){if(s===0){e.removeChild(u),Li(t);return}s--}else if(n==="$"||n==="$?"||n==="$~"||n==="$!"||n==="&")s++;else if(n==="html")Ys(e.ownerDocument.documentElement);else if(n==="head"){n=e.ownerDocument.head,Ys(n);for(var h=n.firstChild;h;){var x=h.nextSibling,E=h.nodeName;h[rs]||E==="SCRIPT"||E==="STYLE"||E==="LINK"&&h.rel.toLowerCase()==="stylesheet"||n.removeChild(h),h=x}}else n==="body"&&Ys(e.ownerDocument.body);n=u}while(n);Li(t)}function fp(e,t){var n=e;e=0;do{var s=n.nextSibling;if(n.nodeType===1?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",n.getAttribute("style")===""&&n.removeAttribute("style")):n.nodeType===3&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(e===0)break;e--}else n!=="$"&&n!=="$?"&&n!=="$~"&&n!=="$!"||e++;n=s}while(n)}function xu(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":xu(n),Mr(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}e.removeChild(n)}}function Kv(e,t,n,s){for(;e.nodeType===1;){var u=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!s&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(s){if(!e[rs])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(h=e.getAttribute("rel"),h==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(h!==u.rel||e.getAttribute("href")!==(u.href==null||u.href===""?null:u.href)||e.getAttribute("crossorigin")!==(u.crossOrigin==null?null:u.crossOrigin)||e.getAttribute("title")!==(u.title==null?null:u.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(h=e.getAttribute("src"),(h!==(u.src==null?null:u.src)||e.getAttribute("type")!==(u.type==null?null:u.type)||e.getAttribute("crossorigin")!==(u.crossOrigin==null?null:u.crossOrigin))&&h&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var h=u.name==null?null:""+u.name;if(u.type==="hidden"&&e.getAttribute("name")===h)return e}else return e;if(e=Qt(e.nextSibling),e===null)break}return null}function $v(e,t,n){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=Qt(e.nextSibling),e===null))return null;return e}function hp(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=Qt(e.nextSibling),e===null))return null;return e}function Su(e){return e.data==="$?"||e.data==="$~"}function _u(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function Wv(e,t){var n=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||n.readyState!=="loading")t();else{var s=function(){t(),n.removeEventListener("DOMContentLoaded",s)};n.addEventListener("DOMContentLoaded",s),e._reactRetry=s}}function Qt(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var Nu=null;function mp(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"||n==="/&"){if(t===0)return Qt(e.nextSibling);t--}else n!=="$"&&n!=="$!"&&n!=="$?"&&n!=="$~"&&n!=="&"||t++}e=e.nextSibling}return null}function pp(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"){if(t===0)return e;t--}else n!=="/$"&&n!=="/&"||t++}e=e.previousSibling}return null}function gp(e,t,n){switch(t=Eo(n),e){case"html":if(e=t.documentElement,!e)throw Error(o(452));return e;case"head":if(e=t.head,!e)throw Error(o(453));return e;case"body":if(e=t.body,!e)throw Error(o(454));return e;default:throw Error(o(451))}}function Ys(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Mr(e)}var Zt=new Map,yp=new Set;function Mo(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var Ua=L.d;L.d={f:Jv,r:e1,D:t1,C:a1,L:n1,m:i1,X:l1,S:s1,M:o1};function Jv(){var e=Ua.f(),t=go();return e||t}function e1(e){var t=ai(e);t!==null&&t.tag===5&&t.type==="form"?kh(t):Ua.r(e)}var ki=typeof document>"u"?null:document;function vp(e,t,n){var s=ki;if(s&&typeof t=="string"&&t){var u=It(t);u='link[rel="'+e+'"][href="'+u+'"]',typeof n=="string"&&(u+='[crossorigin="'+n+'"]'),yp.has(u)||(yp.add(u),e={rel:e,crossOrigin:n,href:t},s.querySelector(u)===null&&(t=s.createElement("link"),ot(t,"link",e),We(t),s.head.appendChild(t)))}}function t1(e){Ua.D(e),vp("dns-prefetch",e,null)}function a1(e,t){Ua.C(e,t),vp("preconnect",e,t)}function n1(e,t,n){Ua.L(e,t,n);var s=ki;if(s&&e&&t){var u='link[rel="preload"][as="'+It(t)+'"]';t==="image"&&n&&n.imageSrcSet?(u+='[imagesrcset="'+It(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(u+='[imagesizes="'+It(n.imageSizes)+'"]')):u+='[href="'+It(e)+'"]';var h=u;switch(t){case"style":h=Oi(e);break;case"script":h=Ui(e)}Zt.has(h)||(e=g({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:e,as:t},n),Zt.set(h,e),s.querySelector(u)!==null||t==="style"&&s.querySelector(Vs(h))||t==="script"&&s.querySelector(Xs(h))||(t=s.createElement("link"),ot(t,"link",e),We(t),s.head.appendChild(t)))}}function i1(e,t){Ua.m(e,t);var n=ki;if(n&&e){var s=t&&typeof t.as=="string"?t.as:"script",u='link[rel="modulepreload"][as="'+It(s)+'"][href="'+It(e)+'"]',h=u;switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":h=Ui(e)}if(!Zt.has(h)&&(e=g({rel:"modulepreload",href:e},t),Zt.set(h,e),n.querySelector(u)===null)){switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Xs(h)))return}s=n.createElement("link"),ot(s,"link",e),We(s),n.head.appendChild(s)}}}function s1(e,t,n){Ua.S(e,t,n);var s=ki;if(s&&e){var u=ni(s).hoistableStyles,h=Oi(e);t=t||"default";var x=u.get(h);if(!x){var E={loading:0,preload:null};if(x=s.querySelector(Vs(h)))E.loading=5;else{e=g({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Zt.get(h))&&Eu(e,n);var C=x=s.createElement("link");We(C),ot(C,"link",e),C._p=new Promise(function(P,V){C.onload=P,C.onerror=V}),C.addEventListener("load",function(){E.loading|=1}),C.addEventListener("error",function(){E.loading|=2}),E.loading|=4,jo(x,t,s)}x={type:"stylesheet",instance:x,count:1,state:E},u.set(h,x)}}}function l1(e,t){Ua.X(e,t);var n=ki;if(n&&e){var s=ni(n).hoistableScripts,u=Ui(e),h=s.get(u);h||(h=n.querySelector(Xs(u)),h||(e=g({src:e,async:!0},t),(t=Zt.get(u))&&Mu(e,t),h=n.createElement("script"),We(h),ot(h,"link",e),n.head.appendChild(h)),h={type:"script",instance:h,count:1,state:null},s.set(u,h))}}function o1(e,t){Ua.M(e,t);var n=ki;if(n&&e){var s=ni(n).hoistableScripts,u=Ui(e),h=s.get(u);h||(h=n.querySelector(Xs(u)),h||(e=g({src:e,async:!0,type:"module"},t),(t=Zt.get(u))&&Mu(e,t),h=n.createElement("script"),We(h),ot(h,"link",e),n.head.appendChild(h)),h={type:"script",instance:h,count:1,state:null},s.set(u,h))}}function bp(e,t,n,s){var u=(u=vt.current)?Mo(u):null;if(!u)throw Error(o(446));switch(e){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=Oi(n.href),n=ni(u).hoistableStyles,s=n.get(t),s||(s={type:"style",instance:null,count:0,state:null},n.set(t,s)),s):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){e=Oi(n.href);var h=ni(u).hoistableStyles,x=h.get(e);if(x||(u=u.ownerDocument||u,x={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},h.set(e,x),(h=u.querySelector(Vs(e)))&&!h._p&&(x.instance=h,x.state.loading=5),Zt.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Zt.set(e,n),h||r1(u,e,n,x.state))),t&&s===null)throw Error(o(528,""));return x}if(t&&s!==null)throw Error(o(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Ui(n),n=ni(u).hoistableScripts,s=n.get(t),s||(s={type:"script",instance:null,count:0,state:null},n.set(t,s)),s):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,e))}}function Oi(e){return'href="'+It(e)+'"'}function Vs(e){return'link[rel="stylesheet"]['+e+"]"}function xp(e){return g({},e,{"data-precedence":e.precedence,precedence:null})}function r1(e,t,n,s){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?s.loading=1:(t=e.createElement("link"),s.preload=t,t.addEventListener("load",function(){return s.loading|=1}),t.addEventListener("error",function(){return s.loading|=2}),ot(t,"link",n),We(t),e.head.appendChild(t))}function Ui(e){return'[src="'+It(e)+'"]'}function Xs(e){return"script[async]"+e}function Sp(e,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var s=e.querySelector('style[data-href~="'+It(n.href)+'"]');if(s)return t.instance=s,We(s),s;var u=g({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return s=(e.ownerDocument||e).createElement("style"),We(s),ot(s,"style",u),jo(s,n.precedence,e),t.instance=s;case"stylesheet":u=Oi(n.href);var h=e.querySelector(Vs(u));if(h)return t.state.loading|=4,t.instance=h,We(h),h;s=xp(n),(u=Zt.get(u))&&Eu(s,u),h=(e.ownerDocument||e).createElement("link"),We(h);var x=h;return x._p=new Promise(function(E,C){x.onload=E,x.onerror=C}),ot(h,"link",s),t.state.loading|=4,jo(h,n.precedence,e),t.instance=h;case"script":return h=Ui(n.src),(u=e.querySelector(Xs(h)))?(t.instance=u,We(u),u):(s=n,(u=Zt.get(h))&&(s=g({},n),Mu(s,u)),e=e.ownerDocument||e,u=e.createElement("script"),We(u),ot(u,"link",s),e.head.appendChild(u),t.instance=u);case"void":return null;default:throw Error(o(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(s=t.instance,t.state.loading|=4,jo(s,n.precedence,e));return t.instance}function jo(e,t,n){for(var s=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),u=s.length?s[s.length-1]:null,h=u,x=0;x<s.length;x++){var E=s[x];if(E.dataset.precedence===t)h=E;else if(h!==u)break}h?h.parentNode.insertBefore(e,h.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(e,t.firstChild))}function Eu(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Mu(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var wo=null;function _p(e,t,n){if(wo===null){var s=new Map,u=wo=new Map;u.set(n,s)}else u=wo,s=u.get(n),s||(s=new Map,u.set(n,s));if(s.has(e))return s;for(s.set(e,null),n=n.getElementsByTagName(e),u=0;u<n.length;u++){var h=n[u];if(!(h[rs]||h[nt]||e==="link"&&h.getAttribute("rel")==="stylesheet")&&h.namespaceURI!=="http://www.w3.org/2000/svg"){var x=h.getAttribute(t)||"";x=e+x;var E=s.get(x);E?E.push(h):s.set(x,[h])}}return s}function Np(e,t,n){e=e.ownerDocument||e,e.head.insertBefore(n,t==="title"?e.querySelector("head > title"):null)}function c1(e,t,n){if(n===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function Ep(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function u1(e,t,n,s){if(n.type==="stylesheet"&&(typeof s.media!="string"||matchMedia(s.media).matches!==!1)&&(n.state.loading&4)===0){if(n.instance===null){var u=Oi(s.href),h=t.querySelector(Vs(u));if(h){t=h._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=To.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=h,We(h);return}h=t.ownerDocument||t,s=xp(s),(u=Zt.get(u))&&Eu(s,u),h=h.createElement("link"),We(h);var x=h;x._p=new Promise(function(E,C){x.onload=E,x.onerror=C}),ot(h,"link",s),n.instance=h}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&(n.state.loading&3)===0&&(e.count++,n=To.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}var ju=0;function d1(e,t){return e.stylesheets&&e.count===0&&zo(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var s=setTimeout(function(){if(e.stylesheets&&zo(e,e.stylesheets),e.unsuspend){var h=e.unsuspend;e.unsuspend=null,h()}},6e4+t);0<e.imgBytes&&ju===0&&(ju=62500*Vv());var u=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&zo(e,e.stylesheets),e.unsuspend)){var h=e.unsuspend;e.unsuspend=null,h()}},(e.imgBytes>ju?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(s),clearTimeout(u)}}:null}function To(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)zo(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Co=null;function zo(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Co=new Map,t.forEach(f1,e),Co=null,To.call(e))}function f1(e,t){if(!(t.state.loading&4)){var n=Co.get(e);if(n)var s=n.get(null);else{n=new Map,Co.set(e,n);for(var u=e.querySelectorAll("link[data-precedence],style[data-precedence]"),h=0;h<u.length;h++){var x=u[h];(x.nodeName==="LINK"||x.getAttribute("media")!=="not all")&&(n.set(x.dataset.precedence,x),s=x)}s&&n.set(null,s)}u=t.instance,x=u.getAttribute("data-precedence"),h=n.get(x)||s,h===s&&n.set(null,u),n.set(x,u),this.count++,s=To.bind(this),u.addEventListener("load",s),u.addEventListener("error",s),h?h.parentNode.insertBefore(u,h.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(u,e.firstChild)),t.state.loading|=4}}var Qs={$$typeof:z,Provider:null,Consumer:null,_currentValue:K,_currentValue2:K,_threadCount:0};function h1(e,t,n,s,u,h,x,E,C){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=bt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=bt(0),this.hiddenUpdates=bt(null),this.identifierPrefix=s,this.onUncaughtError=u,this.onCaughtError=h,this.onRecoverableError=x,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=C,this.incompleteTransitions=new Map}function Mp(e,t,n,s,u,h,x,E,C,P,V,Q){return e=new h1(e,t,n,x,C,P,V,Q,E),t=1,h===!0&&(t|=24),h=Dt(3,null,null,t),e.current=h,h.stateNode=e,t=sc(),t.refCount++,e.pooledCache=t,t.refCount++,h.memoizedState={element:s,isDehydrated:n,cache:t},cc(h),e}function jp(e){return e?(e=hi,e):hi}function wp(e,t,n,s,u,h){u=jp(u),s.context===null?s.context=u:s.pendingContext=u,s=$a(t),s.payload={element:n},h=h===void 0?null:h,h!==null&&(s.callback=h),n=Wa(e,s,t),n!==null&&(jt(n,e,t),Ms(n,e,t))}function Tp(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function wu(e,t){Tp(e,t),(e=e.alternate)&&Tp(e,t)}function Cp(e){if(e.tag===13||e.tag===31){var t=jn(e,67108864);t!==null&&jt(t,e,67108864),wu(e,67108864)}}function zp(e){if(e.tag===13||e.tag===31){var t=Ut();t=os(t);var n=jn(e,t);n!==null&&jt(n,e,t),wu(e,t)}}var Do=!0;function m1(e,t,n,s){var u=U.T;U.T=null;var h=L.p;try{L.p=2,Tu(e,t,n,s)}finally{L.p=h,U.T=u}}function p1(e,t,n,s){var u=U.T;U.T=null;var h=L.p;try{L.p=8,Tu(e,t,n,s)}finally{L.p=h,U.T=u}}function Tu(e,t,n,s){if(Do){var u=Cu(s);if(u===null)mu(e,t,s,Ro,n),Rp(e,s);else if(y1(u,e,t,n,s))s.stopPropagation();else if(Rp(e,s),t&4&&-1<g1.indexOf(e)){for(;u!==null;){var h=ai(u);if(h!==null)switch(h.tag){case 3:if(h=h.stateNode,h.current.memoizedState.isDehydrated){var x=ya(h.pendingLanes);if(x!==0){var E=h;for(E.pendingLanes|=2,E.entangledLanes|=2;x;){var C=1<<31-at(x);E.entanglements[1]|=C,x&=~C}ma(h),(_e&6)===0&&(mo=ft()+500,Hs(0))}}break;case 31:case 13:E=jn(h,2),E!==null&&jt(E,h,2),go(),wu(h,2)}if(h=Cu(s),h===null&&mu(e,t,s,Ro,n),h===u)break;u=h}u!==null&&s.stopPropagation()}else mu(e,t,s,null,n)}}function Cu(e){return e=Dr(e),zu(e)}var Ro=null;function zu(e){if(Ro=null,e=ti(e),e!==null){var t=c(e);if(t===null)e=null;else{var n=t.tag;if(n===13){if(e=d(t),e!==null)return e;e=null}else if(n===31){if(e=m(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Ro=e,null}function Dp(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(br()){case Nl:return 2;case El:return 8;case ra:case is:return 32;case ss:return 268435456;default:return 32}default:return 32}}var Du=!1,un=null,dn=null,fn=null,Zs=new Map,Fs=new Map,hn=[],g1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Rp(e,t){switch(e){case"focusin":case"focusout":un=null;break;case"dragenter":case"dragleave":dn=null;break;case"mouseover":case"mouseout":fn=null;break;case"pointerover":case"pointerout":Zs.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fs.delete(t.pointerId)}}function Ks(e,t,n,s,u,h){return e===null||e.nativeEvent!==h?(e={blockedOn:t,domEventName:n,eventSystemFlags:s,nativeEvent:h,targetContainers:[u]},t!==null&&(t=ai(t),t!==null&&Cp(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,u!==null&&t.indexOf(u)===-1&&t.push(u),e)}function y1(e,t,n,s,u){switch(t){case"focusin":return un=Ks(un,e,t,n,s,u),!0;case"dragenter":return dn=Ks(dn,e,t,n,s,u),!0;case"mouseover":return fn=Ks(fn,e,t,n,s,u),!0;case"pointerover":var h=u.pointerId;return Zs.set(h,Ks(Zs.get(h)||null,e,t,n,s,u)),!0;case"gotpointercapture":return h=u.pointerId,Fs.set(h,Ks(Fs.get(h)||null,e,t,n,s,u)),!0}return!1}function Ap(e){var t=ti(e.target);if(t!==null){var n=c(t);if(n!==null){if(t=n.tag,t===13){if(t=d(n),t!==null){e.blockedOn=t,Xd(e.priority,function(){zp(n)});return}}else if(t===31){if(t=m(n),t!==null){e.blockedOn=t,Xd(e.priority,function(){zp(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ao(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Cu(e.nativeEvent);if(n===null){n=e.nativeEvent;var s=new n.constructor(n.type,n);zr=s,n.target.dispatchEvent(s),zr=null}else return t=ai(n),t!==null&&Cp(t),e.blockedOn=n,!1;t.shift()}return!0}function kp(e,t,n){Ao(e)&&n.delete(t)}function v1(){Du=!1,un!==null&&Ao(un)&&(un=null),dn!==null&&Ao(dn)&&(dn=null),fn!==null&&Ao(fn)&&(fn=null),Zs.forEach(kp),Fs.forEach(kp)}function ko(e,t){e.blockedOn===t&&(e.blockedOn=null,Du||(Du=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,v1)))}var Oo=null;function Op(e){Oo!==e&&(Oo=e,a.unstable_scheduleCallback(a.unstable_NormalPriority,function(){Oo===e&&(Oo=null);for(var t=0;t<e.length;t+=3){var n=e[t],s=e[t+1],u=e[t+2];if(typeof s!="function"){if(zu(s||n)===null)continue;break}var h=ai(n);h!==null&&(e.splice(t,3),t-=3,Cc(h,{pending:!0,data:u,method:n.method,action:s},s,u))}}))}function Li(e){function t(C){return ko(C,e)}un!==null&&ko(un,e),dn!==null&&ko(dn,e),fn!==null&&ko(fn,e),Zs.forEach(t),Fs.forEach(t);for(var n=0;n<hn.length;n++){var s=hn[n];s.blockedOn===e&&(s.blockedOn=null)}for(;0<hn.length&&(n=hn[0],n.blockedOn===null);)Ap(n),n.blockedOn===null&&hn.shift();if(n=(e.ownerDocument||e).$$reactFormReplay,n!=null)for(s=0;s<n.length;s+=3){var u=n[s],h=n[s+1],x=u[xt]||null;if(typeof h=="function")x||Op(n);else if(x){var E=null;if(h&&h.hasAttribute("formAction")){if(u=h,x=h[xt]||null)E=x.formAction;else if(zu(u)!==null)continue}else E=x.action;typeof E=="function"?n[s+1]=E:(n.splice(s,3),s-=3),Op(n)}}}function Up(){function e(h){h.canIntercept&&h.info==="react-transition"&&h.intercept({handler:function(){return new Promise(function(x){return u=x})},focusReset:"manual",scroll:"manual"})}function t(){u!==null&&(u(),u=null),s||setTimeout(n,20)}function n(){if(!s&&!navigation.transition){var h=navigation.currentEntry;h&&h.url!=null&&navigation.navigate(h.url,{state:h.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var s=!1,u=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){s=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),u!==null&&(u(),u=null)}}}function Ru(e){this._internalRoot=e}Uo.prototype.render=Ru.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(o(409));var n=t.current,s=Ut();wp(n,s,e,t,null,null)},Uo.prototype.unmount=Ru.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;wp(e.current,2,null,e,null,null),go(),t[ei]=null}};function Uo(e){this._internalRoot=e}Uo.prototype.unstable_scheduleHydration=function(e){if(e){var t=Vd();e={blockedOn:null,target:e,priority:t};for(var n=0;n<hn.length&&t!==0&&t<hn[n].priority;n++);hn.splice(n,0,e),n===0&&Ap(e)}};var Lp=i.version;if(Lp!=="19.2.0")throw Error(o(527,Lp,"19.2.0"));L.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(o(188)):(e=Object.keys(e).join(","),Error(o(268,e)));return e=y(t),e=e!==null?v(e):null,e=e===null?null:e.stateNode,e};var b1={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:U,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Lo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Lo.isDisabled&&Lo.supportsFiber)try{Ga=Lo.inject(b1),ut=Lo}catch{}}return Ws.createRoot=function(e,t){if(!r(e))throw Error(o(299));var n=!1,s="",u=Yh,h=Vh,x=Xh;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onUncaughtError!==void 0&&(u=t.onUncaughtError),t.onCaughtError!==void 0&&(h=t.onCaughtError),t.onRecoverableError!==void 0&&(x=t.onRecoverableError)),t=Mp(e,1,!1,null,null,n,s,null,u,h,x,Up),e[ei]=t.current,hu(e),new Ru(t)},Ws.hydrateRoot=function(e,t,n){if(!r(e))throw Error(o(299));var s=!1,u="",h=Yh,x=Vh,E=Xh,C=null;return n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(u=n.identifierPrefix),n.onUncaughtError!==void 0&&(h=n.onUncaughtError),n.onCaughtError!==void 0&&(x=n.onCaughtError),n.onRecoverableError!==void 0&&(E=n.onRecoverableError),n.formState!==void 0&&(C=n.formState)),t=Mp(e,1,!0,t,n??null,s,u,C,h,x,E,Up),t.context=jp(null),n=t.current,s=Ut(),s=os(s),u=$a(s),u.callback=null,Wa(n,u,s),n=s,t.current.lanes=n,O(t,n),ma(t),e[ei]=t.current,hu(e),new Uo(t)},Ws.version="19.2.0",Ws}var Vp;function F1(){if(Vp)return ku.exports;Vp=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(i){console.error(i)}}return a(),ku.exports=Z1(),ku.exports}var K1=F1(),Lu={exports:{}},Bu={};var Xp;function $1(){if(Xp)return Bu;Xp=1;var a=_d();function i(p,y){return p===y&&(p!==0||1/p===1/y)||p!==p&&y!==y}var l=typeof Object.is=="function"?Object.is:i,o=a.useSyncExternalStore,r=a.useRef,c=a.useEffect,d=a.useMemo,m=a.useDebugValue;return Bu.useSyncExternalStoreWithSelector=function(p,y,v,g,b){var S=r(null);if(S.current===null){var _={hasValue:!1,value:null};S.current=_}else _=S.current;S=d(function(){function M(A){if(!T){if(T=!0,w=A,A=g(A),b!==void 0&&_.hasValue){var q=_.value;if(b(q,A))return z=q}return z=A}if(q=z,l(w,A))return q;var I=g(A);return b!==void 0&&b(q,I)?(w=A,q):(w=A,z=I)}var T=!1,w,z,D=v===void 0?null:v;return[function(){return M(y())},D===null?void 0:function(){return M(D())}]},[y,v,g,b]);var N=o(p,S[0],S[1]);return c(function(){_.hasValue=!0,_.value=N},[N]),m(N),N},Bu}var Qp;function W1(){return Qp||(Qp=1,Lu.exports=$1()),Lu.exports}var J1=W1();function eb(a){a()}function tb(){let a=null,i=null;return{clear(){a=null,i=null},notify(){eb(()=>{let l=a;for(;l;)l.callback(),l=l.next})},get(){const l=[];let o=a;for(;o;)l.push(o),o=o.next;return l},subscribe(l){let o=!0;const r=i={callback:l,next:null,prev:i};return r.prev?r.prev.next=r:a=r,function(){!o||a===null||(o=!1,r.next?r.next.prev=r.prev:i=r.prev,r.prev?r.prev.next=r.next:a=r.next)}}}}var Zp={notify(){},get:()=>[]};function ab(a,i){let l,o=Zp,r=0,c=!1;function d(N){v();const M=o.subscribe(N);let T=!1;return()=>{T||(T=!0,M(),g())}}function m(){o.notify()}function p(){_.onStateChange&&_.onStateChange()}function y(){return c}function v(){r++,l||(l=a.subscribe(p),o=tb())}function g(){r--,l&&r===0&&(l(),l=void 0,o.clear(),o=Zp)}function b(){c||(c=!0,v())}function S(){c&&(c=!1,g())}const _={addNestedSub:d,notifyNestedSubs:m,handleChangeWrapper:p,isSubscribed:y,trySubscribe:b,tryUnsubscribe:S,getListeners:()=>o};return _}var nb=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ib=nb(),sb=()=>typeof navigator<"u"&&navigator.product==="ReactNative",lb=sb(),ob=()=>ib||lb?j.useLayoutEffect:j.useEffect,rb=ob(),cb=Symbol.for("react-redux-context"),ub=typeof globalThis<"u"?globalThis:{};function db(){if(!j.createContext)return{};const a=ub[cb]??=new Map;let i=a.get(j.createContext);return i||(i=j.createContext(null),a.set(j.createContext,i)),i}var bn=db();function fb(a){const{children:i,context:l,serverState:o,store:r}=a,c=j.useMemo(()=>{const p=ab(r);return{store:r,subscription:p,getServerState:o?()=>o:void 0}},[r,o]),d=j.useMemo(()=>r.getState(),[r]);rb(()=>{const{subscription:p}=c;return p.onStateChange=p.notifyNestedSubs,p.trySubscribe(),d!==r.getState()&&p.notifyNestedSubs(),()=>{p.tryUnsubscribe(),p.onStateChange=void 0}},[c,d]);const m=l||bn;return j.createElement(m.Provider,{value:c},i)}var hb=fb;function Nd(a=bn){return function(){return j.useContext(a)}}var tg=Nd();function ag(a=bn){const i=a===bn?tg:Nd(a),l=()=>{const{store:o}=i();return o};return Object.assign(l,{withTypes:()=>l}),l}var mb=ag();function pb(a=bn){const i=a===bn?mb:ag(a),l=()=>i().dispatch;return Object.assign(l,{withTypes:()=>l}),l}var gb=pb(),yb=(a,i)=>a===i;function vb(a=bn){const i=a===bn?tg:Nd(a),l=(o,r={})=>{const{equalityFn:c=yb}=typeof r=="function"?{equalityFn:r}:r,d=i(),{store:m,subscription:p,getServerState:y}=d;j.useRef(!0);const v=j.useCallback({[o.name](b){return o(b)}}[o.name],[o]),g=J1.useSyncExternalStoreWithSelector(p.addNestedSub,m.getState,y||m.getState,v,c);return j.useDebugValue(g),g};return Object.assign(l,{withTypes:()=>l}),l}var bb=vb();var Fp="popstate";function xb(a={}){function i(o,r){let{pathname:c,search:d,hash:m}=o.location;return od("",{pathname:c,search:d,hash:m},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function l(o,r){return typeof r=="string"?r:cl(r)}return _b(i,l,null,a)}function Ie(a,i){if(a===!1||a===null||typeof a>"u")throw new Error(i)}function Jt(a,i){if(!a){typeof console<"u"&&console.warn(i);try{throw new Error(i)}catch{}}}function Sb(){return Math.random().toString(36).substring(2,10)}function Kp(a,i){return{usr:a.state,key:a.key,idx:i}}function od(a,i,l=null,o){return{pathname:typeof a=="string"?a:a.pathname,search:"",hash:"",...typeof i=="string"?Xi(i):i,state:l,key:i&&i.key||o||Sb()}}function cl({pathname:a="/",search:i="",hash:l=""}){return i&&i!=="?"&&(a+=i.charAt(0)==="?"?i:"?"+i),l&&l!=="#"&&(a+=l.charAt(0)==="#"?l:"#"+l),a}function Xi(a){let i={};if(a){let l=a.indexOf("#");l>=0&&(i.hash=a.substring(l),a=a.substring(0,l));let o=a.indexOf("?");o>=0&&(i.search=a.substring(o),a=a.substring(0,o)),a&&(i.pathname=a)}return i}function _b(a,i,l,o={}){let{window:r=document.defaultView,v5Compat:c=!1}=o,d=r.history,m="POP",p=null,y=v();y==null&&(y=0,d.replaceState({...d.state,idx:y},""));function v(){return(d.state||{idx:null}).idx}function g(){m="POP";let M=v(),T=M==null?null:M-y;y=M,p&&p({action:m,location:N.location,delta:T})}function b(M,T){m="PUSH";let w=od(N.location,M,T);y=v()+1;let z=Kp(w,y),D=N.createHref(w);try{d.pushState(z,"",D)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;r.location.assign(D)}c&&p&&p({action:m,location:N.location,delta:1})}function S(M,T){m="REPLACE";let w=od(N.location,M,T);y=v();let z=Kp(w,y),D=N.createHref(w);d.replaceState(z,"",D),c&&p&&p({action:m,location:N.location,delta:0})}function _(M){return Nb(M)}let N={get action(){return m},get location(){return a(r,d)},listen(M){if(p)throw new Error("A history only accepts one active listener");return r.addEventListener(Fp,g),p=M,()=>{r.removeEventListener(Fp,g),p=null}},createHref(M){return i(r,M)},createURL:_,encodeLocation(M){let T=_(M);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:b,replace:S,go(M){return d.go(M)}};return N}function Nb(a,i=!1){let l="http://localhost";typeof window<"u"&&(l=window.location.origin!=="null"?window.location.origin:window.location.href),Ie(l,"No window.location.(origin|href) available to create URL");let o=typeof a=="string"?a:cl(a);return o=o.replace(/ $/,"%20"),!i&&o.startsWith("//")&&(o=l+o),new URL(o,l)}function ng(a,i,l="/"){return Eb(a,i,l,!1)}function Eb(a,i,l,o){let r=typeof i=="string"?Xi(i):i,c=Ia(r.pathname||"/",l);if(c==null)return null;let d=ig(a);Mb(d);let m=null;for(let p=0;m==null&&p<d.length;++p){let y=Ub(c);m=kb(d[p],y,o)}return m}function ig(a,i=[],l=[],o="",r=!1){let c=(d,m,p=r,y)=>{let v={relativePath:y===void 0?d.path||"":y,caseSensitive:d.caseSensitive===!0,childrenIndex:m,route:d};if(v.relativePath.startsWith("/")){if(!v.relativePath.startsWith(o)&&p)return;Ie(v.relativePath.startsWith(o),`Absolute route path "${v.relativePath}" nested under path "${o}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),v.relativePath=v.relativePath.slice(o.length)}let g=Ba([o,v.relativePath]),b=l.concat(v);d.children&&d.children.length>0&&(Ie(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${g}".`),ig(d.children,i,b,g,p)),!(d.path==null&&!d.index)&&i.push({path:g,score:Rb(g,d.index),routesMeta:b})};return a.forEach((d,m)=>{if(d.path===""||!d.path?.includes("?"))c(d,m);else for(let p of sg(d.path))c(d,m,!0,p)}),i}function sg(a){let i=a.split("/");if(i.length===0)return[];let[l,...o]=i,r=l.endsWith("?"),c=l.replace(/\?$/,"");if(o.length===0)return r?[c,""]:[c];let d=sg(o.join("/")),m=[];return m.push(...d.map(p=>p===""?c:[c,p].join("/"))),r&&m.push(...d),m.map(p=>a.startsWith("/")&&p===""?"/":p)}function Mb(a){a.sort((i,l)=>i.score!==l.score?l.score-i.score:Ab(i.routesMeta.map(o=>o.childrenIndex),l.routesMeta.map(o=>o.childrenIndex)))}var jb=/^:[\w-]+$/,wb=3,Tb=2,Cb=1,zb=10,Db=-2,$p=a=>a==="*";function Rb(a,i){let l=a.split("/"),o=l.length;return l.some($p)&&(o+=Db),i&&(o+=Tb),l.filter(r=>!$p(r)).reduce((r,c)=>r+(jb.test(c)?wb:c===""?Cb:zb),o)}function Ab(a,i){return a.length===i.length&&a.slice(0,-1).every((o,r)=>o===i[r])?a[a.length-1]-i[i.length-1]:0}function kb(a,i,l=!1){let{routesMeta:o}=a,r={},c="/",d=[];for(let m=0;m<o.length;++m){let p=o[m],y=m===o.length-1,v=c==="/"?i:i.slice(c.length)||"/",g=ar({path:p.relativePath,caseSensitive:p.caseSensitive,end:y},v),b=p.route;if(!g&&y&&l&&!o[o.length-1].route.index&&(g=ar({path:p.relativePath,caseSensitive:p.caseSensitive,end:!1},v)),!g)return null;Object.assign(r,g.params),d.push({params:r,pathname:Ba([c,g.pathname]),pathnameBase:Hb(Ba([c,g.pathnameBase])),route:b}),g.pathnameBase!=="/"&&(c=Ba([c,g.pathnameBase]))}return d}function ar(a,i){typeof a=="string"&&(a={path:a,caseSensitive:!1,end:!0});let[l,o]=Ob(a.path,a.caseSensitive,a.end),r=i.match(l);if(!r)return null;let c=r[0],d=c.replace(/(.)\/+$/,"$1"),m=r.slice(1);return{params:o.reduce((y,{paramName:v,isOptional:g},b)=>{if(v==="*"){let _=m[b]||"";d=c.slice(0,c.length-_.length).replace(/(.)\/+$/,"$1")}const S=m[b];return g&&!S?y[v]=void 0:y[v]=(S||"").replace(/%2F/g,"/"),y},{}),pathname:c,pathnameBase:d,pattern:a}}function Ob(a,i=!1,l=!0){Jt(a==="*"||!a.endsWith("*")||a.endsWith("/*"),`Route path "${a}" will be treated as if it were "${a.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${a.replace(/\*$/,"/*")}".`);let o=[],r="^"+a.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,m,p)=>(o.push({paramName:m,isOptional:p!=null}),p?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return a.endsWith("*")?(o.push({paramName:"*"}),r+=a==="*"||a==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):l?r+="\\/*$":a!==""&&a!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,i?void 0:"i"),o]}function Ub(a){try{return a.split("/").map(i=>decodeURIComponent(i).replace(/\//g,"%2F")).join("/")}catch(i){return Jt(!1,`The URL path "${a}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${i}).`),a}}function Ia(a,i){if(i==="/")return a;if(!a.toLowerCase().startsWith(i.toLowerCase()))return null;let l=i.endsWith("/")?i.length-1:i.length,o=a.charAt(l);return o&&o!=="/"?null:a.slice(l)||"/"}var Lb=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Bb=a=>Lb.test(a);function Pb(a,i="/"){let{pathname:l,search:o="",hash:r=""}=typeof a=="string"?Xi(a):a,c;if(l)if(Bb(l))c=l;else{if(l.includes("//")){let d=l;l=l.replace(/\/\/+/g,"/"),Jt(!1,`Pathnames cannot have embedded double slashes - normalizing ${d} -> ${l}`)}l.startsWith("/")?c=Wp(l.substring(1),"/"):c=Wp(l,i)}else c=i;return{pathname:c,search:Gb(o),hash:qb(r)}}function Wp(a,i){let l=i.replace(/\/+$/,"").split("/");return a.split("/").forEach(r=>{r===".."?l.length>1&&l.pop():r!=="."&&l.push(r)}),l.length>1?l.join("/"):"/"}function Pu(a,i,l,o){return`Cannot include a '${a}' character in a manually specified \`to.${i}\` field [${JSON.stringify(o)}].  Please separate it out to the \`to.${l}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Ib(a){return a.filter((i,l)=>l===0||i.route.path&&i.route.path.length>0)}function Ed(a){let i=Ib(a);return i.map((l,o)=>o===i.length-1?l.pathname:l.pathnameBase)}function Md(a,i,l,o=!1){let r;typeof a=="string"?r=Xi(a):(r={...a},Ie(!r.pathname||!r.pathname.includes("?"),Pu("?","pathname","search",r)),Ie(!r.pathname||!r.pathname.includes("#"),Pu("#","pathname","hash",r)),Ie(!r.search||!r.search.includes("#"),Pu("#","search","hash",r)));let c=a===""||r.pathname==="",d=c?"/":r.pathname,m;if(d==null)m=l;else{let g=i.length-1;if(!o&&d.startsWith("..")){let b=d.split("/");for(;b[0]==="..";)b.shift(),g-=1;r.pathname=b.join("/")}m=g>=0?i[g]:"/"}let p=Pb(r,m),y=d&&d!=="/"&&d.endsWith("/"),v=(c||d===".")&&l.endsWith("/");return!p.pathname.endsWith("/")&&(y||v)&&(p.pathname+="/"),p}var Ba=a=>a.join("/").replace(/\/\/+/g,"/"),Hb=a=>a.replace(/\/+$/,"").replace(/^\/*/,"/"),Gb=a=>!a||a==="?"?"":a.startsWith("?")?a:"?"+a,qb=a=>!a||a==="#"?"":a.startsWith("#")?a:"#"+a;function Yb(a){return a!=null&&typeof a.status=="number"&&typeof a.statusText=="string"&&typeof a.internal=="boolean"&&"data"in a}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var lg=["POST","PUT","PATCH","DELETE"];new Set(lg);var Vb=["GET",...lg];new Set(Vb);var Qi=j.createContext(null);Qi.displayName="DataRouter";var rr=j.createContext(null);rr.displayName="DataRouterState";j.createContext(!1);var og=j.createContext({isTransitioning:!1});og.displayName="ViewTransition";var Xb=j.createContext(new Map);Xb.displayName="Fetchers";var Qb=j.createContext(null);Qb.displayName="Await";var la=j.createContext(null);la.displayName="Navigation";var gl=j.createContext(null);gl.displayName="Location";var pa=j.createContext({outlet:null,matches:[],isDataRoute:!1});pa.displayName="Route";var jd=j.createContext(null);jd.displayName="RouteError";function Zb(a,{relative:i}={}){Ie(Zi(),"useHref() may be used only in the context of a <Router> component.");let{basename:l,navigator:o}=j.useContext(la),{hash:r,pathname:c,search:d}=yl(a,{relative:i}),m=c;return l!=="/"&&(m=c==="/"?l:Ba([l,c])),o.createHref({pathname:m,search:d,hash:r})}function Zi(){return j.useContext(gl)!=null}function xn(){return Ie(Zi(),"useLocation() may be used only in the context of a <Router> component."),j.useContext(gl).location}var rg="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function cg(a){j.useContext(la).static||j.useLayoutEffect(a)}function wd(){let{isDataRoute:a}=j.useContext(pa);return a?ox():Fb()}function Fb(){Ie(Zi(),"useNavigate() may be used only in the context of a <Router> component.");let a=j.useContext(Qi),{basename:i,navigator:l}=j.useContext(la),{matches:o}=j.useContext(pa),{pathname:r}=xn(),c=JSON.stringify(Ed(o)),d=j.useRef(!1);return cg(()=>{d.current=!0}),j.useCallback((p,y={})=>{if(Jt(d.current,rg),!d.current)return;if(typeof p=="number"){l.go(p);return}let v=Md(p,JSON.parse(c),r,y.relative==="path");a==null&&i!=="/"&&(v.pathname=v.pathname==="/"?i:Ba([i,v.pathname])),(y.replace?l.replace:l.push)(v,y.state,y)},[i,l,c,r,a])}j.createContext(null);function yl(a,{relative:i}={}){let{matches:l}=j.useContext(pa),{pathname:o}=xn(),r=JSON.stringify(Ed(l));return j.useMemo(()=>Md(a,JSON.parse(r),o,i==="path"),[a,r,o,i])}function Kb(a,i){return ug(a,i)}function ug(a,i,l,o,r){Ie(Zi(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:c}=j.useContext(la),{matches:d}=j.useContext(pa),m=d[d.length-1],p=m?m.params:{},y=m?m.pathname:"/",v=m?m.pathnameBase:"/",g=m&&m.route;{let w=g&&g.path||"";dg(y,!g||w.endsWith("*")||w.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${y}" (under <Route path="${w}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${w}"> to <Route path="${w==="/"?"*":`${w}/*`}">.`)}let b=xn(),S;if(i){let w=typeof i=="string"?Xi(i):i;Ie(v==="/"||w.pathname?.startsWith(v),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${v}" but pathname "${w.pathname}" was given in the \`location\` prop.`),S=w}else S=b;let _=S.pathname||"/",N=_;if(v!=="/"){let w=v.replace(/^\//,"").split("/");N="/"+_.replace(/^\//,"").split("/").slice(w.length).join("/")}let M=ng(a,{pathname:N});Jt(g||M!=null,`No routes matched location "${S.pathname}${S.search}${S.hash}" `),Jt(M==null||M[M.length-1].route.element!==void 0||M[M.length-1].route.Component!==void 0||M[M.length-1].route.lazy!==void 0,`Matched leaf route at location "${S.pathname}${S.search}${S.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let T=tx(M&&M.map(w=>Object.assign({},w,{params:Object.assign({},p,w.params),pathname:Ba([v,c.encodeLocation?c.encodeLocation(w.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?v:Ba([v,c.encodeLocation?c.encodeLocation(w.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:w.pathnameBase])})),d,l,o,r);return i&&T?j.createElement(gl.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...S},navigationType:"POP"}},T):T}function $b(){let a=lx(),i=Yb(a)?`${a.status} ${a.statusText}`:a instanceof Error?a.message:JSON.stringify(a),l=a instanceof Error?a.stack:null,o="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:o},c={padding:"2px 4px",backgroundColor:o},d=null;return console.error("Error handled by React Router default ErrorBoundary:",a),d=j.createElement(j.Fragment,null,j.createElement("p",null," Hey developer "),j.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",j.createElement("code",{style:c},"ErrorBoundary")," or"," ",j.createElement("code",{style:c},"errorElement")," prop on your route.")),j.createElement(j.Fragment,null,j.createElement("h2",null,"Unexpected Application Error!"),j.createElement("h3",{style:{fontStyle:"italic"}},i),l?j.createElement("pre",{style:r},l):null,d)}var Wb=j.createElement($b,null),Jb=class extends j.Component{constructor(a){super(a),this.state={location:a.location,revalidation:a.revalidation,error:a.error}}static getDerivedStateFromError(a){return{error:a}}static getDerivedStateFromProps(a,i){return i.location!==a.location||i.revalidation!=="idle"&&a.revalidation==="idle"?{error:a.error,location:a.location,revalidation:a.revalidation}:{error:a.error!==void 0?a.error:i.error,location:i.location,revalidation:a.revalidation||i.revalidation}}componentDidCatch(a,i){this.props.onError?this.props.onError(a,i):console.error("React Router caught the following error during render",a)}render(){return this.state.error!==void 0?j.createElement(pa.Provider,{value:this.props.routeContext},j.createElement(jd.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function ex({routeContext:a,match:i,children:l}){let o=j.useContext(Qi);return o&&o.static&&o.staticContext&&(i.route.errorElement||i.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=i.route.id),j.createElement(pa.Provider,{value:a},l)}function tx(a,i=[],l=null,o=null,r=null){if(a==null){if(!l)return null;if(l.errors)a=l.matches;else if(i.length===0&&!l.initialized&&l.matches.length>0)a=l.matches;else return null}let c=a,d=l?.errors;if(d!=null){let v=c.findIndex(g=>g.route.id&&d?.[g.route.id]!==void 0);Ie(v>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),c=c.slice(0,Math.min(c.length,v+1))}let m=!1,p=-1;if(l)for(let v=0;v<c.length;v++){let g=c[v];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(p=v),g.route.id){let{loaderData:b,errors:S}=l,_=g.route.loader&&!b.hasOwnProperty(g.route.id)&&(!S||S[g.route.id]===void 0);if(g.route.lazy||_){m=!0,p>=0?c=c.slice(0,p+1):c=[c[0]];break}}}let y=l&&o?(v,g)=>{o(v,{location:l.location,params:l.matches?.[0]?.params??{},errorInfo:g})}:void 0;return c.reduceRight((v,g,b)=>{let S,_=!1,N=null,M=null;l&&(S=d&&g.route.id?d[g.route.id]:void 0,N=g.route.errorElement||Wb,m&&(p<0&&b===0?(dg("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),_=!0,M=null):p===b&&(_=!0,M=g.route.hydrateFallbackElement||null)));let T=i.concat(c.slice(0,b+1)),w=()=>{let z;return S?z=N:_?z=M:g.route.Component?z=j.createElement(g.route.Component,null):g.route.element?z=g.route.element:z=v,j.createElement(ex,{match:g,routeContext:{outlet:v,matches:T,isDataRoute:l!=null},children:z})};return l&&(g.route.ErrorBoundary||g.route.errorElement||b===0)?j.createElement(Jb,{location:l.location,revalidation:l.revalidation,component:N,error:S,children:w(),routeContext:{outlet:null,matches:T,isDataRoute:!0},onError:y}):w()},null)}function Td(a){return`${a} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ax(a){let i=j.useContext(Qi);return Ie(i,Td(a)),i}function nx(a){let i=j.useContext(rr);return Ie(i,Td(a)),i}function ix(a){let i=j.useContext(pa);return Ie(i,Td(a)),i}function Cd(a){let i=ix(a),l=i.matches[i.matches.length-1];return Ie(l.route.id,`${a} can only be used on routes that contain a unique "id"`),l.route.id}function sx(){return Cd("useRouteId")}function lx(){let a=j.useContext(jd),i=nx("useRouteError"),l=Cd("useRouteError");return a!==void 0?a:i.errors?.[l]}function ox(){let{router:a}=ax("useNavigate"),i=Cd("useNavigate"),l=j.useRef(!1);return cg(()=>{l.current=!0}),j.useCallback(async(r,c={})=>{Jt(l.current,rg),l.current&&(typeof r=="number"?a.navigate(r):await a.navigate(r,{fromRouteId:i,...c}))},[a,i])}var Jp={};function dg(a,i,l){!i&&!Jp[a]&&(Jp[a]=!0,Jt(!1,l))}j.memo(rx);function rx({routes:a,future:i,state:l,unstable_onError:o}){return ug(a,void 0,l,o,i)}function e0({to:a,replace:i,state:l,relative:o}){Ie(Zi(),"<Navigate> may be used only in the context of a <Router> component.");let{static:r}=j.useContext(la);Jt(!r,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:c}=j.useContext(pa),{pathname:d}=xn(),m=wd(),p=Md(a,Ed(c),d,o==="path"),y=JSON.stringify(p);return j.useEffect(()=>{m(JSON.parse(y),{replace:i,state:l,relative:o})},[m,y,o,i,l]),null}function $o(a){Ie(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function cx({basename:a="/",children:i=null,location:l,navigationType:o="POP",navigator:r,static:c=!1}){Ie(!Zi(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let d=a.replace(/^\/*/,"/"),m=j.useMemo(()=>({basename:d,navigator:r,static:c,future:{}}),[d,r,c]);typeof l=="string"&&(l=Xi(l));let{pathname:p="/",search:y="",hash:v="",state:g=null,key:b="default"}=l,S=j.useMemo(()=>{let _=Ia(p,d);return _==null?null:{location:{pathname:_,search:y,hash:v,state:g,key:b},navigationType:o}},[d,p,y,v,g,b,o]);return Jt(S!=null,`<Router basename="${d}"> is not able to match the URL "${p}${y}${v}" because it does not start with the basename, so the <Router> won't render anything.`),S==null?null:j.createElement(la.Provider,{value:m},j.createElement(gl.Provider,{children:i,value:S}))}function ux({children:a,location:i}){return Kb(rd(a),i)}function rd(a,i=[]){let l=[];return j.Children.forEach(a,(o,r)=>{if(!j.isValidElement(o))return;let c=[...i,r];if(o.type===j.Fragment){l.push.apply(l,rd(o.props.children,c));return}Ie(o.type===$o,`[${typeof o.type=="string"?o.type:o.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ie(!o.props.index||!o.props.children,"An index route cannot have child routes.");let d={id:o.props.id||c.join("-"),caseSensitive:o.props.caseSensitive,element:o.props.element,Component:o.props.Component,index:o.props.index,path:o.props.path,middleware:o.props.middleware,loader:o.props.loader,action:o.props.action,hydrateFallbackElement:o.props.hydrateFallbackElement,HydrateFallback:o.props.HydrateFallback,errorElement:o.props.errorElement,ErrorBoundary:o.props.ErrorBoundary,hasErrorBoundary:o.props.hasErrorBoundary===!0||o.props.ErrorBoundary!=null||o.props.errorElement!=null,shouldRevalidate:o.props.shouldRevalidate,handle:o.props.handle,lazy:o.props.lazy};o.props.children&&(d.children=rd(o.props.children,c)),l.push(d)}),l}var Wo="get",Jo="application/x-www-form-urlencoded";function cr(a){return a!=null&&typeof a.tagName=="string"}function dx(a){return cr(a)&&a.tagName.toLowerCase()==="button"}function fx(a){return cr(a)&&a.tagName.toLowerCase()==="form"}function hx(a){return cr(a)&&a.tagName.toLowerCase()==="input"}function mx(a){return!!(a.metaKey||a.altKey||a.ctrlKey||a.shiftKey)}function px(a,i){return a.button===0&&(!i||i==="_self")&&!mx(a)}var Bo=null;function gx(){if(Bo===null)try{new FormData(document.createElement("form"),0),Bo=!1}catch{Bo=!0}return Bo}var yx=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Iu(a){return a!=null&&!yx.has(a)?(Jt(!1,`"${a}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Jo}"`),null):a}function vx(a,i){let l,o,r,c,d;if(fx(a)){let m=a.getAttribute("action");o=m?Ia(m,i):null,l=a.getAttribute("method")||Wo,r=Iu(a.getAttribute("enctype"))||Jo,c=new FormData(a)}else if(dx(a)||hx(a)&&(a.type==="submit"||a.type==="image")){let m=a.form;if(m==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let p=a.getAttribute("formaction")||m.getAttribute("action");if(o=p?Ia(p,i):null,l=a.getAttribute("formmethod")||m.getAttribute("method")||Wo,r=Iu(a.getAttribute("formenctype"))||Iu(m.getAttribute("enctype"))||Jo,c=new FormData(m,a),!gx()){let{name:y,type:v,value:g}=a;if(v==="image"){let b=y?`${y}.`:"";c.append(`${b}x`,"0"),c.append(`${b}y`,"0")}else y&&c.append(y,g)}}else{if(cr(a))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');l=Wo,o=null,r=Jo,d=a}return c&&r==="text/plain"&&(d=c,c=void 0),{action:o,method:l.toLowerCase(),encType:r,formData:c,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function zd(a,i){if(a===!1||a===null||typeof a>"u")throw new Error(i)}function bx(a,i,l){let o=typeof a=="string"?new URL(a,typeof window>"u"?"server://singlefetch/":window.location.origin):a;return o.pathname==="/"?o.pathname=`_root.${l}`:i&&Ia(o.pathname,i)==="/"?o.pathname=`${i.replace(/\/$/,"")}/_root.${l}`:o.pathname=`${o.pathname.replace(/\/$/,"")}.${l}`,o}async function xx(a,i){if(a.id in i)return i[a.id];try{let l=await import(a.module);return i[a.id]=l,l}catch(l){return console.error(`Error loading route module \`${a.module}\`, reloading page...`),console.error(l),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Sx(a){return a==null?!1:a.href==null?a.rel==="preload"&&typeof a.imageSrcSet=="string"&&typeof a.imageSizes=="string":typeof a.rel=="string"&&typeof a.href=="string"}async function _x(a,i,l){let o=await Promise.all(a.map(async r=>{let c=i.routes[r.route.id];if(c){let d=await xx(c,l);return d.links?d.links():[]}return[]}));return jx(o.flat(1).filter(Sx).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function t0(a,i,l,o,r,c){let d=(p,y)=>l[y]?p.route.id!==l[y].route.id:!0,m=(p,y)=>l[y].pathname!==p.pathname||l[y].route.path?.endsWith("*")&&l[y].params["*"]!==p.params["*"];return c==="assets"?i.filter((p,y)=>d(p,y)||m(p,y)):c==="data"?i.filter((p,y)=>{let v=o.routes[p.route.id];if(!v||!v.hasLoader)return!1;if(d(p,y)||m(p,y))return!0;if(p.route.shouldRevalidate){let g=p.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:l[0]?.params||{},nextUrl:new URL(a,window.origin),nextParams:p.params,defaultShouldRevalidate:!0});if(typeof g=="boolean")return g}return!0}):[]}function Nx(a,i,{includeHydrateFallback:l}={}){return Ex(a.map(o=>{let r=i.routes[o.route.id];if(!r)return[];let c=[r.module];return r.clientActionModule&&(c=c.concat(r.clientActionModule)),r.clientLoaderModule&&(c=c.concat(r.clientLoaderModule)),l&&r.hydrateFallbackModule&&(c=c.concat(r.hydrateFallbackModule)),r.imports&&(c=c.concat(r.imports)),c}).flat(1))}function Ex(a){return[...new Set(a)]}function Mx(a){let i={},l=Object.keys(a).sort();for(let o of l)i[o]=a[o];return i}function jx(a,i){let l=new Set;return new Set(i),a.reduce((o,r)=>{let c=JSON.stringify(Mx(r));return l.has(c)||(l.add(c),o.push({key:c,link:r})),o},[])}function fg(){let a=j.useContext(Qi);return zd(a,"You must render this element inside a <DataRouterContext.Provider> element"),a}function wx(){let a=j.useContext(rr);return zd(a,"You must render this element inside a <DataRouterStateContext.Provider> element"),a}var Dd=j.createContext(void 0);Dd.displayName="FrameworkContext";function hg(){let a=j.useContext(Dd);return zd(a,"You must render this element inside a <HydratedRouter> element"),a}function Tx(a,i){let l=j.useContext(Dd),[o,r]=j.useState(!1),[c,d]=j.useState(!1),{onFocus:m,onBlur:p,onMouseEnter:y,onMouseLeave:v,onTouchStart:g}=i,b=j.useRef(null);j.useEffect(()=>{if(a==="render"&&d(!0),a==="viewport"){let N=T=>{T.forEach(w=>{d(w.isIntersecting)})},M=new IntersectionObserver(N,{threshold:.5});return b.current&&M.observe(b.current),()=>{M.disconnect()}}},[a]),j.useEffect(()=>{if(o){let N=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(N)}}},[o]);let S=()=>{r(!0)},_=()=>{r(!1),d(!1)};return l?a!=="intent"?[c,b,{}]:[c,b,{onFocus:Js(m,S),onBlur:Js(p,_),onMouseEnter:Js(y,S),onMouseLeave:Js(v,_),onTouchStart:Js(g,S)}]:[!1,b,{}]}function Js(a,i){return l=>{a&&a(l),l.defaultPrevented||i(l)}}function Cx({page:a,...i}){let{router:l}=fg(),o=j.useMemo(()=>ng(l.routes,a,l.basename),[l.routes,a,l.basename]);return o?j.createElement(Dx,{page:a,matches:o,...i}):null}function zx(a){let{manifest:i,routeModules:l}=hg(),[o,r]=j.useState([]);return j.useEffect(()=>{let c=!1;return _x(a,i,l).then(d=>{c||r(d)}),()=>{c=!0}},[a,i,l]),o}function Dx({page:a,matches:i,...l}){let o=xn(),{manifest:r,routeModules:c}=hg(),{basename:d}=fg(),{loaderData:m,matches:p}=wx(),y=j.useMemo(()=>t0(a,i,p,r,o,"data"),[a,i,p,r,o]),v=j.useMemo(()=>t0(a,i,p,r,o,"assets"),[a,i,p,r,o]),g=j.useMemo(()=>{if(a===o.pathname+o.search+o.hash)return[];let _=new Set,N=!1;if(i.forEach(T=>{let w=r.routes[T.route.id];!w||!w.hasLoader||(!y.some(z=>z.route.id===T.route.id)&&T.route.id in m&&c[T.route.id]?.shouldRevalidate||w.hasClientLoader?N=!0:_.add(T.route.id))}),_.size===0)return[];let M=bx(a,d,"data");return N&&_.size>0&&M.searchParams.set("_routes",i.filter(T=>_.has(T.route.id)).map(T=>T.route.id).join(",")),[M.pathname+M.search]},[d,m,o,r,y,i,a,c]),b=j.useMemo(()=>Nx(v,r),[v,r]),S=zx(v);return j.createElement(j.Fragment,null,g.map(_=>j.createElement("link",{key:_,rel:"prefetch",as:"fetch",href:_,...l})),b.map(_=>j.createElement("link",{key:_,rel:"modulepreload",href:_,...l})),S.map(({key:_,link:N})=>j.createElement("link",{key:_,nonce:l.nonce,...N})))}function Rx(...a){return i=>{a.forEach(l=>{typeof l=="function"?l(i):l!=null&&(l.current=i)})}}var mg=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{mg&&(window.__reactRouterVersion="7.9.6")}catch{}function Ax({basename:a,children:i,window:l}){let o=j.useRef();o.current==null&&(o.current=xb({window:l,v5Compat:!0}));let r=o.current,[c,d]=j.useState({action:r.action,location:r.location}),m=j.useCallback(p=>{j.startTransition(()=>d(p))},[d]);return j.useLayoutEffect(()=>r.listen(m),[r,m]),j.createElement(cx,{basename:a,children:i,location:c.location,navigationType:c.action,navigator:r})}var pg=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,gg=j.forwardRef(function({onClick:i,discover:l="render",prefetch:o="none",relative:r,reloadDocument:c,replace:d,state:m,target:p,to:y,preventScrollReset:v,viewTransition:g,...b},S){let{basename:_}=j.useContext(la),N=typeof y=="string"&&pg.test(y),M,T=!1;if(typeof y=="string"&&N&&(M=y,mg))try{let F=new URL(window.location.href),Z=y.startsWith("//")?new URL(F.protocol+y):new URL(y),J=Ia(Z.pathname,_);Z.origin===F.origin&&J!=null?y=J+Z.search+Z.hash:T=!0}catch{Jt(!1,`<Link to="${y}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let w=Zb(y,{relative:r}),[z,D,A]=Tx(o,b),q=Lx(y,{replace:d,state:m,target:p,preventScrollReset:v,relative:r,viewTransition:g});function I(F){i&&i(F),F.defaultPrevented||q(F)}let G=j.createElement("a",{...b,...A,href:M||w,onClick:T||c?i:I,ref:Rx(S,D),target:p,"data-discover":!N&&l==="render"?"true":void 0});return z&&!N?j.createElement(j.Fragment,null,G,j.createElement(Cx,{page:w})):G});gg.displayName="Link";var kx=j.forwardRef(function({"aria-current":i="page",caseSensitive:l=!1,className:o="",end:r=!1,style:c,to:d,viewTransition:m,children:p,...y},v){let g=yl(d,{relative:y.relative}),b=xn(),S=j.useContext(rr),{navigator:_,basename:N}=j.useContext(la),M=S!=null&&Gx(g)&&m===!0,T=_.encodeLocation?_.encodeLocation(g).pathname:g.pathname,w=b.pathname,z=S&&S.navigation&&S.navigation.location?S.navigation.location.pathname:null;l||(w=w.toLowerCase(),z=z?z.toLowerCase():null,T=T.toLowerCase()),z&&N&&(z=Ia(z,N)||z);const D=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let A=w===T||!r&&w.startsWith(T)&&w.charAt(D)==="/",q=z!=null&&(z===T||!r&&z.startsWith(T)&&z.charAt(T.length)==="/"),I={isActive:A,isPending:q,isTransitioning:M},G=A?i:void 0,F;typeof o=="function"?F=o(I):F=[o,A?"active":null,q?"pending":null,M?"transitioning":null].filter(Boolean).join(" ");let Z=typeof c=="function"?c(I):c;return j.createElement(gg,{...y,"aria-current":G,className:F,ref:v,style:Z,to:d,viewTransition:m},typeof p=="function"?p(I):p)});kx.displayName="NavLink";var Ox=j.forwardRef(({discover:a="render",fetcherKey:i,navigate:l,reloadDocument:o,replace:r,state:c,method:d=Wo,action:m,onSubmit:p,relative:y,preventScrollReset:v,viewTransition:g,...b},S)=>{let _=Ix(),N=Hx(m,{relative:y}),M=d.toLowerCase()==="get"?"get":"post",T=typeof m=="string"&&pg.test(m),w=z=>{if(p&&p(z),z.defaultPrevented)return;z.preventDefault();let D=z.nativeEvent.submitter,A=D?.getAttribute("formmethod")||d;_(D||z.currentTarget,{fetcherKey:i,method:A,navigate:l,replace:r,state:c,relative:y,preventScrollReset:v,viewTransition:g})};return j.createElement("form",{ref:S,method:M,action:N,onSubmit:o?p:w,...b,"data-discover":!T&&a==="render"?"true":void 0})});Ox.displayName="Form";function Ux(a){return`${a} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function yg(a){let i=j.useContext(Qi);return Ie(i,Ux(a)),i}function Lx(a,{target:i,replace:l,state:o,preventScrollReset:r,relative:c,viewTransition:d}={}){let m=wd(),p=xn(),y=yl(a,{relative:c});return j.useCallback(v=>{if(px(v,i)){v.preventDefault();let g=l!==void 0?l:cl(p)===cl(y);m(a,{replace:g,state:o,preventScrollReset:r,relative:c,viewTransition:d})}},[p,m,y,l,o,i,a,r,c,d])}var Bx=0,Px=()=>`__${String(++Bx)}__`;function Ix(){let{router:a}=yg("useSubmit"),{basename:i}=j.useContext(la),l=sx();return j.useCallback(async(o,r={})=>{let{action:c,method:d,encType:m,formData:p,body:y}=vx(o,i);if(r.navigate===!1){let v=r.fetcherKey||Px();await a.fetch(v,l,r.action||c,{preventScrollReset:r.preventScrollReset,formData:p,body:y,formMethod:r.method||d,formEncType:r.encType||m,flushSync:r.flushSync})}else await a.navigate(r.action||c,{preventScrollReset:r.preventScrollReset,formData:p,body:y,formMethod:r.method||d,formEncType:r.encType||m,replace:r.replace,state:r.state,fromRouteId:l,flushSync:r.flushSync,viewTransition:r.viewTransition})},[a,i,l])}function Hx(a,{relative:i}={}){let{basename:l}=j.useContext(la),o=j.useContext(pa);Ie(o,"useFormAction must be used inside a RouteContext");let[r]=o.matches.slice(-1),c={...yl(a||".",{relative:i})},d=xn();if(a==null){c.search=d.search;let m=new URLSearchParams(c.search),p=m.getAll("index");if(p.some(v=>v==="")){m.delete("index"),p.filter(g=>g).forEach(g=>m.append("index",g));let v=m.toString();c.search=v?`?${v}`:""}}return(!a||a===".")&&r.route.index&&(c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index"),l!=="/"&&(c.pathname=c.pathname==="/"?l:Ba([l,c.pathname])),cl(c)}function Gx(a,{relative:i}={}){let l=j.useContext(og);Ie(l!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:o}=yg("useViewTransitionState"),r=yl(a,{relative:i});if(!l.isTransitioning)return!1;let c=Ia(l.currentLocation.pathname,o)||l.currentLocation.pathname,d=Ia(l.nextLocation.pathname,o)||l.nextLocation.pathname;return ar(r.pathname,d)!=null||ar(r.pathname,c)!=null}const gt=["energy","minerals","food","research","influence"],a0=(a,i,l)=>Math.max(i,Math.min(l,a)),vg={baseStability:65,min:20,max:95,overcrowdingThreshold:2,overcrowdingPenalty:2,deficitThreshold:25,deficitPenalty:5,happinessBonusPerSpecialist:.5,happinessPenaltyPerWorker:.2},qx=a=>gt.reduce((i,l)=>{const o=a[l]??0;return i[l]={amount:o,income:0,upkeep:0},i},{}),Yx=(a,i,l)=>({id:`HOME-${a}`,name:i.name,systemId:a,kind:i.kind,size:i.size,habitability:i.habitability??1,population:{total:i.population,workers:i.population,specialists:0,researchers:0},baseProduction:i.baseProduction,upkeep:i.upkeep,districts:{...i.districts??{}},stability:l.baseStability,happiness:l.baseStability}),Vx=(a,i)=>({resources:qx(i.startingResources),planets:[Yx(a,i.homeworld,i.morale??vg)]}),Fi=(a,i)=>Object.entries(i).every(([l,o])=>o?a.resources[l]?.amount>=o:!0),vl=(a,i)=>{const l={...a.resources};return Object.entries(i).forEach(([o,r])=>{if(!r)return;const c=o,d=l[c];d&&(l[c]={...d,amount:Math.max(0,d.amount-r)})}),{...a,resources:l}},Xx=(a,i)=>{const l=gt.reduce((c,d)=>(c[d]={base:a.baseProduction[d]??0,districts:0,population:0,upkeep:a.upkeep[d]??0,net:0},c),{}),o=new Map(i.districts.map(c=>[c.id,c])),r=new Map(i.populationJobs.map(c=>[c.id,c]));return Object.entries(a.districts??{}).forEach(([c,d])=>{const m=o.get(c);!m||(d??0)<=0||gt.forEach(p=>{const y=m.production[p]??0,v=m.upkeep[p]??0;l[p].districts+=y*d,l[p].upkeep+=v*d})}),r.forEach((c,d)=>{const m=a.population[d]??0;m<=0||gt.forEach(p=>{const y=c.production[p]??0,v=c.upkeep[p]??0;l[p].population+=y*m,l[p].upkeep+=v*m})}),gt.forEach(c=>{const d=l[c];d.net=d.base+d.districts+d.population-d.upkeep}),l},Qx=(a,i,l)=>{const o=l.morale??vg,r=Math.max(0,a.size/o.overcrowdingThreshold),c=Math.max(0,a.population.total-r)*o.overcrowdingPenalty,d=gt.reduce((_,N)=>{const T=i.resources[N]?.amount??0;if(T>=o.deficitThreshold)return _;const w=(o.deficitThreshold-T)/o.deficitThreshold;return _+w*o.deficitPenalty},0),m=a.habitability??1,p=m<1?Math.round((1-m)*20):0,y=o.baseStability-c-d-p,v=a0(y,o.min,o.max),g=(a.population.specialists??0)+(a.population.researchers??0),b=v+g*o.happinessBonusPerSpecialist-a.population.workers*o.happinessPenaltyPerWorker,S=a0(b,o.min,o.max);return{stability:v,happiness:S,modifier:v/100}},Hu=(a,i,l)=>{const o=l?.incomeMultipliers?.[i]??0;return a*(1+o)},Gu=(a,i,l)=>Math.min(l,Math.max(i,a)),Zx=(a,i,l)=>{const o=gt.reduce((y,v)=>(y.income[v]=0,y.upkeep[v]=0,y),{income:{},upkeep:{}}),r=new Map(i.districts.map(y=>[y.id,y])),c=new Map(i.populationJobs.map(y=>[y.id,y])),d=[];a.planets.forEach(y=>{const v=Qx(y,a,i);gt.forEach(g=>{const b=Hu((y.baseProduction[g]??0)*v.modifier,g,l),S=y.upkeep[g]??0;o.income[g]+=b,o.upkeep[g]+=S}),Object.entries(y.districts??{}).forEach(([g,b])=>{const S=r.get(g);!S||b<=0||gt.forEach(_=>{const N=Hu((S.production[_]??0)*v.modifier,_,l),M=S.upkeep[_]??0;o.income[_]+=N*b,o.upkeep[_]+=M*b})}),c.forEach(g=>{const b=y.population[g.id]??0;b<=0||gt.forEach(S=>{const _=Hu((g.production[S]??0)*v.modifier,S,l),N=g.upkeep[S]??0;o.income[S]+=_*b,o.upkeep[S]+=N*b})}),d.push({...y,stability:v.stability,happiness:v.happiness})});const m={...a.resources},p={energy:0,minerals:0,food:0,research:0,influence:0};return gt.forEach(y=>{let v=o.income[y];const g=o.upkeep[y];y==="influence"&&(l?.influenceFlat??0)!==0&&(v+=l?.influenceFlat??0);const b=v-g;p[y]=b;const S=m[y]??{amount:0},_=Gu(v,-99999,99999),N=Gu(g,-99999,99999),M=Gu(S.amount+b,0,999999);m[y]={amount:M,income:_,upkeep:N}}),{economy:{...a,resources:m,planets:d},netProduction:p}};function rt(a){return`Minified Redux error #${a}; visit https://redux.js.org/Errors?code=${a} for the full message or use the non-minified dev environment for full errors. `}var Fx=typeof Symbol=="function"&&Symbol.observable||"@@observable",n0=Fx,qu=()=>Math.random().toString(36).substring(7).split("").join("."),Kx={INIT:`@@redux/INIT${qu()}`,REPLACE:`@@redux/REPLACE${qu()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${qu()}`},nr=Kx;function Rd(a){if(typeof a!="object"||a===null)return!1;let i=a;for(;Object.getPrototypeOf(i)!==null;)i=Object.getPrototypeOf(i);return Object.getPrototypeOf(a)===i||Object.getPrototypeOf(a)===null}function bg(a,i,l){if(typeof a!="function")throw new Error(rt(2));if(typeof i=="function"&&typeof l=="function"||typeof l=="function"&&typeof arguments[3]=="function")throw new Error(rt(0));if(typeof i=="function"&&typeof l>"u"&&(l=i,i=void 0),typeof l<"u"){if(typeof l!="function")throw new Error(rt(1));return l(bg)(a,i)}let o=a,r=i,c=new Map,d=c,m=0,p=!1;function y(){d===c&&(d=new Map,c.forEach((M,T)=>{d.set(T,M)}))}function v(){if(p)throw new Error(rt(3));return r}function g(M){if(typeof M!="function")throw new Error(rt(4));if(p)throw new Error(rt(5));let T=!0;y();const w=m++;return d.set(w,M),function(){if(T){if(p)throw new Error(rt(6));T=!1,y(),d.delete(w),c=null}}}function b(M){if(!Rd(M))throw new Error(rt(7));if(typeof M.type>"u")throw new Error(rt(8));if(typeof M.type!="string")throw new Error(rt(17));if(p)throw new Error(rt(9));try{p=!0,r=o(r,M)}finally{p=!1}return(c=d).forEach(w=>{w()}),M}function S(M){if(typeof M!="function")throw new Error(rt(10));o=M,b({type:nr.REPLACE})}function _(){const M=g;return{subscribe(T){if(typeof T!="object"||T===null)throw new Error(rt(11));function w(){const D=T;D.next&&D.next(v())}return w(),{unsubscribe:M(w)}},[n0](){return this}}}return b({type:nr.INIT}),{dispatch:b,subscribe:g,getState:v,replaceReducer:S,[n0]:_}}function $x(a){Object.keys(a).forEach(i=>{const l=a[i];if(typeof l(void 0,{type:nr.INIT})>"u")throw new Error(rt(12));if(typeof l(void 0,{type:nr.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(rt(13))})}function Wx(a){const i=Object.keys(a),l={};for(let c=0;c<i.length;c++){const d=i[c];typeof a[d]=="function"&&(l[d]=a[d])}const o=Object.keys(l);let r;try{$x(l)}catch(c){r=c}return function(d={},m){if(r)throw r;let p=!1;const y={};for(let v=0;v<o.length;v++){const g=o[v],b=l[g],S=d[g],_=b(S,m);if(typeof _>"u")throw m&&m.type,new Error(rt(14));y[g]=_,p=p||_!==S}return p=p||o.length!==Object.keys(d).length,p?y:d}}function ir(...a){return a.length===0?i=>i:a.length===1?a[0]:a.reduce((i,l)=>(...o)=>i(l(...o)))}function Jx(...a){return i=>(l,o)=>{const r=i(l,o);let c=()=>{throw new Error(rt(15))};const d={getState:r.getState,dispatch:(p,...y)=>c(p,...y)},m=a.map(p=>p(d));return c=ir(...m)(r.dispatch),{...r,dispatch:c}}}function eS(a){return Rd(a)&&"type"in a&&typeof a.type=="string"}var xg=Symbol.for("immer-nothing"),i0=Symbol.for("immer-draftable"),Bt=Symbol.for("immer-state");function ia(a,...i){throw new Error(`[Immer] minified error nr: ${a}. Full error at: https://bit.ly/3cXEKWf`)}var ul=Object.getPrototypeOf;function qn(a){return!!a&&!!a[Bt]}function Ha(a){return a?Sg(a)||Array.isArray(a)||!!a[i0]||!!a.constructor?.[i0]||bl(a)||dr(a):!1}var tS=Object.prototype.constructor.toString(),s0=new WeakMap;function Sg(a){if(!a||typeof a!="object")return!1;const i=Object.getPrototypeOf(a);if(i===null||i===Object.prototype)return!0;const l=Object.hasOwnProperty.call(i,"constructor")&&i.constructor;if(l===Object)return!0;if(typeof l!="function")return!1;let o=s0.get(l);return o===void 0&&(o=Function.toString.call(l),s0.set(l,o)),o===tS}function sr(a,i,l=!0){ur(a)===0?(l?Reflect.ownKeys(a):Object.keys(a)).forEach(r=>{i(r,a[r],a)}):a.forEach((o,r)=>i(r,o,a))}function ur(a){const i=a[Bt];return i?i.type_:Array.isArray(a)?1:bl(a)?2:dr(a)?3:0}function cd(a,i){return ur(a)===2?a.has(i):Object.prototype.hasOwnProperty.call(a,i)}function _g(a,i,l){const o=ur(a);o===2?a.set(i,l):o===3?a.add(l):a[i]=l}function aS(a,i){return a===i?a!==0||1/a===1/i:a!==a&&i!==i}function bl(a){return a instanceof Map}function dr(a){return a instanceof Set}function Pn(a){return a.copy_||a.base_}function ud(a,i){if(bl(a))return new Map(a);if(dr(a))return new Set(a);if(Array.isArray(a))return Array.prototype.slice.call(a);const l=Sg(a);if(i===!0||i==="class_only"&&!l){const o=Object.getOwnPropertyDescriptors(a);delete o[Bt];let r=Reflect.ownKeys(o);for(let c=0;c<r.length;c++){const d=r[c],m=o[d];m.writable===!1&&(m.writable=!0,m.configurable=!0),(m.get||m.set)&&(o[d]={configurable:!0,writable:!0,enumerable:m.enumerable,value:a[d]})}return Object.create(ul(a),o)}else{const o=ul(a);if(o!==null&&l)return{...a};const r=Object.create(o);return Object.assign(r,a)}}function Ad(a,i=!1){return fr(a)||qn(a)||!Ha(a)||(ur(a)>1&&Object.defineProperties(a,{set:Po,add:Po,clear:Po,delete:Po}),Object.freeze(a),i&&Object.values(a).forEach(l=>Ad(l,!0))),a}function nS(){ia(2)}var Po={value:nS};function fr(a){return a===null||typeof a!="object"?!0:Object.isFrozen(a)}var iS={};function Yn(a){const i=iS[a];return i||ia(0,a),i}var dl;function Ng(){return dl}function sS(a,i){return{drafts_:[],parent_:a,immer_:i,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function l0(a,i){i&&(Yn("Patches"),a.patches_=[],a.inversePatches_=[],a.patchListener_=i)}function dd(a){fd(a),a.drafts_.forEach(lS),a.drafts_=null}function fd(a){a===dl&&(dl=a.parent_)}function o0(a){return dl=sS(dl,a)}function lS(a){const i=a[Bt];i.type_===0||i.type_===1?i.revoke_():i.revoked_=!0}function r0(a,i){i.unfinalizedDrafts_=i.drafts_.length;const l=i.drafts_[0];return a!==void 0&&a!==l?(l[Bt].modified_&&(dd(i),ia(4)),Ha(a)&&(a=lr(i,a),i.parent_||or(i,a)),i.patches_&&Yn("Patches").generateReplacementPatches_(l[Bt].base_,a,i.patches_,i.inversePatches_)):a=lr(i,l,[]),dd(i),i.patches_&&i.patchListener_(i.patches_,i.inversePatches_),a!==xg?a:void 0}function lr(a,i,l){if(fr(i))return i;const o=a.immer_.shouldUseStrictIteration(),r=i[Bt];if(!r)return sr(i,(c,d)=>c0(a,r,i,c,d,l),o),i;if(r.scope_!==a)return i;if(!r.modified_)return or(a,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const c=r.copy_;let d=c,m=!1;r.type_===3&&(d=new Set(c),c.clear(),m=!0),sr(d,(p,y)=>c0(a,r,c,p,y,l,m),o),or(a,c,!1),l&&a.patches_&&Yn("Patches").generatePatches_(r,l,a.patches_,a.inversePatches_)}return r.copy_}function c0(a,i,l,o,r,c,d){if(r==null||typeof r!="object"&&!d)return;const m=fr(r);if(!(m&&!d)){if(qn(r)){const p=c&&i&&i.type_!==3&&!cd(i.assigned_,o)?c.concat(o):void 0,y=lr(a,r,p);if(_g(l,o,y),qn(y))a.canAutoFreeze_=!1;else return}else d&&l.add(r);if(Ha(r)&&!m){if(!a.immer_.autoFreeze_&&a.unfinalizedDrafts_<1||i&&i.base_&&i.base_[o]===r&&m)return;lr(a,r),(!i||!i.scope_.parent_)&&typeof o!="symbol"&&(bl(l)?l.has(o):Object.prototype.propertyIsEnumerable.call(l,o))&&or(a,r)}}}function or(a,i,l=!1){!a.parent_&&a.immer_.autoFreeze_&&a.canAutoFreeze_&&Ad(i,l)}function oS(a,i){const l=Array.isArray(a),o={type_:l?1:0,scope_:i?i.scope_:Ng(),modified_:!1,finalized_:!1,assigned_:{},parent_:i,base_:a,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=o,c=kd;l&&(r=[o],c=fl);const{revoke:d,proxy:m}=Proxy.revocable(r,c);return o.draft_=m,o.revoke_=d,m}var kd={get(a,i){if(i===Bt)return a;const l=Pn(a);if(!cd(l,i))return rS(a,l,i);const o=l[i];return a.finalized_||!Ha(o)?o:o===Yu(a.base_,i)?(Vu(a),a.copy_[i]=md(o,a)):o},has(a,i){return i in Pn(a)},ownKeys(a){return Reflect.ownKeys(Pn(a))},set(a,i,l){const o=Eg(Pn(a),i);if(o?.set)return o.set.call(a.draft_,l),!0;if(!a.modified_){const r=Yu(Pn(a),i),c=r?.[Bt];if(c&&c.base_===l)return a.copy_[i]=l,a.assigned_[i]=!1,!0;if(aS(l,r)&&(l!==void 0||cd(a.base_,i)))return!0;Vu(a),hd(a)}return a.copy_[i]===l&&(l!==void 0||i in a.copy_)||Number.isNaN(l)&&Number.isNaN(a.copy_[i])||(a.copy_[i]=l,a.assigned_[i]=!0),!0},deleteProperty(a,i){return Yu(a.base_,i)!==void 0||i in a.base_?(a.assigned_[i]=!1,Vu(a),hd(a)):delete a.assigned_[i],a.copy_&&delete a.copy_[i],!0},getOwnPropertyDescriptor(a,i){const l=Pn(a),o=Reflect.getOwnPropertyDescriptor(l,i);return o&&{writable:!0,configurable:a.type_!==1||i!=="length",enumerable:o.enumerable,value:l[i]}},defineProperty(){ia(11)},getPrototypeOf(a){return ul(a.base_)},setPrototypeOf(){ia(12)}},fl={};sr(kd,(a,i)=>{fl[a]=function(){return arguments[0]=arguments[0][0],i.apply(this,arguments)}});fl.deleteProperty=function(a,i){return fl.set.call(this,a,i,void 0)};fl.set=function(a,i,l){return kd.set.call(this,a[0],i,l,a[0])};function Yu(a,i){const l=a[Bt];return(l?Pn(l):a)[i]}function rS(a,i,l){const o=Eg(i,l);return o?"value"in o?o.value:o.get?.call(a.draft_):void 0}function Eg(a,i){if(!(i in a))return;let l=ul(a);for(;l;){const o=Object.getOwnPropertyDescriptor(l,i);if(o)return o;l=ul(l)}}function hd(a){a.modified_||(a.modified_=!0,a.parent_&&hd(a.parent_))}function Vu(a){a.copy_||(a.copy_=ud(a.base_,a.scope_.immer_.useStrictShallowCopy_))}var cS=class{constructor(a){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(i,l,o)=>{if(typeof i=="function"&&typeof l!="function"){const c=l;l=i;const d=this;return function(p=c,...y){return d.produce(p,v=>l.call(this,v,...y))}}typeof l!="function"&&ia(6),o!==void 0&&typeof o!="function"&&ia(7);let r;if(Ha(i)){const c=o0(this),d=md(i,void 0);let m=!0;try{r=l(d),m=!1}finally{m?dd(c):fd(c)}return l0(c,o),r0(r,c)}else if(!i||typeof i!="object"){if(r=l(i),r===void 0&&(r=i),r===xg&&(r=void 0),this.autoFreeze_&&Ad(r,!0),o){const c=[],d=[];Yn("Patches").generateReplacementPatches_(i,r,c,d),o(c,d)}return r}else ia(1,i)},this.produceWithPatches=(i,l)=>{if(typeof i=="function")return(d,...m)=>this.produceWithPatches(d,p=>i(p,...m));let o,r;return[this.produce(i,l,(d,m)=>{o=d,r=m}),o,r]},typeof a?.autoFreeze=="boolean"&&this.setAutoFreeze(a.autoFreeze),typeof a?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(a.useStrictShallowCopy),typeof a?.useStrictIteration=="boolean"&&this.setUseStrictIteration(a.useStrictIteration)}createDraft(a){Ha(a)||ia(8),qn(a)&&(a=uS(a));const i=o0(this),l=md(a,void 0);return l[Bt].isManual_=!0,fd(i),l}finishDraft(a,i){const l=a&&a[Bt];(!l||!l.isManual_)&&ia(9);const{scope_:o}=l;return l0(o,i),r0(void 0,o)}setAutoFreeze(a){this.autoFreeze_=a}setUseStrictShallowCopy(a){this.useStrictShallowCopy_=a}setUseStrictIteration(a){this.useStrictIteration_=a}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(a,i){let l;for(l=i.length-1;l>=0;l--){const r=i[l];if(r.path.length===0&&r.op==="replace"){a=r.value;break}}l>-1&&(i=i.slice(l+1));const o=Yn("Patches").applyPatches_;return qn(a)?o(a,i):this.produce(a,r=>o(r,i))}};function md(a,i){const l=bl(a)?Yn("MapSet").proxyMap_(a,i):dr(a)?Yn("MapSet").proxySet_(a,i):oS(a,i);return(i?i.scope_:Ng()).drafts_.push(l),l}function uS(a){return qn(a)||ia(10,a),Mg(a)}function Mg(a){if(!Ha(a)||fr(a))return a;const i=a[Bt];let l,o=!0;if(i){if(!i.modified_)return i.base_;i.finalized_=!0,l=ud(a,i.scope_.immer_.useStrictShallowCopy_),o=i.scope_.immer_.shouldUseStrictIteration()}else l=ud(a,!0);return sr(l,(r,c)=>{_g(l,r,Mg(c))},o),i&&(i.finalized_=!1),l}var pd=new cS,jg=pd.produce,dS=pd.setUseStrictIteration.bind(pd);function fS(a,i=`expected a function, instead received ${typeof a}`){if(typeof a!="function")throw new TypeError(i)}function hS(a,i=`expected an object, instead received ${typeof a}`){if(typeof a!="object")throw new TypeError(i)}function mS(a,i="expected all items to be functions, instead received the following types: "){if(!a.every(l=>typeof l=="function")){const l=a.map(o=>typeof o=="function"?`function ${o.name||"unnamed"}()`:typeof o).join(", ");throw new TypeError(`${i}[${l}]`)}}var u0=a=>Array.isArray(a)?a:[a];function pS(a){const i=Array.isArray(a[0])?a[0]:a;return mS(i,"createSelector expects all input-selectors to be functions, but received the following types: "),i}function gS(a,i){const l=[],{length:o}=a;for(let r=0;r<o;r++)l.push(a[r].apply(null,i));return l}var yS=class{constructor(a){this.value=a}deref(){return this.value}},vS=typeof WeakRef<"u"?WeakRef:yS,bS=0,d0=1;function Io(){return{s:bS,v:void 0,o:null,p:null}}function wg(a,i={}){let l=Io();const{resultEqualityCheck:o}=i;let r,c=0;function d(){let m=l;const{length:p}=arguments;for(let g=0,b=p;g<b;g++){const S=arguments[g];if(typeof S=="function"||typeof S=="object"&&S!==null){let _=m.o;_===null&&(m.o=_=new WeakMap);const N=_.get(S);N===void 0?(m=Io(),_.set(S,m)):m=N}else{let _=m.p;_===null&&(m.p=_=new Map);const N=_.get(S);N===void 0?(m=Io(),_.set(S,m)):m=N}}const y=m;let v;if(m.s===d0)v=m.v;else if(v=a.apply(null,arguments),c++,o){const g=r?.deref?.()??r;g!=null&&o(g,v)&&(v=g,c!==0&&c--),r=typeof v=="object"&&v!==null||typeof v=="function"?new vS(v):v}return y.s=d0,y.v=v,v}return d.clearCache=()=>{l=Io(),d.resetResultsCount()},d.resultsCount=()=>c,d.resetResultsCount=()=>{c=0},d}function xS(a,...i){const l=typeof a=="function"?{memoize:a,memoizeOptions:i}:a,o=(...r)=>{let c=0,d=0,m,p={},y=r.pop();typeof y=="object"&&(p=y,y=r.pop()),fS(y,`createSelector expects an output function after the inputs, but received: [${typeof y}]`);const v={...l,...p},{memoize:g,memoizeOptions:b=[],argsMemoize:S=wg,argsMemoizeOptions:_=[]}=v,N=u0(b),M=u0(_),T=pS(r),w=g(function(){return c++,y.apply(null,arguments)},...N),z=S(function(){d++;const A=gS(T,arguments);return m=w.apply(null,A),m},...M);return Object.assign(z,{resultFunc:y,memoizedResultFunc:w,dependencies:T,dependencyRecomputations:()=>d,resetDependencyRecomputations:()=>{d=0},lastResult:()=>m,recomputations:()=>c,resetRecomputations:()=>{c=0},memoize:g,argsMemoize:S})};return Object.assign(o,{withTypes:()=>o}),o}var hr=xS(wg),SS=Object.assign((a,i=hr)=>{hS(a,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof a}`);const l=Object.keys(a),o=l.map(c=>a[c]);return i(o,(...c)=>c.reduce((d,m,p)=>(d[l[p]]=m,d),{}))},{withTypes:()=>SS});function Tg(a){return({dispatch:l,getState:o})=>r=>c=>typeof c=="function"?c(l,o,a):r(c)}var _S=Tg(),NS=Tg,ES=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?ir:ir.apply(null,arguments)};function f0(a,i){function l(...o){if(i){let r=i(...o);if(!r)throw new Error(Pa(0));return{type:a,payload:r.payload,..."meta"in r&&{meta:r.meta},..."error"in r&&{error:r.error}}}return{type:a,payload:o[0]}}return l.toString=()=>`${a}`,l.type=a,l.match=o=>eS(o)&&o.type===a,l}var Cg=class nl extends Array{constructor(...i){super(...i),Object.setPrototypeOf(this,nl.prototype)}static get[Symbol.species](){return nl}concat(...i){return super.concat.apply(this,i)}prepend(...i){return i.length===1&&Array.isArray(i[0])?new nl(...i[0].concat(this)):new nl(...i.concat(this))}};function h0(a){return Ha(a)?jg(a,()=>{}):a}function Ho(a,i,l){return a.has(i)?a.get(i):a.set(i,l(i)).get(i)}function MS(a){return typeof a=="boolean"}var jS=()=>function(i){const{thunk:l=!0,immutableCheck:o=!0,serializableCheck:r=!0,actionCreatorCheck:c=!0}=i??{};let d=new Cg;return l&&(MS(l)?d.push(_S):d.push(NS(l.extraArgument))),d},wS="RTK_autoBatch",m0=a=>i=>{setTimeout(i,a)},TS=(a={type:"raf"})=>i=>(...l)=>{const o=i(...l);let r=!0,c=!1,d=!1;const m=new Set,p=a.type==="tick"?queueMicrotask:a.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:m0(10):a.type==="callback"?a.queueNotification:m0(a.timeout),y=()=>{d=!1,c&&(c=!1,m.forEach(v=>v()))};return Object.assign({},o,{subscribe(v){const g=()=>r&&v(),b=o.subscribe(g);return m.add(v),()=>{b(),m.delete(v)}},dispatch(v){try{return r=!v?.meta?.[wS],c=!r,c&&(d||(d=!0,p(y))),o.dispatch(v)}finally{r=!0}}})},CS=a=>function(l){const{autoBatch:o=!0}=l??{};let r=new Cg(a);return o&&r.push(TS(typeof o=="object"?o:void 0)),r};function zS(a){const i=jS(),{reducer:l=void 0,middleware:o,devTools:r=!0,preloadedState:c=void 0,enhancers:d=void 0}=a||{};let m;if(typeof l=="function")m=l;else if(Rd(l))m=Wx(l);else throw new Error(Pa(1));let p;typeof o=="function"?p=o(i):p=i();let y=ir;r&&(y=ES({trace:!1,...typeof r=="object"&&r}));const v=Jx(...p),g=CS(v);let b=typeof d=="function"?d(g):g();const S=y(...b);return bg(m,c,S)}function zg(a){const i={},l=[];let o;const r={addCase(c,d){const m=typeof c=="string"?c:c.type;if(!m)throw new Error(Pa(28));if(m in i)throw new Error(Pa(29));return i[m]=d,r},addAsyncThunk(c,d){return d.pending&&(i[c.pending.type]=d.pending),d.rejected&&(i[c.rejected.type]=d.rejected),d.fulfilled&&(i[c.fulfilled.type]=d.fulfilled),d.settled&&l.push({matcher:c.settled,reducer:d.settled}),r},addMatcher(c,d){return l.push({matcher:c,reducer:d}),r},addDefaultCase(c){return o=c,r}};return a(r),[i,l,o]}dS(!1);function DS(a){return typeof a=="function"}function RS(a,i){let[l,o,r]=zg(i),c;if(DS(a))c=()=>h0(a());else{const m=h0(a);c=()=>m}function d(m=c(),p){let y=[l[p.type],...o.filter(({matcher:v})=>v(p)).map(({reducer:v})=>v)];return y.filter(v=>!!v).length===0&&(y=[r]),y.reduce((v,g)=>{if(g)if(qn(v)){const S=g(v,p);return S===void 0?v:S}else{if(Ha(v))return jg(v,b=>g(b,p));{const b=g(v,p);if(b===void 0){if(v===null)return v;throw Error("A case reducer on a non-draftable value must not return undefined")}return b}}return v},m)}return d.getInitialState=c,d}var AS=Symbol.for("rtk-slice-createasyncthunk");function kS(a,i){return`${a}/${i}`}function OS({creators:a}={}){const i=a?.asyncThunk?.[AS];return function(o){const{name:r,reducerPath:c=r}=o;if(!r)throw new Error(Pa(11));const d=(typeof o.reducers=="function"?o.reducers(BS()):o.reducers)||{},m=Object.keys(d),p={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},y={addCase(z,D){const A=typeof z=="string"?z:z.type;if(!A)throw new Error(Pa(12));if(A in p.sliceCaseReducersByType)throw new Error(Pa(13));return p.sliceCaseReducersByType[A]=D,y},addMatcher(z,D){return p.sliceMatchers.push({matcher:z,reducer:D}),y},exposeAction(z,D){return p.actionCreators[z]=D,y},exposeCaseReducer(z,D){return p.sliceCaseReducersByName[z]=D,y}};m.forEach(z=>{const D=d[z],A={reducerName:z,type:kS(r,z),createNotation:typeof o.reducers=="function"};IS(D)?GS(A,D,y,i):PS(A,D,y)});function v(){const[z={},D=[],A=void 0]=typeof o.extraReducers=="function"?zg(o.extraReducers):[o.extraReducers],q={...z,...p.sliceCaseReducersByType};return RS(o.initialState,I=>{for(let G in q)I.addCase(G,q[G]);for(let G of p.sliceMatchers)I.addMatcher(G.matcher,G.reducer);for(let G of D)I.addMatcher(G.matcher,G.reducer);A&&I.addDefaultCase(A)})}const g=z=>z,b=new Map,S=new WeakMap;let _;function N(z,D){return _||(_=v()),_(z,D)}function M(){return _||(_=v()),_.getInitialState()}function T(z,D=!1){function A(I){let G=I[z];return typeof G>"u"&&D&&(G=Ho(S,A,M)),G}function q(I=g){const G=Ho(b,D,()=>new WeakMap);return Ho(G,I,()=>{const F={};for(const[Z,J]of Object.entries(o.selectors??{}))F[Z]=US(J,I,()=>Ho(S,I,M),D);return F})}return{reducerPath:z,getSelectors:q,get selectors(){return q(A)},selectSlice:A}}const w={name:r,reducer:N,actions:p.actionCreators,caseReducers:p.sliceCaseReducersByName,getInitialState:M,...T(c),injectInto(z,{reducerPath:D,...A}={}){const q=D??c;return z.inject({reducerPath:q,reducer:N},A),{...w,...T(q,!0)}}};return w}}function US(a,i,l,o){function r(c,...d){let m=i(c);return typeof m>"u"&&o&&(m=l()),a(m,...d)}return r.unwrapped=a,r}var LS=OS();function BS(){function a(i,l){return{_reducerDefinitionType:"asyncThunk",payloadCreator:i,...l}}return a.withTypes=()=>a,{reducer(i){return Object.assign({[i.name](...l){return i(...l)}}[i.name],{_reducerDefinitionType:"reducer"})},preparedReducer(i,l){return{_reducerDefinitionType:"reducerWithPrepare",prepare:i,reducer:l}},asyncThunk:a}}function PS({type:a,reducerName:i,createNotation:l},o,r){let c,d;if("reducer"in o){if(l&&!HS(o))throw new Error(Pa(17));c=o.reducer,d=o.prepare}else c=o;r.addCase(a,c).exposeCaseReducer(i,c).exposeAction(i,d?f0(a,d):f0(a))}function IS(a){return a._reducerDefinitionType==="asyncThunk"}function HS(a){return a._reducerDefinitionType==="reducerWithPrepare"}function GS({type:a,reducerName:i},l,o,r){if(!r)throw new Error(Pa(18));const{payloadCreator:c,fulfilled:d,pending:m,rejected:p,settled:y,options:v}=l,g=r(a,c,v);o.exposeAction(i,g),d&&o.addCase(g.fulfilled,d),m&&o.addCase(g.pending,m),p&&o.addCase(g.rejected,p),y&&o.addMatcher(g.settled,y),o.exposeCaseReducer(i,{fulfilled:d||Go,pending:m||Go,rejected:p||Go,settled:y||Go})}function Go(){}function Pa(a){return`Minified Redux Toolkit error #${a}; visit https://redux-toolkit.js.org/Errors?code=${a} for the full message or use the non-minified dev environment for full errors. `}const qS={narrativeIntervalTicks:12,anomalyIntervalTicks:14,crisisIntervalTicks:36,narrative:[{id:"support-request",kind:"narrative",title:"Richiesta di supporto",description:"Una colonia chiede fondi per infrastrutture.",options:[{id:"fund",label:"Finanzia (Minerali -20)",description:"Migliora la stabilita locale.",effects:[{kind:"resource",target:"minerals",amount:-20},{kind:"stability",amount:4}]},{id:"decline",label:"Rifiuta",description:"Risparmi ma scontenti i coloni.",effects:[{kind:"stability",amount:-3}]}]},{id:"science-breakthrough",kind:"narrative",title:"Scoperta scientifica",description:"Un team ottiene risultati imprevisti.",options:[{id:"publish",label:"Pubblica",description:"+12 Ricerca, +1 Influenza.",effects:[{kind:"resource",target:"research",amount:12},{kind:"influence",amount:1}]},{id:"brevettare",label:"Brevettare",description:"+15 Energia.",effects:[{kind:"resource",target:"energy",amount:15}]}]}],anomalies:[{id:"ancient-signal",kind:"anomaly",title:"Segnale antico",description:"Un segnale debole proviene da un relitto orbitale.",options:[{id:"indaga",label:"Indaga",description:"+8 Ricerca, possibile minaccia.",effects:[{kind:"resource",target:"research",amount:8},{kind:"hostileSpawn",amount:6}]},{id:"ignora",label:"Ignora",description:"Nessun rischio, nessun guadagno.",effects:[]}]},{id:"energy-crystals",kind:"anomaly",title:"Cristalli energetici",description:"Formazioni cristalline rilasciano energia.",options:[{id:"estrai",label:"Estrarre",description:"+20 Energia, rischio instabilita.",effects:[{kind:"resource",target:"energy",amount:20},{kind:"stability",amount:-2}]},{id:"studia",label:"Studiare",description:"+12 Ricerca.",effects:[{kind:"resource",target:"research",amount:12}]}]}],crisis:[{id:"external-raid",kind:"crisis",title:"Incursione esterna",description:"Forze sconosciute attraversano i confini.",options:[{id:"allerta",label:"Allerta flotte",description:"Nemici appaiono in un sistema chiave.",effects:[{kind:"hostileSpawn",amount:15}]},{id:"negozia",label:"Tentare negoziati",description:"Piccolo costo di influenza, minaccia ridotta.",effects:[{kind:"influence",amount:-3},{kind:"hostileSpawn",amount:8}]}]}]},YS={eras:[{id:1,label:"Era 1 - Esodo",description:"Prime tecnologie di sopravvivenza e uscita dal sistema.",gatewayTechs:["photonics","bio-domes"]},{id:2,label:"Era 2 - Espansione locale",description:"Espansione stellare, amministrazione e primi cantieri avanzati.",gatewayTechs:["advanced-sensors","reinforced-alloys"]},{id:3,label:"Era 3 - Potere stellare",description:"Logistica interstellare e governance avanzata.",gatewayTechs:["bureaucracy","modular-yards"]},{id:4,label:"Era 4 - Dominio galattico",description:"Propulsione quantica e amministrazione centrale.",gatewayTechs:["deep-space-navigation","stellar-logistics"]}],branches:[{id:"physics",label:"Fisica",description:"Energia, sensori e propulsione."},{id:"society",label:"Societa",description:"Biologia, amministrazione, tradizioni civili."},{id:"engineering",label:"Ingegneria",description:"Materiali, costruzioni e armamenti."}],techs:[{id:"photonics",branch:"physics",name:"Energia fotonica",description:"+10% produzione energia.",cost:40,effects:["energyIncome:+0.1"],era:1,clusterId:"energy-1",kind:"foundation",origin:"standard"},{id:"advanced-sensors",branch:"physics",name:"Sensori avanzati",description:"+10% produzione ricerca.",cost:30,effects:["researchIncome:+0.1"],era:1,clusterId:"sensors-1",kind:"feature",origin:"standard"},{id:"bio-domes",branch:"society",name:"Bio-cupole",description:"+10% produzione cibo.",cost:35,effects:["foodIncome:+0.1"],era:1,clusterId:"bio-1",kind:"foundation",origin:"standard"},{id:"colony-foundations",branch:"society",name:"Fondamenta colonizzazione",description:"Sblocca la costruzione di navi colonia.",cost:35,effects:[],era:1,clusterId:"colony-1",kind:"feature",origin:"standard"},{id:"science-outfitting",branch:"physics",name:"Allestimento scientifico",description:"Sblocca la costruzione di navi scientifiche.",cost:35,effects:[],era:1,clusterId:"science-1",kind:"feature",origin:"standard"},{id:"orbital-shipyard",branch:"engineering",name:"Cantiere orbitale",description:"Permette di costruire cantieri spaziali con le navi costruttrici.",cost:40,effects:[],era:1,clusterId:"yards-1",kind:"feature",origin:"standard"},{id:"reinforced-alloys",branch:"engineering",name:"Leghe rinforzate",description:"+10% produzione minerali.",cost:45,effects:["mineralsIncome:+0.1"],era:1,clusterId:"materials-1",kind:"foundation",origin:"standard"},{id:"bureaucracy",branch:"society",name:"Burosfera",description:"+1 influenza per tick.",cost:45,effects:["influenceFlat:+1"],era:2,clusterId:"admin-1",kind:"feature",origin:"standard"},{id:"modular-yards",branch:"engineering",name:"Cantieri modulari",description:"+10% produzione energia e minerali.",cost:55,effects:["energyIncome:+0.1","mineralsIncome:+0.1"],prerequisites:["reinforced-alloys"],era:2,clusterId:"yards-1",kind:"feature",origin:"standard"},{id:"deep-space-navigation",branch:"physics",name:"Navigazione spazio profondo",description:"+10% produzione ricerca.",cost:65,effects:["researchIncome:+0.1"],era:3,clusterId:"nav-3",kind:"feature",origin:"standard"},{id:"stellar-logistics",branch:"engineering",name:"Logistica stellare",description:"+10% produzione minerali.",cost:65,effects:["mineralsIncome:+0.1"],era:3,clusterId:"logistics-3",kind:"feature",origin:"standard"},{id:"quantum-drives",branch:"physics",name:"Propulsione quantica",description:"+12% produzione energia.",cost:90,effects:["energyIncome:+0.12"],era:4,clusterId:"drive-4",kind:"feature",origin:"standard"},{id:"core-administration",branch:"society",name:"Amministrazione centrale",description:"+1.5 influenza per tick.",cost:90,effects:["influenceFlat:+1.5"],era:4,clusterId:"core-admin-4",kind:"feature",origin:"standard"}],pointsPerResearchIncome:1},VS={trees:[{id:"exploration",label:"Esplorazione",description:"Scoperta rapida della galassia."},{id:"economy",label:"Economia",description:"Crescita risorse e stabilita."},{id:"military",label:"Militare",description:"Potenza e mobilit delle flotte."}],perks:[{id:"survey-speed",tree:"exploration",name:"Scansioni fulminee",description:"+5% produzione ricerca.",cost:2,effects:["researchIncome:+0.05"],era:1,clusterId:"explore-1",origin:"standard"},{id:"logistics",tree:"military",name:"Logistica avanzata",description:"+5% produzione energia.",cost:3,effects:["energyIncome:+0.05"],era:1,clusterId:"military-1",origin:"standard"},{id:"bureaucrats",tree:"economy",name:"Quadri amministrativi",description:"+0.5 influenza/tick.",cost:2,effects:["influenceFlat:+0.5"],era:1,clusterId:"economy-1",origin:"standard"},{id:"planetary-planning",tree:"economy",name:"Pianificazione planetaria",description:"+5% produzione minerali.",cost:3,effects:["mineralsIncome:+0.05"],prerequisites:["bureaucrats"],era:1,clusterId:"economy-1",origin:"standard"}],pointsPerInfluenceIncome:.05},XS={startingResources:{energy:100,minerals:80,food:60,research:0,influence:50},homeworld:{name:"Aurora Prime",kind:"terrestrial",size:18,habitability:1,population:4,baseProduction:{energy:6,minerals:5,food:7,research:3,influence:1},upkeep:{food:4},districts:{generator:2,mining:2,farm:1,research:1}},districts:[{id:"generator",label:"Distretto energetico",description:"Produce energia sfruttando la rete planetaria.",cost:{minerals:70,energy:10},buildTime:5,production:{energy:5},upkeep:{food:1}},{id:"mining",label:"Distretto minerario",description:"Estrae minerali dalle superfici del pianeta.",cost:{minerals:65},buildTime:5,production:{minerals:5},upkeep:{energy:1}},{id:"farm",label:"Distretto agricolo",description:"Aumenta la produzione di cibo locale.",cost:{minerals:55},buildTime:4,production:{food:6},upkeep:{energy:1}},{id:"research",label:"Distretto di ricerca",description:"Laboratori e campus scientifici.",cost:{minerals:90,energy:30},buildTime:6,production:{research:5},upkeep:{energy:2}}],populationJobs:[{id:"workers",label:"Lavoratori",description:"Pop dedicati a miniere, fattorie e infrastrutture.",production:{minerals:1.5,food:1.5},upkeep:{food:.5}},{id:"specialists",label:"Specialisti",description:"Tecnici e amministratori per distretti avanzati.",production:{energy:2},upkeep:{food:.5,energy:.2}},{id:"researchers",label:"Ricercatori",description:"Scienziati che aumentano la produzione di ricerca.",production:{research:2.5},upkeep:{food:.5,energy:.5}}],populationAutomation:{enabled:!0,priorities:["food","energy","minerals","research"],deficitThreshold:.5,surplusThreshold:3},morale:{baseStability:65,min:20,max:95,overcrowdingThreshold:2,overcrowdingPenalty:2,deficitThreshold:25,deficitPenalty:6,happinessBonusPerSpecialist:.6,happinessPenaltyPerWorker:.2},habitabilityByKind:{terrestrial:.9,desert:.6,tundra:.65}},QS={shipyard:{queueSize:4,homeSystemDesignId:"corvette",buildCost:{minerals:150,energy:80}},fleet:{baseTravelTicks:3},colonyShipDesignId:"colony",constructionShipDesignId:"constructor",startingShips:{science:0,construction:1,colony:0,military:[]},shipDesigns:[{id:"corvette",name:"Classe Aurora",role:"military",description:"Corvetta versatile per pattugliamenti rapidi e schermaglia.",buildCost:{minerals:120,energy:40},buildTime:5,attack:6,defense:2,hullPoints:20,speed:1},{id:"frigate",name:"Classe Asteria",role:"military",description:"Fregata di linea, buon bilanciamento tra attacco e difesa.",buildCost:{minerals:170,energy:70},buildTime:7,attack:10,defense:4,hullPoints:28,speed:.9},{id:"colony",name:"Classe Horizon",role:"colony",description:"Nave colonia con moduli di supporto e stiva ampliata.",buildCost:{minerals:150,energy:60,food:20},buildTime:6,attack:0,defense:1,hullPoints:15,speed:.8},{id:"constructor",name:"Classe Atlas",role:"construction",description:"Nave costruttrice per avamposti e infrastrutture orbitali.",buildCost:{minerals:110,energy:55},buildTime:6,attack:0,defense:2,hullPoints:18,speed:.85},{id:"science",name:"ISS Pathfinder",role:"science",description:"Nave scientifica per esplorazione e analisi dei sistemi.",buildCost:{minerals:90,energy:55},buildTime:6,attack:0,defense:1,hullPoints:14,speed:1.1}],templates:[{id:"assault",base:"corvette",name:"Variante d Assalto",attack:3,defense:0,hull:2,costMultiplier:1.15},{id:"guardian",base:"corvette",name:"Variante Guardia",attack:0,defense:3,hull:3,costMultiplier:1.2}]},ZS={cost:{energy:50,minerals:80,food:30},preparationTicks:2,travelTicks:3,durationTicks:6},FS={aiStartingOpinion:{min:-10,max:30},warThreshold:-60,peaceThreshold:-5,autoCheckInterval:12,opinionDriftPerCheck:-1.5,warZones:{count:2,powerMin:8,powerMax:18},aiFleetStrength:{baseShips:1,extraPerHostile:1,maxShips:6,attackBonusPerThreat:10},warEventLogLimit:15},KS={orbitSpeed:.0025},$S={O:{coreColor:"#b9d8ff",glowColor:"#7ecbff",coreRadius:6.5,glowScale:22,plasmaSpeed:1.4,jetIntensity:.32,streakOpacity:.2},B:{coreColor:"#9fc4ff",glowColor:"#7ac8ff",coreRadius:5.8,glowScale:19.5,plasmaSpeed:1.2,jetIntensity:.25,streakOpacity:.18},A:{coreColor:"#c7d6ff",glowColor:"#9cc5ff",coreRadius:5,glowScale:17.5,plasmaSpeed:1.1,jetIntensity:.22,streakOpacity:.16},F:{coreColor:"#f7f2d0",glowColor:"#ffd27a",coreRadius:4.6,glowScale:16.2,plasmaSpeed:1.05,jetIntensity:.2,streakOpacity:.15},G:{coreColor:"#ffd27a",glowColor:"#ffbe55",coreRadius:4.2,glowScale:14.5,plasmaSpeed:1,jetIntensity:.18,streakOpacity:.14},K:{coreColor:"#ffb36b",glowColor:"#ff9b5f",coreRadius:3.6,glowScale:12.5,plasmaSpeed:.95,jetIntensity:.16,streakOpacity:.12},M:{coreColor:"#ff8a5c",glowColor:"#ff6b5f",coreRadius:3.2,glowScale:10.8,plasmaSpeed:.9,jetIntensity:.14,streakOpacity:.1}},WS=[{id:"O",weight:1},{id:"B",weight:2},{id:"A",weight:4},{id:"F",weight:8},{id:"G",weight:10},{id:"K",weight:12},{id:"M",weight:16}],Dg={ticksPerSecond:1,defaultGalaxy:{seed:"debug-seed",systemCount:18,galaxyRadius:260,galaxyShape:"circle"},galaxyPresets:[{id:"test",label:"Test (piccola)",seed:"debug-seed",systemCount:8,galaxyRadius:140,galaxyShape:"circle"},{id:"standard",label:"Standard",seed:"debug-seed",systemCount:18,galaxyRadius:260,galaxyShape:"circle"},{id:"large",label:"Grande",seed:"debug-seed",systemCount:28,galaxyRadius:320,galaxyShape:"circle"},{id:"mega",label:"Colossale (1200)",seed:"debug-seed",systemCount:1200,galaxyRadius:1400,galaxyShape:"spiral"}],debug:{autoStart:!1},exploration:{travelTicks:3,surveyTicks:2},economy:XS,research:YS,traditions:VS,events:qS,colonization:ZS,diplomacy:FS,military:QS,map:KS,starVisuals:$S,starClasses:WS},JS={view:"mainMenu",config:Dg,session:null},Rg=LS({name:"game",initialState:JS,reducers:{startSessionSuccess(a,i){a.session=i.payload,a.view="simulation"},returnToMenu(a){a.session=null,a.view="mainMenu"},setSessionState(a,i){a.session=i.payload}}}),e_=Rg.reducer,{startSessionSuccess:Ag,returnToMenu:t_,setSessionState:Re}=Rg.actions,a_=zS({reducer:{game:e_},devTools:!1}),kg=a=>a.game.session?.empires??[],Og=a=>a.game.session?.research,n_=a=>a.game.session?.traditions,i_=a=>a.game.session?.events,s_=a=>a.game.session?.combatReports??[],Ug=a=>a.game.session?.clock.tick??0,Xw=a=>a.game.session?.shipyardQueue??[],Od=a=>a.game.session?.economy.resources,mr=a=>a.game.session?.economy.planets??[],Ud=hr([mr],a=>new Set(a.map(i=>i.systemId))),l_=hr([Od],a=>{if(!a)return null;const i={energy:0,minerals:0,food:0,research:0,influence:0};return Object.keys(i).forEach(l=>{const o=a[l];o&&(i[l]=o.income-o.upkeep)}),i}),Lg=a=>a.game.session?.colonizationTasks??[],o_=a=>a.game.session?.warEvents??[],Ki=a=>a.game.session?.galaxy.systems??[],Bg=a=>a.game.session?.scienceShips??[];hr([Ki],a=>new Map(a.map(i=>[i.id,i])));var Xu,p0;function Pg(){if(p0)return Xu;p0=1;function a(l){var o=l.length,r=1,c=new Array(o),d;for(d=o;d>0;d--)c[d-1]=r,r=r*l[d-1];return{stride:c,data:new Uint32Array(r)}}function i(l){var o=l.length,r=1,c=new Array(o),d=[],m,p;for(m=o;m>0;m--)c[m-1]=r,r=r*l[m-1];for(p=0;p<r;p++)d.push([]);return{stride:c,data:d}}return Xu={integer:a,array:i},Xu}var Qu,g0;function Ig(){if(g0)return Qu;g0=1,Qu=a;function a(i,l){var o=new Array(i),r=Math.floor(i/2)<<1,c=0,d,m,p,y,v;for(v=0;v<r;v+=2)d=-2*Math.log(l()),m=Math.sqrt(d),p=2*Math.PI*l(),c+=d,o[v]=m*Math.cos(p),o[v+1]=m*Math.sin(p);if(i%2){var g=Math.sqrt(-2*Math.log(l()))*Math.cos(2*Math.PI*l());o[i-1]=g,c+=Math.pow(g,2)}for(y=1/Math.sqrt(c),v=0;v<i;++v)o[v]*=y;return o}return Qu}var Zu,y0;function r_(){return y0||(y0=1,Zu=function(i,l){i=i||1,l=l||2;for(var o=i*2+1,r=Math.pow(o,l)-1,c=new Array(r),d=0;d<r;d++)for(var m=c[d]=new Array(l),p=d<r/2?d:d+1,y=1;y<=l;y++){var v=p%Math.pow(o,y);m[y-1]=v/Math.pow(o,y-1)-i,p-=v}return c}),Zu}var Fu,v0;function Hg(){if(v0)return Fu;v0=1;var a=r_();function i(r){var c=a(2,r),d=[],m;for(c=c.filter(function(p){for(var y=0,v=0;v<r;v++)y+=Math.pow(Math.max(0,Math.abs(p[v])-1),2);return y<r}),m=0;m<r;m++)d.push(0);return c.push(d),c.sort(function(p,y){var v=0,g=0,b;for(b=0;b<r;b++)v+=Math.pow(p[b],2),g+=Math.pow(y[b],2);return v<g?-1:v>g?1:0}),c}var l={};function o(r){return l[r]||(l[r]=i(r)),l[r]}return Fu=o,Fu}var Ku,b0;function c_(){if(b0)return Ku;b0=1;var a=Pg().integer,i=Ig(),l=Hg();function o(c,d){for(var m=0,p=0;p<c.length;p++)m+=Math.pow(c[p]-d[p],2);return m}function r(c,d){if(typeof c.distanceFunction=="function")throw new Error("PoissonDiskSampling: Tried to instantiate the fixed density implementation with a distanceFunction");this.shape=c.shape,this.minDistance=c.minDistance,this.maxDistance=c.maxDistance||c.minDistance*2,this.maxTries=Math.ceil(Math.max(1,c.tries||30)),this.rng=d||Math.random;for(var m=0,p=0;p<this.shape.length;p++)m=Math.max(m,this.shape[p]);var y=Math.max(1,m/128|0),v=1e-14*y;this.dimension=this.shape.length,this.squaredMinDistance=this.minDistance*this.minDistance,this.minDistancePlusEpsilon=this.minDistance+v,this.deltaDistance=Math.max(0,this.maxDistance-this.minDistancePlusEpsilon),this.cellSize=this.minDistance/Math.sqrt(this.dimension),this.neighbourhood=l(this.dimension),this.currentPoint=null,this.processList=[],this.samplePoints=[],this.gridShape=[];for(var p=0;p<this.dimension;p++)this.gridShape.push(Math.ceil(this.shape[p]/this.cellSize));this.grid=a(this.gridShape)}return r.prototype.shape=null,r.prototype.dimension=null,r.prototype.minDistance=null,r.prototype.maxDistance=null,r.prototype.minDistancePlusEpsilon=null,r.prototype.squaredMinDistance=null,r.prototype.deltaDistance=null,r.prototype.cellSize=null,r.prototype.maxTries=null,r.prototype.rng=null,r.prototype.neighbourhood=null,r.prototype.currentPoint=null,r.prototype.processList=null,r.prototype.samplePoints=null,r.prototype.gridShape=null,r.prototype.grid=null,r.prototype.addRandomPoint=function(){for(var c=new Array(this.dimension),d=0;d<this.dimension;d++)c[d]=this.rng()*this.shape[d];return this.directAddPoint(c)},r.prototype.addPoint=function(c){var d,m=!0;if(c.length===this.dimension)for(d=0;d<this.dimension&&m;d++)m=c[d]>=0&&c[d]<this.shape[d];else m=!1;return m?this.directAddPoint(c):null},r.prototype.directAddPoint=function(c){var d=0,m=this.grid.stride,p;for(this.processList.push(c),this.samplePoints.push(c),p=0;p<this.dimension;p++)d+=(c[p]/this.cellSize|0)*m[p];return this.grid.data[d]=this.samplePoints.length,c},r.prototype.inNeighbourhood=function(c){var d=this.dimension,m=this.grid.stride,p,y,v,g,b;for(p=0;p<this.neighbourhood.length;p++){for(y=0,v=0;v<d;v++){if(g=(c[v]/this.cellSize|0)+this.neighbourhood[p][v],g<0||g>=this.gridShape[v]){y=-1;break}y+=g*m[v]}if(y!==-1&&this.grid.data[y]!==0&&(b=this.samplePoints[this.grid.data[y]-1],o(c,b)<this.squaredMinDistance))return!0}return!1},r.prototype.next=function(){for(var c,d,m,p,y,v,g;this.processList.length>0;){for(this.currentPoint===null&&(this.currentPoint=this.processList.shift()),p=this.currentPoint,c=0;c<this.maxTries;c++){for(v=!0,m=this.minDistancePlusEpsilon+this.deltaDistance*this.rng(),this.dimension===2?(d=this.rng()*Math.PI*2,y=[Math.cos(d),Math.sin(d)]):y=i(this.dimension,this.rng),g=0;v&&g<this.dimension;g++)y[g]=p[g]+y[g]*m,v=y[g]>=0&&y[g]<this.shape[g];if(v&&!this.inNeighbourhood(y))return this.directAddPoint(y)}c===this.maxTries&&(this.currentPoint=null)}return null},r.prototype.fill=function(){for(this.samplePoints.length===0&&this.addRandomPoint();this.next(););return this.samplePoints},r.prototype.getAllPoints=function(){return this.samplePoints},r.prototype.getAllPointsWithDistance=function(){throw new Error("PoissonDiskSampling: getAllPointsWithDistance() is not available in fixed-density implementation")},r.prototype.reset=function(){var c=this.grid.data,d=0;for(d=0;d<c.length;d++)c[d]=0;this.samplePoints=[],this.currentPoint=null,this.processList.length=0},Ku=r,Ku}var $u,x0;function u_(){if(x0)return $u;x0=1;var a=Pg().array,i=Ig(),l=Hg();function o(c,d){for(var m=0,p=0;p<c.length;p++)m+=Math.pow(c[p]-d[p],2);return Math.sqrt(m)}function r(c,d){if(typeof c.distanceFunction!="function")throw new Error("PoissonDiskSampling: Tried to instantiate the variable density implementation without a distanceFunction");this.shape=c.shape,this.minDistance=c.minDistance,this.maxDistance=c.maxDistance||c.minDistance*2,this.maxTries=Math.ceil(Math.max(1,c.tries||30)),this.distanceFunction=c.distanceFunction,this.bias=Math.max(0,Math.min(1,c.bias||0)),this.rng=d||Math.random;for(var m=0,p=0;p<this.shape.length;p++)m=Math.max(m,this.shape[p]);var y=Math.max(1,m/128|0),v=1e-14*y;this.dimension=this.shape.length,this.minDistancePlusEpsilon=this.minDistance+v,this.deltaDistance=Math.max(0,this.maxDistance-this.minDistancePlusEpsilon),this.cellSize=this.maxDistance/Math.sqrt(this.dimension),this.neighbourhood=l(this.dimension),this.currentPoint=null,this.currentDistance=0,this.processList=[],this.samplePoints=[],this.sampleDistance=[],this.gridShape=[];for(var p=0;p<this.dimension;p++)this.gridShape.push(Math.ceil(this.shape[p]/this.cellSize));this.grid=a(this.gridShape)}return r.prototype.shape=null,r.prototype.dimension=null,r.prototype.minDistance=null,r.prototype.maxDistance=null,r.prototype.minDistancePlusEpsilon=null,r.prototype.deltaDistance=null,r.prototype.cellSize=null,r.prototype.maxTries=null,r.prototype.distanceFunction=null,r.prototype.bias=null,r.prototype.rng=null,r.prototype.neighbourhood=null,r.prototype.currentPoint=null,r.prototype.currentDistance=null,r.prototype.processList=null,r.prototype.samplePoints=null,r.prototype.sampleDistance=null,r.prototype.gridShape=null,r.prototype.grid=null,r.prototype.addRandomPoint=function(){for(var c=new Array(this.dimension),d=0;d<this.dimension;d++)c[d]=this.rng()*this.shape[d];return this.directAddPoint(c)},r.prototype.addPoint=function(c){var d,m=!0;if(c.length===this.dimension)for(d=0;d<this.dimension&&m;d++)m=c[d]>=0&&c[d]<this.shape[d];else m=!1;return m?this.directAddPoint(c):null},r.prototype.directAddPoint=function(c){var d=0,m=this.grid.stride,p=this.samplePoints.length,y;for(this.processList.push(p),this.samplePoints.push(c),this.sampleDistance.push(this.distanceFunction(c)),y=0;y<this.dimension;y++)d+=(c[y]/this.cellSize|0)*m[y];return this.grid.data[d].push(p),c},r.prototype.inNeighbourhood=function(c){var d=this.dimension,m=this.grid.stride,p,y,v,g,b,S,_=this.distanceFunction(c);for(p=0;p<this.neighbourhood.length;p++){for(y=0,v=0;v<d;v++){if(g=(c[v]/this.cellSize|0)+this.neighbourhood[p][v],g<0||g>=this.gridShape[v]){y=-1;break}y+=g*m[v]}if(y!==-1&&this.grid.data[y].length>0)for(var N=0;N<this.grid.data[y].length;N++){b=this.samplePoints[this.grid.data[y][N]],S=this.sampleDistance[this.grid.data[y][N]];var M=Math.min(S,_),T=Math.max(S,_),w=M+(T-M)*this.bias;if(o(c,b)<this.minDistance+this.deltaDistance*w)return!0}}return!1},r.prototype.next=function(){for(var c,d,m,p,y,v,g,b;this.processList.length>0;){if(this.currentPoint===null){var S=this.processList.shift();this.currentPoint=this.samplePoints[S],this.currentDistance=this.sampleDistance[S]}for(p=this.currentPoint,y=this.currentDistance,c=0;c<this.maxTries;c++){for(g=!0,m=this.minDistancePlusEpsilon+this.deltaDistance*(y+(1-y)*this.bias),this.dimension===2?(d=this.rng()*Math.PI*2,v=[Math.cos(d),Math.sin(d)]):v=i(this.dimension,this.rng),b=0;g&&b<this.dimension;b++)v[b]=p[b]+v[b]*m,g=v[b]>=0&&v[b]<this.shape[b];if(g&&!this.inNeighbourhood(v))return this.directAddPoint(v)}c===this.maxTries&&(this.currentPoint=null)}return null},r.prototype.fill=function(){for(this.samplePoints.length===0&&this.addRandomPoint();this.next(););return this.samplePoints},r.prototype.getAllPoints=function(){return this.samplePoints},r.prototype.getAllPointsWithDistance=function(){var c=new Array(this.samplePoints.length),d=0,m=0,p;for(d=0;d<this.samplePoints.length;d++){for(p=new Array(this.dimension+1),m=0;m<this.dimension;m++)p[m]=this.samplePoints[d][m];p[this.dimension]=this.sampleDistance[d],c[d]=p}return c},r.prototype.reset=function(){var c=this.grid.data,d=0;for(d=0;d<c.length;d++)c[d]=[];this.samplePoints=[],this.currentPoint=null,this.processList.length=0},$u=r,$u}var Wu,S0;function d_(){if(S0)return Wu;S0=1;var a=c_(),i=u_();function l(o,r){this.shape=o.shape,typeof o.distanceFunction=="function"?this.implementation=new i(o,r):this.implementation=new a(o,r)}return l.prototype.implementation=null,l.prototype.addRandomPoint=function(){return this.implementation.addRandomPoint()},l.prototype.addPoint=function(o){return this.implementation.addPoint(o)},l.prototype.next=function(){return this.implementation.next()},l.prototype.fill=function(){return this.implementation.fill()},l.prototype.getAllPoints=function(){return this.implementation.getAllPoints()},l.prototype.getAllPointsWithDistance=function(){return this.implementation.getAllPointsWithDistance()},l.prototype.reset=function(){this.implementation.reset()},Wu=l,Wu}var f_=d_();const h_=_1(f_),_0=["terrestrial","desert","tundra"],m_={terrestrial:{yields:{food:4,energy:2,minerals:2},upkeep:{food:2}},desert:{yields:{minerals:4,energy:3},upkeep:{food:3}},tundra:{yields:{minerals:3,research:2},upkeep:{food:4}}},p_={terrestrial:.9,desert:.6,tundra:.65},g_=a=>a.split("").reduce((i,l)=>i+l.charCodeAt(0),0),y_=a=>{let i=g_(a)+1831565813;return()=>{i+=1831565813;let l=Math.imul(i^i>>>15,1|i);return l^=l+Math.imul(l^l>>>7,61|l),((l^l>>>14)>>>0)/4294967296}},v_=(a,i,l,o)=>{const r=Math.max(.05,Math.min(.18,1/Math.sqrt(i+1))),m=new h_({shape:[2,2],minDistance:r,maxDistance:r*1.6,tries:30},a).fill().map(([p,y])=>[p-1,y-1]).filter(([p,y])=>p*p+y*y<=1.05);for(;m.length<i;){const p=m.length,y=Math.PI*(3-Math.sqrt(5)),v=Math.pow((p+1)/(i+1),.6),g=p*y;m.push([Math.cos(g)*v,Math.sin(g)*v])}return m.slice(0,i).map(([p,y],v)=>{const g=Math.max(.02,Math.sqrt(p*p+y*y)),b=Math.atan2(y,p),S=2;if(l==="spiral"){const N=v%S/S*Math.PI*2,M=g*Math.PI*3;return{radius:g*o,angle:b+M+N}}return{radius:g*o,angle:b}})},b_=(a,i)=>{if(a()>.45)return;const l=_0[Math.floor(a()*_0.length)]??"terrestrial",o=m_[l],r=12+Math.round(a()*8),c=p_[l]??.7;return{name:`${i} Prime`,kind:l,size:r,baseProduction:{...o.yields},upkeep:{...o.upkeep},habitability:c}},N0=["#72fcd5","#f9d976","#f58ef6","#8ec5ff","#c7ddff"],x_=(a,i)=>{const l=2+Math.floor(a()*3);return Array.from({length:l},(o,r)=>({id:`${i}-ORB-${r}`,name:`${i}-${String.fromCharCode(65+r)}`,orbitRadius:8+r*5+a()*3,size:.6+a()*.8,color:N0[Math.floor(a()*N0.length)],orbitSpeed:.7+a()*.9}))},S_=(a,i,l)=>({x:a,y:i,z:(l()-.5)*40}),__=(a,i,l,o)=>{const r=l[i]??{radius:0,angle:0},c=r.radius,d=r.angle,m=`SYS-${(i+1).toString().padStart(3,"0")}`,p=i===0?"surveyed":"unknown";return{id:`${m}-${Math.round(a()*1e4)}`,name:m,starClass:o,position:{x:Math.cos(d)*c,y:Math.sin(d)*c},mapPosition:S_(Math.cos(d)*c,Math.sin(d)*c,a),visibility:p,habitableWorld:b_(a,m),orbitingPlanets:x_(a,m),hostilePower:i===0||a()>.35?0:Math.round(6+a()*10)}},N_=({seed:a,systemCount:i=12,galaxyRadius:l=200,galaxyShape:o="circle",starClasses:r})=>{const c=y_(a),d=r&&r.length>0?r:[{id:"G",weight:6},{id:"K",weight:5},{id:"M",weight:7},{id:"F",weight:3},{id:"A",weight:2},{id:"B",weight:1},{id:"O",weight:1}],m=d.reduce((g,b)=>g+(b.weight??1),0),p=()=>{const g=c()*m;let b=0;for(const S of d)if(b+=S.weight??1,g<=b)return S.id;return d[d.length-1]?.id??"G"},y=v_(c,i,o,l),v=Array.from({length:i},(g,b)=>__(c,b,y,p()));return{seed:a,galaxyShape:o,systems:v}},E0={unknown:0,revealed:1,surveyed:2},gd=(a,i,l)=>{let o=!1;const r=a.systems.map(c=>c.id!==i||E0[l]<=E0[c.visibility]?c:(o=!0,{...c,visibility:l}));return o?{...a,systems:r}:a},E_=(a,i,l)=>{const o=i.systems.find(d=>d.visibility==="unknown");if(!o)return{ship:a,galaxy:i};const r={...a,status:"traveling",targetSystemId:o.id,ticksRemaining:Math.max(1,l.travelTicks)},c=gd(i,o.id,"revealed");return{ship:r,galaxy:c}},M_=(a,i,l)=>{let o=a,r=i;if(o.status==="traveling"){const c=Math.max(0,o.ticksRemaining-1);o={...o,ticksRemaining:c},c===0&&o.targetSystemId&&(o={...o,status:"surveying",currentSystemId:o.targetSystemId,targetSystemId:null,ticksRemaining:Math.max(1,l.surveyTicks),localOffset:void 0},r=gd(r,o.currentSystemId,"revealed"))}else if(o.status==="surveying"){const c=Math.max(0,o.ticksRemaining-1);o={...o,ticksRemaining:c},c===0&&(o={...o,status:"idle",ticksRemaining:0,localOffset:void 0},r=gd(r,o.currentSystemId,"surveyed"))}return o.status==="idle"&&o.autoExplore?E_(o,r,l):{ship:o,galaxy:r}},j_=(a,i=1)=>{if(a.systems.length===0||i<=0)return[];const l=a.systems[0];return Array.from({length:i},(o,r)=>({id:`SCI-${crypto.randomUUID()}`,name:i>1?`ISS Pathfinder-${r+1}`:"ISS Pathfinder",currentSystemId:l.id,targetSystemId:null,status:"idle",ticksRemaining:0,autoExplore:!0}))},w_=(a,i,l)=>{if(i.length===0)return{galaxy:a,scienceShips:i};let o=a;const r=i.map(c=>{const d=M_(c,o,l);return o=d.galaxy,d.ship});return{galaxy:o,scienceShips:r}},Vn=(a,i)=>{const l=a.shipDesigns.find(o=>o.id===i);if(!l)throw new Error(`Unknown ship design: ${i}`);return l},hl=(a,i)=>({id:`SHIP-${crypto.randomUUID()}`,designId:a.id,hullPoints:a.hullPoints,...i}),T_=(a,i)=>({...a,id:a.id,name:`${a.name} - ${i.name}`,attack:a.attack+i.attack,defense:a.defense+i.defense,hullPoints:a.hullPoints+i.hull,buildCost:Object.fromEntries(Object.entries(a.buildCost).map(([l,o])=>[l,Math.round((o??0)*i.costMultiplier)]))}),C_=(a,i)=>{if(!i)return a;const{attackBonus:l,defenseBonus:o,hullBonus:r,costMultiplier:c,name:d}=i;return{...a,name:d?`${a.name} - ${d}`:a.name,attack:a.attack+l,defense:a.defense+o,hullPoints:a.hullPoints+r,buildCost:Object.fromEntries(Object.entries(a.buildCost).map(([m,p])=>[m,Math.round((p??0)*c)]))}},z_=({design:a,template:i,customization:l})=>{const o=i&&i.base===a.id?T_(a,i):a;return C_(o,l)},Ld=(a,i,l="player")=>{const o=[],r=i.startingShips?.colony??0,c=i.startingShips?.military??[];if(c.length>0&&c.forEach(({designId:d,count:m})=>{const p=Vn(i,d);for(let y=0;y<m;y+=1)o.push(hl(p))}),r>0){const d=Vn(i,i.colonyShipDesignId);for(let m=0;m<r;m+=1)o.push(hl(d))}return{id:`FLEET-${crypto.randomUUID()}`,name:"1 Flotta",ownerId:l,systemId:a,targetSystemId:null,ticksToArrival:0,ships:o}},qo=()=>({currentTechId:null,progress:0,completed:[]}),D_=a=>({branches:a.branches.reduce((l,o)=>({...l,[o.id]:qo()}),{physics:qo(),society:qo(),engineering:qo()}),backlog:a.techs,currentEra:a.eras?.[0]?.id??1,unlockedEras:a.eras?.length?[a.eras[0].id]:[1],exclusivePicks:{}}),Gg=(a,i)=>a.techs.find(l=>l.id===i),R_=(a,i,l,o)=>{const r=Gg(o,i);if(!r)return{success:!1,reason:"INVALID_TECH"};if(r.branch!==a)return{success:!1,reason:"BRANCH_MISMATCH"};if((r.era??1)>l.currentEra)return{success:!1,reason:"PREREQ_NOT_MET"};const d=l.branches[a];if(d.completed.includes(i))return{success:!1,reason:"ALREADY_COMPLETED"};if(!(r.prerequisites??[]).every(g=>d.completed.includes(g)))return{success:!1,reason:"PREREQ_NOT_MET"};if(r.mutuallyExclusiveGroup&&l.exclusivePicks&&l.exclusivePicks[r.mutuallyExclusiveGroup]&&l.exclusivePicks[r.mutuallyExclusiveGroup]!==r.id)return{success:!1,reason:"PREREQ_NOT_MET"};const y={...d,currentTechId:i,progress:0},v={...l.exclusivePicks??{}};return r.mutuallyExclusiveGroup&&!v[r.mutuallyExclusiveGroup]&&(v[r.mutuallyExclusiveGroup]=r.id),{success:!0,state:{...l,branches:{...l.branches,[a]:y},exclusivePicks:v}}},A_=({state:a,researchIncome:i,config:l})=>{if(i<=0)return{research:a,completed:[]};const o=i*l.pointsPerResearchIncome/3,r=[],c={...a.branches},d={...a.exclusivePicks??{}};Object.entries(c).forEach(([y,v])=>{if(!v.currentTechId)return;const g=Gg(l,v.currentTechId);if(!g)return;const b=v.progress+o;b>=g.cost?(g.mutuallyExclusiveGroup&&!d[g.mutuallyExclusiveGroup]&&(d[g.mutuallyExclusiveGroup]=g.id),c[y]={...v,currentTechId:null,progress:0,completed:[...v.completed,g.id]},r.push(g)):c[y]={...v,progress:b}});const m={...a,branches:c,exclusivePicks:d},p=U_(m,l);return{research:{...m,...p},completed:r}},k_=(a,i,l)=>{const o=i.branches[a];return(i.backlog&&i.backlog.length>0?i.backlog:l.techs).filter(c=>c.branch!==a||(c.era??1)>i.currentEra||o.completed.includes(c.id)||c.mutuallyExclusiveGroup&&i.exclusivePicks&&i.exclusivePicks[c.mutuallyExclusiveGroup]&&i.exclusivePicks[c.mutuallyExclusiveGroup]!==c.id?!1:c.prerequisites&&c.prerequisites.length>0?c.prerequisites.every(d=>o.completed.includes(d)):!0)},M0=a=>{switch(a){case"foundation":return 2;case"feature":return 1;case"rare":return .5;default:return 1}},O_=(a,i,l,o=3)=>{const r=k_(a,i,l);if(r.length<=o)return r;const c=i.currentEra+1,d=new Set((l.eras??[]).filter(_=>_.id===c).flatMap(_=>_.gatewayTechs??[])),m=i.currentEra,p=r.filter(_=>(_.era??1)<=m).sort((_,N)=>M0(N.kind)-M0(_.kind)),y=r.filter(_=>d.has(_.id)),v=p.filter(_=>_.kind==="foundation"),g=p.filter(_=>_.kind==="feature"),b=p.filter(_=>_.kind==="rare"),S=[];for(g.length>0&&S.push(g.shift());S.length<o&&v.length>0;)S.push(v.shift());for(;S.length<o&&g.length>0;)S.push(g.shift());for(;S.length<o&&b.length>0;)S.push(b.shift());for(;S.length<o&&p.length>0;)S.push(p.shift());return S.length<o&&y.length>0&&S.push(y.shift()),S},U_=(a,i)=>{const l=Object.values(a.branches).flatMap(d=>d.completed),o=new Set(a.unlockedEras);[...i.eras??[]].sort((d,m)=>d.id-m.id).forEach(d=>{if(o.has(d.id))return;const m=d.gatewayTechs??[];if(m.length===0){o.add(d.id);return}const p=Math.max(1,Math.ceil(m.length*.6));m.filter(v=>l.includes(v)).length>=p&&o.add(d.id)});const c=Math.max(...Array.from(o));return{unlockedEras:Array.from(o).sort((d,m)=>d-m),currentEra:c}},L_=a=>({availablePoints:0,unlocked:[],backlog:a.perks,currentEra:1,unlockedEras:[1],exclusivePicks:{}}),B_=(a,i)=>a.perks.find(l=>l.id===i),qg=(a,i)=>{const l=Array.from(new Set(i.perks.map(c=>c.era??1))).sort((c,d)=>c-d);if(l.length===0)return{currentEra:1,unlockedEras:[1]};const o=new Set([l[0]]),r=new Set(a.unlocked);for(let c=1;c<l.length;c+=1){const d=l[c-1],m=i.perks.filter(v=>(v.era??1)===d);if(m.length===0)continue;const p=m.filter(v=>r.has(v.id)).length,y=Math.max(1,Math.ceil(m.length*.6));p>=y&&o.add(l[c])}return{currentEra:Math.max(...Array.from(o)),unlockedEras:Array.from(o).sort((c,d)=>c-d)}},P_=({state:a,influenceIncome:i,config:l})=>{const o=Math.max(0,i*l.pointsPerInfluenceIncome);if(o<=0)return a;const r={...a,availablePoints:a.availablePoints+o},c=qg(r,l);return{...r,...c}},I_=(a,i,l)=>{const o=B_(l,a);return o?(o.era??1)>i.currentEra?{success:!1,reason:"PREREQ_NOT_MET"}:i.unlocked.includes(o.id)?{success:!1,reason:"ALREADY_UNLOCKED"}:o.prerequisites&&!o.prerequisites.every(c=>i.unlocked.includes(c))?{success:!1,reason:"PREREQ_NOT_MET"}:i.availablePoints<o.cost?{success:!1,reason:"INSUFFICIENT_POINTS"}:o.mutuallyExclusiveGroup&&i.exclusivePicks&&i.exclusivePicks[o.mutuallyExclusiveGroup]&&i.exclusivePicks[o.mutuallyExclusiveGroup]!==o.id?{success:!1,reason:"PREREQ_NOT_MET"}:{success:!0,state:(()=>{const c={...i,availablePoints:i.availablePoints-o.cost,unlocked:[...i.unlocked,o.id],exclusivePicks:{...i.exclusivePicks??{},...o.mutuallyExclusiveGroup?{[o.mutuallyExclusiveGroup]:o.id}:{}}},d=qg(c,l);return{...c,...d}})()}:{success:!1,reason:"INVALID_PERK"}},H_=(a,i)=>i.perks.filter(l=>{if((l.era??1)>a.currentEra||a.unlocked.includes(l.id))return!1;if(!l.prerequisites||l.prerequisites.length===0)return!(l.mutuallyExclusiveGroup&&a.exclusivePicks&&a.exclusivePicks[l.mutuallyExclusiveGroup]);const o=l.prerequisites.every(c=>a.unlocked.includes(c)),r=!l.mutuallyExclusiveGroup||!a.exclusivePicks||!a.exclusivePicks[l.mutuallyExclusiveGroup];return o&&r}),G_=()=>({tick:0,elapsedMs:0,speedMultiplier:1,isRunning:!1,lastUpdate:null}),q_=a=>{let i=a.split("").reduce((l,o)=>l+o.charCodeAt(0),0);return()=>{i+=1831565813;let l=Math.imul(i^i>>>15,1|i);return l^=l+Math.imul(l^l>>>7,61|l),((l^l>>>14)>>>0)/4294967296}},Y_=(a,i)=>{const l=q_(a),o=p=>Math.max(-100,Math.min(100,p)),r=["#ff9b5f","#8bcf8a","#f6e05e","#dd97ff"],c=["Impero Arcturus","Confederazione Lyra","Lega Vega"],d=p=>{const y=i.aiStartingOpinion.min+l()*(i.aiStartingOpinion.max-i.aiStartingOpinion.min),v=o(Math.round(y));return{id:`ai-${p+1}`,name:c[p]??`Impero-${p+1}`,kind:"ai",color:r[p%r.length]??"#ff9b5f",opinion:v,warStatus:"peace",personality:v<0?"espansionista":"pragmatico",accessToPlayer:!1}};return[{id:"player",name:"Impero del Giocatore",kind:"player",color:"#9fc1ff",opinion:0,warStatus:"peace"},d(0),d(1)]},V_=({seed:a,label:i,galaxyOverrides:l,starClasses:o,economyConfig:r,militaryConfig:c,diplomacyConfig:d,researchConfig:m,traditionConfig:p})=>{const y=N_({seed:a,starClasses:o,...l}),v=y.systems.map((D,A)=>A===0?{...D,ownerId:"player"}:A===1?{...D,ownerId:"ai-1"}:D),g={...y,systems:v},b=v[0]?.id??"unknown",S=c.startingShips??{science:1,construction:0,colony:0,military:[]},_=(D,A)=>({id:`FLEET-${crypto.randomUUID()}`,name:D,ownerId:"player",systemId:b,targetSystemId:null,ticksToArrival:0,ships:A}),N=(D,A)=>{if(A<=0)return[];const q=Vn(c,D);return Array.from({length:A},()=>hl(q))},M=[],T=(S.military??[]).flatMap(({designId:D,count:A})=>N(D,A));T.length>0&&M.push(_("1 Flotta",T));const w=N(c.colonyShipDesignId,S.colony??0);w.length>0&&M.push(_("Flotta Coloniale",w));const z=N(c.constructionShipDesignId,S.construction??0);return z.length>0&&M.push(_("Flotta Costruttrice",z)),{id:crypto.randomUUID(),label:i??`Session ${new Date().toLocaleTimeString()}`,createdAt:Date.now(),galaxy:g,empires:Y_(a,d),research:D_(m),traditions:L_(p),events:{active:null,queue:[],log:[]},warEvents:[],clock:G_(),scienceShips:j_(g,S.science??1),economy:Vx(b,r),colonizationTasks:[],fleets:M,shipyardQueue:[],districtConstructionQueue:[],combatReports:[],notifications:[]}},ll=["preparing","traveling","colonizing"],Yg=a=>({preparing:Math.max(0,a.preparationTicks),traveling:Math.max(0,a.travelTicks),colonizing:Math.max(1,a.durationTicks)}),X_=a=>{for(const i of ll)if(a[i]>0)return i;return"colonizing"},Q_=(a,i)=>{const l=ll.indexOf(a);for(let o=l+1;o<ll.length;o+=1){const r=ll[o];if(i[r]>0)return r}return null},Z_=(a,i,l)=>{if(!a.habitableWorld)throw new Error("System has no habitable world");const o=Yg(i),r=X_(o),c=o[r],d=ll.reduce((m,p)=>m+o[p],0);return{id:`CLN-${a.id}-${crypto.randomUUID()}`,systemId:a.id,planetTemplate:a.habitableWorld,ticksRemaining:c,totalTicks:c,status:r,missionElapsedTicks:0,missionTotalTicks:d||o.colonizing,shipId:l}},j0=a=>({id:`COL-${a.systemId}-${crypto.randomUUID()}`,name:a.planetTemplate.name,systemId:a.systemId,kind:a.planetTemplate.kind,size:a.planetTemplate.size,habitability:a.planetTemplate.habitability,population:{total:1,workers:1,specialists:0,researchers:0},baseProduction:a.planetTemplate.baseProduction,upkeep:a.planetTemplate.upkeep,districts:{},stability:60,happiness:60}),F_=(a,i,l)=>{if(a.length===0)return{tasks:a,economy:i,completed:[]};let o=i;const r=[],c=[],d=[],m=Yg(l),p=(y,v)=>{const g=Q_(y.status,m);if(!g){const S=j0(y);c.push(S),d.push({systemId:y.systemId,planetName:S.name});return}const b=m[g];r.push({...y,status:g,ticksRemaining:b,totalTicks:b,missionElapsedTicks:v})};return a.forEach(y=>{const v=y.ticksRemaining-1,g=Math.min(y.missionTotalTicks,y.missionElapsedTicks+1);if(v>0){r.push({...y,ticksRemaining:v,missionElapsedTicks:g});return}if(y.status==="colonizing"){c.push(j0(y)),d.push({systemId:y.systemId,planetName:y.planetTemplate.name});return}p(y,g)}),c.length>0&&(o={...o,planets:[...o.planets,...c]}),{tasks:r,economy:o,completed:d}},K_=(a,i,l,o)=>({id:`YARD-${crypto.randomUUID()}`,designId:a,ticksRemaining:i,totalTicks:i,templateId:l,customization:o}),$_=({tasks:a,fleets:i,scienceShips:l,military:o,fallbackSystemId:r})=>{if(a.length===0)return{tasks:a,fleets:i,scienceShips:l};let c=i,d=l,m=!1,p=!1;const y=S=>{try{return Vn(o,S).role??"military"}catch{return"military"}},v=S=>{const _=c.find(w=>w.ships.some(z=>y(z.designId)===S));if(_)return m||(c=c.map(w=>({...w,ships:[...w.ships]})),m=!0),c.find(w=>w.id===_.id);const N=c.filter(w=>w.ships.some(z=>y(z.designId)===S)).length,M=S==="construction"?"Flotta Costruttrice":S==="colony"?"Flotta Colonia":"Flotta Militare",T={id:`FLEET-${crypto.randomUUID()}`,name:`${M} ${N+1}`,ownerId:"player",systemId:r,targetSystemId:null,ticksToArrival:0,ships:[]};return c=m?[...c,T]:[...c,T],m=!0,T},g=()=>(c.length===0?(c=[Ld(r,o)],m=!0):m||(c=c.map(S=>({...S,ships:[...S.ships]})),m=!0),c[0]),b=[];return a.forEach(S=>{const _=Math.max(0,S.ticksRemaining-1);if(_===0){const N=Vn(o,S.designId),M=S.templateId?o.templates.find(w=>w.id===S.templateId):o.templates.find(w=>w.base===N.id),T=z_({design:N,template:M,customization:S.customization});if(N.role==="science")p||(d=[...d],p=!0),d.push({id:`SCI-${crypto.randomUUID()}`,name:T.name??N.name,currentSystemId:r,targetSystemId:null,status:"idle",ticksRemaining:0,autoExplore:!0});else{const w=N.role??"military";(w==="construction"||w==="colony"||w==="military"?v(w):g()).ships.push(hl(T))}}else b.push({...S,ticksRemaining:_})}),{tasks:b,fleets:c,scienceShips:d}},Vg=a=>new Map(a.military.shipDesigns.map(i=>[i.id,i])),W_=a=>({...a,ships:a.ships.map(i=>({...i}))}),J_=(a,i,l)=>{if(i<=0)return{survivors:a,shipsLost:0};const o=[];let r=i,c=0;return a.forEach(d=>{const p=l.get(d.designId)?.hullPoints??d.hullPoints,y=d.hullPoints;r>=y?(r-=y,c+=1):(o.push({...d,hullPoints:Math.min(p,y-r)}),r=0)}),{survivors:o,shipsLost:c}},Bd=(a,i)=>a.ships.reduce((l,o)=>{const r=i.get(o.designId),c=o.attackBonus??0;return l+(r?.attack??0)+c},0),e2=(a,i)=>a.ships.reduce((l,o)=>{const r=i.get(o.designId);return l+(r?.defense??0)},0),t2=(a,i)=>{const l=Vg(i);return a.filter(o=>!o.ownerId||o.ownerId==="player").reduce((o,r)=>o+Bd(r,l),0)},a2=({fleets:a,galaxy:i,config:l,fallbackSystemId:o,tick:r})=>{if(a.length===0)return{fleets:a,galaxy:i,reports:[],hostilesCleared:[]};const c=Vg(l);let d=i.systems,m=!1;const p=[],y=a.map(W_),v=[],g=new Map;d.forEach((N,M)=>{g.set(N.id,M)});const b=N=>g.get(N)??-1,S=()=>{m||(d=d.map(N=>({...N})),m=!0)};return y.forEach(N=>{if(N.targetSystemId&&N.ticksToArrival>0&&(N.ticksToArrival=Math.max(0,N.ticksToArrival-1),N.ticksToArrival===0&&(N.systemId=N.targetSystemId,N.targetSystemId=null,N.localOffset=void 0)),N.ships.length===0)return;const M=b(N.systemId);if(M<0)return;const T=d[M],w=T.hostilePower??0;if(w<=0)return;S();const z=Bd(N,c),D=e2(N,c),A=z,q=Math.max(0,w-Math.round(D*.5)),I=Math.max(0,w-A),G=J_(N.ships,q,c);N.ships=G.survivors;const F=G.shipsLost;let Z="playerVictory";I<=0&&N.ships.length===0?Z="mutualDestruction":I>0&&N.ships.length===0?Z="playerDefeat":I>0&&N.ships.length>0&&(Z="stalemate"),d[M]={...T,hostilePower:Math.max(0,I)},I<=0&&v.push(T.id),p.push({id:`COMBAT-${T.id}-${r}-${crypto.randomUUID()}`,systemId:T.id,tick:r,playerPower:z,playerDefense:D,damageTaken:q,hostilePower:w,result:Z,losses:[{fleetId:N.id,shipsLost:F}]}),N.ships.length===0&&(N.targetSystemId=null,N.ticksToArrival=0)}),{fleets:y.length>0?y:[Ld(o,l.military)],galaxy:m?{...i,systems:d}:i,reports:p,hostilesCleared:v}},w0=(a,i)=>a.systems.find(l=>l.id===i),yd=(a,i,l,o)=>{if(a===i)return 0;const r=w0(l,a),c=w0(l,i);if(!r||!c)return o.baseTravelTicks;const d=c.position.x-r.position.x,m=c.position.y-r.position.y,y=Math.sqrt(d*d+m*m)/60;return Math.max(1,Math.round(o.baseTravelTicks+y))},n2=({planetId:a,districtId:i,buildTime:l})=>({id:`DIST-${a}-${i}-${crypto.randomUUID()}`,planetId:a,districtId:i,ticksRemaining:l,totalTicks:l}),i2=(a,i)=>({...a,districts:{...a.districts,[i]:(a.districts[i]??0)+1}}),s2=({tasks:a,economy:i,config:l})=>{if(a.length===0)return{tasks:a,economy:i,completed:[]};const o=[];let r=i;const c=[];return a.forEach(d=>{const m=Math.max(0,d.ticksRemaining-1);if(m===0){c.push(d);const p=r.planets.find(g=>g.id===d.planetId),y=l?.districts.find(g=>g.id===d.districtId);r=!y?.requiresColonists||(p?.population.total??0)>=(y.requiresColonists??0)?{...r,planets:r.planets.map(g=>g.id===d.planetId?i2(g,d.districtId):g)}:r}else o.push({...d,ticksRemaining:m})}),{tasks:o,economy:r,completed:c}},Gi=(a,i)=>{const l=a.production[i]??0,o=a.upkeep[i]??0;return l-o},l2=()=>({energy:0,minerals:0,food:0,research:0,influence:0}),o2=a=>({...a.population}),r2=({planet:a,workerJob:i,bestJobs:l,deficitTargets:o,surplusTargets:r,priorities:c,automation:d})=>{const m=o2(a);let p=!1;const y=(v,g)=>{m[v]=Math.max(0,(m[v]??0)-1),m[g]=(m[g]??0)+1,p=!0};return c.forEach(v=>{let g=o[v];if(g===void 0||g<=d.deficitThreshold)return;const b=l.get(v);if(!b||b.id==="workers")return;const S=Gi(b,v)-Gi(i,v);if(S<=0||m.workers<=0)return;const _=Math.min(m.workers,Math.ceil(g/S));if(!(_<=0))for(let N=0;N<_&&!(m.workers<=0||(y("workers",b.id),g=Math.max(0,g-S),o[v]=g,g<=d.deficitThreshold));N+=1);}),c.forEach(v=>{let g=r[v];if(g===void 0||g<=d.surplusThreshold)return;const b=l.get(v);if(!b||b.id==="workers")return;const S=m[b.id]??0;if(S<=0)return;const _=Gi(b,v)-Gi(i,v);if(_<=0)return;const N=Math.min(S,Math.ceil((g-d.surplusThreshold)/_));if(!(N<=0))for(let M=0;M<N&&!((m[b.id]??0)<=0||(y(b.id,"workers"),g=Math.max(d.surplusThreshold,g-_),r[v]=g,g<=d.surplusThreshold));M+=1);}),p?{...a,population:m}:a},c2=({economy:a,config:i})=>{const l=i.populationAutomation;if(!l?.enabled)return a;const o=i.populationJobs.find(v=>v.id==="workers");if(!o)return a;const r=l2();gt.forEach(v=>{const g=a.resources[v],b=g?.income??0,S=g?.upkeep??0;r[v]=b-S});const c={},d={};let m=!1;if(l.priorities.forEach(v=>{const g=r[v]??0;g<-l.deficitThreshold?(c[v]=Math.abs(g),m=!0):g>l.surplusThreshold&&(d[v]=g,m=!0)}),!m)return a;const p=new Map;gt.forEach(v=>{const g=i.populationJobs.reduce((b,S)=>{if(S.id==="workers")return b;const _=Gi(S,v);if(_<=0)return b;if(!b)return S;const N=Gi(b,v);return _>N?S:b},null);g&&p.set(v,g)});const y=a.planets.map(v=>r2({planet:v,workerJob:o,bestJobs:p,deficitTargets:c,surplusTargets:d,priorities:l.priorities,automation:l}));return{...a,planets:y}},u2=()=>({incomeMultipliers:{},influenceFlat:0}),T0=(a,i)=>{const[l,o]=a.split(":"),r=Number(o);if(!Number.isNaN(r))switch(l){case"energyIncome":case"mineralsIncome":case"foodIncome":case"researchIncome":{const c=l.replace("Income",""),d=i.incomeMultipliers[c]??0;i.incomeMultipliers[c]=d+r;break}case"influenceFlat":{i.influenceFlat+=r;break}}},d2=({research:a,traditions:i,researchConfig:l,traditionConfig:o})=>{const r=u2();return l.techs.filter(m=>a.branches[m.branch].completed.includes(m.id)).forEach(m=>{(m.effects??[]).forEach(p=>T0(p,r))}),o.perks.filter(m=>i.unlocked.includes(m.id)).forEach(m=>{(m.effects??[]).forEach(p=>T0(p,r))}),r},f2={energy:"Energia",minerals:"Minerali",food:"Cibo",research:"Ricerca",influence:"Influenza"},h2=(a,i,l,o,r)=>{switch(i.kind){case"resource":{if(!i.target)return{session:a,queuedEvent:null};const c=i.amount??0;if(c===0)return{session:a,queuedEvent:null};const d={...a.economy.resources},m=d[i.target];return m?(d[i.target]={...m,amount:Math.max(0,m.amount+c)},{session:{...a,economy:{...a.economy,resources:d}},queuedEvent:null}):{session:a,queuedEvent:null}}case"influence":{const c=i.amount??0;if(c===0)return{session:a,queuedEvent:null};const d={...a.economy.resources},m=d.influence;return d.influence={...m,amount:Math.max(0,(m?.amount??0)+c)},{session:{...a,economy:{...a.economy,resources:d}},queuedEvent:null}}case"hostileSpawn":{const c=i.systemId??r,d=i.amount??0;if(!c||d===0)return{session:a,queuedEvent:null};const m=a.galaxy.systems.map(p=>p.id===c?{...p,hostilePower:Math.max(0,(p.hostilePower??0)+d)}:p);return{session:{...a,galaxy:{...a.galaxy,systems:m}},queuedEvent:null}}case"stability":{const c=i.amount??0;if(c===0)return{session:a,queuedEvent:null};const d=a.economy.planets.map(m=>({...m,stability:Math.max(20,Math.min(95,m.stability+c))}));return{session:{...a,economy:{...a.economy,planets:d}},queuedEvent:null}}case"triggerEvent":{if(!i.nextEventId)return{session:a,queuedEvent:null};const c=g2(l,i.nextEventId,r??void 0);return{session:a,queuedEvent:c}}case"insight":{const c=i.techId,d=i.perkId;let m=a;if(c){const p=o.research.techs.find(y=>y.id===c);if(p){const v=a.research.branches[p.branch].completed.includes(p.id),g=a.research.backlog.some(b=>b.id===p.id);!v&&!g&&(m={...m,research:{...m.research,backlog:[...m.research.backlog,p]}})}}if(d){const p=o.traditions.perks.find(y=>y.id===d);if(p){const y=a.traditions.unlocked.includes(p.id),v=a.traditions.backlog.some(g=>g.id===p.id);!y&&!v&&(m={...m,traditions:{...m.traditions,backlog:[...m.traditions.backlog,p]}})}}return{session:m,queuedEvent:null}}default:return{session:a,queuedEvent:null}}},m2=({session:a,option:i,activeEvent:l,tick:o,config:r})=>{let c=a;const d=[];i.effects.forEach(p=>{const{session:y,queuedEvent:v}=h2(c,p,r.events,r,l.systemId);c=y,v&&d.push(v)});const m={id:`evt-log-${l.id}`,tick:o,title:l.title,result:i.label};return{session:c,logEntry:m,queued:d}},Xg=(a,i)=>{const l=i.effects.filter(r=>r.kind==="resource"&&(r.amount??0)<0);if(l.length===0)return!0;const o=l.reduce((r,c)=>{const d=c.target;return d&&typeof c.amount=="number"&&c.amount<0&&(r[d]=Math.abs(c.amount)),r},{});return Fi(a.economy,o)},p2=(a,i)=>{const l=i.effects.reduce((o,r)=>(r.kind!=="resource"||!r.target||typeof r.amount=="number"&&r.amount<0&&(o[r.target]=Math.abs(r.amount)),o),{});return vl(a.economy,l)},ml=a=>a.length===0?null:a[Math.floor(Math.random()*a.length)],pr=(a,i)=>({...a,id:`${a.id}-${crypto.randomUUID()}`,systemId:i??null,resolvedOptionId:null}),g2=(a,i,l)=>{const o=a.narrative.find(r=>r.id===i)??a.anomalies.find(r=>r.id===i)??a.crisis.find(r=>r.id===i);return o?pr(o,l):null},y2=a=>{const i=a.narrative,l=ml(i);return l?pr(l):null},v2=(a,i)=>{const l=ml(a.anomalies);return l?pr(l,i):null},b2=(a,i)=>{const l=ml(a.crisis);return l?pr(l,i):null},x2=({session:a,config:i,tick:l})=>{const o=a.events.log.at(-1)?.tick??null;if(o!==null&&l-o<8)return null;const r=a.warEvents.length>0?a.warEvents[a.warEvents.length-1].tick:null;if(r!==null&&l-r<5||a.notifications.some(c=>c.kind==="eventStarted"&&l-c.tick<4)||a.warEvents.length>0&&Math.random()<.2)return null;if(l>40&&l%i.crisisIntervalTicks===0){const c=ml(a.galaxy.systems.filter(d=>d.visibility==="surveyed"));return c?b2(i,c.id):null}if(l>15&&l%i.anomalyIntervalTicks===0){const c=ml(a.galaxy.systems.filter(d=>d.visibility==="surveyed"&&(d.hostilePower??0)===0));return c?v2(i,c.id):null}return l>10&&l%i.narrativeIntervalTicks===0?y2(i):null},S2=a=>{const i=a.effects.filter(l=>l.kind==="resource"&&(l.amount??0)<0&&l.target);return i.length===0?"":i.map(l=>`${f2[l.target]} ${Math.abs(l.amount??0)}`).join(", ")},_2=a=>Math.max(-100,Math.min(100,a)),N2=({empires:a,config:i,tick:l,playerFleetPower:o=0})=>{if(a.length<=1)return{empires:a,notifications:[],warsStarted:[],warsEnded:[]};if(l%Math.max(1,i.autoCheckInterval)!==0)return{empires:a,notifications:[],warsStarted:[],warsEnded:[]};const r=[],c=[],d=[],m=a.map(p=>({...p}));return m.forEach(p=>{if(p.kind==="player")return;const y=_2(p.opinion+i.opinionDriftPerCheck);p.opinion=y,p.warStatus==="peace"&&y<=i.warThreshold?(p.warStatus="war",p.warSince=l,c.push(p.id),r.push({id:`notif-${crypto.randomUUID()}`,tick:l,kind:"warDeclared",message:`${p.name} ha dichiarato guerra!`})):p.warStatus==="war"&&(y>=i.peaceThreshold||j2({empire:p,playerFleetPower:o}))&&(p.warStatus="peace",p.warSince=null,d.push(p.id),r.push({id:`notif-${crypto.randomUUID()}`,tick:l,kind:"peaceAccepted",message:`${p.name} accetta una tregua.`}))}),{empires:m,notifications:r,warsStarted:c,warsEnded:d}},Qg=({galaxy:a,warsStarted:i,tick:l,config:o})=>{if(i.length===0)return a;const r=a.systems.slice(),c=Math.max(1,r.length-1);return i.forEach((d,m)=>{for(let p=0;p<o.count;p+=1){const y=1+(l+m*3+p)%c,v=r[y];if(!v)continue;const g=Math.max(1,o.powerMax-o.powerMin),b=o.powerMin+(l+p+m)%g;r[y]={...v,hostilePower:Math.max(v.hostilePower??0,b)}}}),{...a,systems:r}},E2=(a,i)=>{if(i.size===0)return a;const l=a.systems.map((o,r)=>r===0||i.has(o.id)?{...o,ownerId:"player"}:(o.ownerId&&o.ownerId!=="player",o));return{...a,systems:l}},M2=({galaxy:a,empires:i,tick:l,config:o})=>{const r=i.filter(m=>m.kind==="ai"&&m.warStatus==="war");if(r.length===0||l%8!==0)return a;const c=a.systems.slice(),d=Math.max(1,c.length-1);return r.forEach((m,p)=>{const y=1+(l+p)%d,v=c[y];if(!v)return;const g=Math.max(1,o.powerMax-o.powerMin),b=o.powerMin+(l+p)%g;c[y]={...v,hostilePower:Math.max(v.hostilePower??0,b)}}),{...a,systems:c}},j2=({empire:a,playerFleetPower:i})=>{const l=Math.abs(a.opinion);return a.opinion>-20&&i>12||l<15},Zg=a=>{const i=a.shipDesigns.filter(l=>(l.role??"military")==="military");return i.length>0?i:a.shipDesigns},C0=({galaxy:a,avoidSystemIds:i,preferHostile:l,fleetPower:o})=>{const r=a.systems.filter(d=>(d.hostilePower??0)>0&&!i.includes(d.id)).sort((d,m)=>(m.hostilePower??0)-(d.hostilePower??0));if(l){const d=r.find(m=>(m.hostilePower??0)<=o*1.6);if(d)return d.id}if(r.length>0)return r[0]?.id??null;const c=a.systems.filter(d=>(d.hostilePower??0)===0&&!i.includes(d.id));return c.length===0?null:c[Math.floor(Math.random()*c.length)]?.id??null},w2=(a,i,l)=>{const o=a.galaxy.systems.filter(S=>(S.hostilePower??0)>0).length,r=a.galaxy.systems.reduce((S,_)=>S+(_.hostilePower??0),0),c=o>=5?3:o>=3?2:1,d=a.fleets.filter(S=>S.ownerId&&S.ownerId!=="player");if(d.length>=c)return a;const m=a.galaxy.systems[1]?.id??a.galaxy.systems[0]?.id;if(!m||a.fleets.some(S=>S.ownerId==="ai-1"))return a;const p=Zg(i),y=l.aiFleetStrength.baseShips+Math.min(o*l.aiFleetStrength.extraPerHostile,l.aiFleetStrength.maxShips),v=Math.min(6,Math.floor(r/Math.max(1,l.aiFleetStrength.attackBonusPerThreat))),g=[];for(let S=0;S<y;S+=1){const _=p[S%p.length],N=o>=5?6:o>=3?3:o>=1?1:0;g.push({id:`SHIP-${crypto.randomUUID()}`,designId:_.id,hullPoints:_.hullPoints+N,attackBonus:Math.max(0,v)})}const b={...Ld(m,i,"ai-1"),name:`Flotta AI ${d.length+1}`,ships:g};return{...a,fleets:[...a.fleets,b]}},T2=(a,i,l)=>{const o=a.galaxy.systems.filter(p=>(p.hostilePower??0)>0).length,r=l.aiFleetStrength.baseShips+Math.min(o*l.aiFleetStrength.extraPerHostile,l.aiFleetStrength.maxShips),c=Zg(i),d=a.fleets.map(p=>({...p,ships:[...p.ships]}));let m=!1;return d.forEach(p=>{if(!(!p.ownerId||p.ownerId==="player"))for(;p.ships.length<r;){const y=c[p.ships.length%c.length];p.ships.push(hl(y,{attackBonus:o>=3?2:0})),m=!0}}),m?{...a,fleets:d}:a},C2=({session:a,military:i})=>{const l=a.empires.filter(c=>c.kind==="ai"&&c.warStatus==="war");if(l.length===0)return a;const o=a.fleets.map(c=>({...c}));let r=!1;return l.forEach(c=>{const d=o.find(_=>_.ownerId===c.id);if(!d||d.targetSystemId)return;const m=a.galaxy.systems.find(_=>_.id===d.systemId)??null,p=Bd(d,new Map(i.shipDesigns.map(_=>[_.id,_]))),y=m?.hostilePower??0,v=a.galaxy.systems[1]??a.galaxy.systems[0];if(y>p*1.25&&v){const _=yd(d.systemId,v.id,a.galaxy,i.fleet);d.targetSystemId=v.id,d.ticksToArrival=Math.max(1,_),r=!0;return}const g=[d.systemId];d.lastTargetSystemId&&g.push(d.lastTargetSystemId);const b=C0({galaxy:a.galaxy,avoidSystemIds:g,preferHostile:!0,fleetPower:p})??C0({galaxy:a.galaxy,avoidSystemIds:g,preferHostile:!1,fleetPower:p})??a.galaxy.systems[0]?.id??null;if(!b||b===d.systemId)return;const S=yd(d.systemId,b,a.galaxy,i.fleet);d.targetSystemId=b,d.ticksToArrival=Math.max(1,S),d.lastTargetSystemId=b,r=!0}),r?{...a,fleets:o}:a},z2=(a,i)=>{const l=i.find(c=>c.kind==="ai");if(!l)return a;const o=a.systems.find(c=>!c.ownerId&&c.habitableWorld&&(c.hostilePower??0)===0);if(!o)return a;const r=a.systems.map(c=>c.id===o.id?{...c,ownerId:l.id}:c);return{...a,systems:r}},D2={playerVictory:"Vittoria",playerDefeat:"Sconfitta",mutualDestruction:"Mutua distruzione",stalemate:"Stallo"},R2=a=>{const i=a.systems.map(l=>{if(!l.shipyardBuild)return l;const o=Math.max(0,l.shipyardBuild.ticksRemaining-1);return o<=0?{...l,ownerId:l.ownerId??"player",hasShipyard:!0,shipyardAnchorPlanetId:l.shipyardBuild.anchorPlanetId??null,shipyardBuild:void 0}:{...l,shipyardBuild:{...l.shipyardBuild,ticksRemaining:o}}});return{...a,systems:i}},A2=(a,i,l)=>{if(i<=0)return a;let o=a;for(let r=0;r<i;r+=1){const c=[],d=[...o.warEvents],m=d2({research:o.research,traditions:o.traditions,researchConfig:l.research,traditionConfig:l.traditions}),p=o.fleets[0]?.systemId??o.galaxy.systems[0]?.id??"unknown",y=o.clock.tick+r+1;o=w2(o,l.military,l.diplomacy),o=T2(o,l.military,l.diplomacy);const v=F_(o.colonizationTasks,o.economy,l.colonization);let g=o.galaxy;const b=new Set(v.economy.planets.map(U=>U.systemId));v.completed.forEach(U=>b.add(U.systemId)),b.size>0&&(g=E2(g,b)),g=z2(g,o.empires);const S=s2({tasks:o.districtConstructionQueue,economy:v.economy});v.completed.length>0&&v.completed.forEach(U=>{c.push({id:`notif-${crypto.randomUUID()}`,tick:o.clock.tick+r+1,kind:"colonizationCompleted",message:`Colonia fondata in ${U.planetName} (${U.systemId}).`})}),S.completed.length>0&&S.completed.forEach(U=>{const L=S.economy.planets.find(fe=>fe.id===U.planetId),K=l.economy.districts.find(fe=>fe.id===U.districtId);c.push({id:`notif-${crypto.randomUUID()}`,tick:o.clock.tick+r+1,kind:"districtComplete",message:`Distretto ${K?.label??U.districtId} completato su ${L?.name??U.planetId}`})});const _=$_({tasks:o.shipyardQueue,fleets:o.fleets,scienceShips:o.scienceShips,military:l.military,fallbackSystemId:p}),N=a2({fleets:_.fleets,galaxy:g,config:l,fallbackSystemId:p,tick:y});N.reports.length>0&&N.reports.forEach(U=>{const L=N.galaxy.systems.find(fe=>fe.id===U.systemId)?.name??U.systemId,K=D2[U.result]??U.result;c.push({id:`notif-${crypto.randomUUID()}`,tick:U.tick,kind:"combatReport",message:`Combattimento a ${L}: ${K} (forza ${U.playerPower} vs ${U.hostilePower}).`})}),N.hostilesCleared.length>0&&N.hostilesCleared.forEach(U=>{const L=N.galaxy.systems.find(K=>K.id===U)?.name??U;c.push({id:`notif-${crypto.randomUUID()}`,tick:y,kind:"combatReport",message:`Minaccia neutralizzata in ${L}.`})});const M=N2({empires:o.empires,config:l.diplomacy,tick:y,playerFleetPower:t2(N.fleets,l)});M.notifications.length>0&&c.push(...M.notifications),M.warsStarted.length>0&&M.warsStarted.forEach(U=>{d.push({id:`war-${crypto.randomUUID()}`,type:"warStart",empireId:U,tick:y,message:"Guerra dichiarata."})}),M.warsEnded.length>0&&M.warsEnded.forEach(U=>{d.push({id:`war-${crypto.randomUUID()}`,type:"warEnd",empireId:U,tick:y,message:"Pace raggiunta."})});const T=Qg({galaxy:N.galaxy,warsStarted:M.warsStarted,tick:y,config:l.diplomacy.warZones}),w=M2({galaxy:T,empires:M.empires,tick:y,config:l.diplomacy.warZones}),z=C2({session:{...o,fleets:N.fleets,galaxy:w},military:l.military}),D=R2(w),{galaxy:A,scienceShips:q}=w_(D,_.scienceShips,l.exploration),I=c2({economy:S.economy,config:l.economy}),{economy:G,netProduction:F}=Zx(I,l.economy,m),Z=A_({state:o.research,researchIncome:Math.max(0,F.research),config:l.research}),J=P_({state:o.traditions,influenceIncome:Math.max(0,F.influence),config:l.traditions});Z.completed.length>0&&Z.completed.forEach(U=>{c.push({id:`notif-tech-${U.id}-${y}`,tick:y,kind:"combatReport",message:`Ricerca completata: ${U.name}.`})});let ee=o.events.queue,re=o.events.active;!re&&ee.length>0&&(re=ee[0],ee=ee.slice(1));const de=re===null?x2({session:o,config:l.events,tick:y}):null,Ee=de!==null?{id:`notif-evt-${de.id}`,tick:y,kind:"eventStarted",message:`Nuovo evento: ${de.title}`}:null;Ee&&c.push(Ee),re=re??de??null,o={...o,galaxy:A,scienceShips:q,empires:M.empires,research:Z.research,traditions:J,events:{active:re,queue:ee,log:o.events.log},warEvents:d.slice(-l.diplomacy.warEventLogLimit),colonizationTasks:v.tasks,districtConstructionQueue:S.tasks,shipyardQueue:_.tasks,fleets:z.fleets,combatReports:[...o.combatReports,...N.reports].slice(-8),notifications:[...o.notifications,...c].slice(-6),economy:G}}return o},k2=({clock:a,elapsedMs:i,tickDurationMs:l,now:o})=>{if(!a.isRunning)return{...a,lastUpdate:o};const r=i*a.speedMultiplier,c=a.elapsedMs+r,d=Math.floor(c/l),m=c%l;return{...a,elapsedMs:m,tick:a.tick+d,lastUpdate:o}},O2=(a,i,l)=>({...a,isRunning:i,lastUpdate:l}),U2=(a,i)=>({...a,speedMultiplier:i}),L2=a=>Math.max(16,Math.round(1e3/a.ticksPerSecond)),B2=(a,i)=>{for(const l of a){if(l.ownerId&&l.ownerId!=="player")continue;const o=l.ships.findIndex(m=>m.designId===i);if(o<0)continue;const r=l.ships[o],c=l.ships.filter((m,p)=>p!==o),d=c.length>0?a.map(m=>m.id===l.id?{...m,ships:c}:m):a.filter(m=>m.id!==l.id);return{shipId:r.id,fleets:d}}return null},Fg=(a,i,l,o=0,r)=>{let c=!1;const d=a.map(m=>{if(m.id!==i)return m;c=!0;const p=l==="war"?r??m.warSince??0:null;return{...m,warStatus:l,warSince:p,opinion:m.opinion+o}});return c?d:a},P2=({ship:a,systemId:i,ownerId:l})=>({id:`FLEET-${crypto.randomUUID()}`,name:"Nuova flotta",ownerId:l,systemId:i,targetSystemId:null,ticksToArrival:0,ships:[a]});let pn=null,I2=0;const il=new Map,H2=()=>pn||(pn=new Worker(new URL("/fls-node-epicronicles/assets/simulationWorker-BcfYVLf1.js",import.meta.url),{type:"module"}),pn.onmessage=a=>{const i=a.data;if(i.type!=="result")return;const l=il.get(i.id);l&&(l.resolve(i.session),il.delete(i.id))},pn.onerror=a=>{il.forEach(({reject:i})=>i(new Error(`Simulation worker error: ${a.message}`))),il.clear(),pn?.terminate(),pn=null},pn),G2=(a,i,l)=>new Promise((o,r)=>{try{const c=H2(),d=++I2;il.set(d,{resolve:o,reject:r});const m={type:"simulate",id:d,session:a,ticks:i,config:l};c.postMessage(m)}catch(c){r(c)}}),q2=a=>(i,l)=>{const o=l().game.config,r=o.galaxyPresets.find(m=>m.id===(a?.presetId??""))??o.galaxyPresets.find(m=>m.id==="standard"),c=a?.seed??r?.seed??o.defaultGalaxy.seed,d=V_({seed:c,starClasses:o.starClasses,label:a?.label,galaxyOverrides:{systemCount:r?.systemCount??o.defaultGalaxy.systemCount,galaxyRadius:r?.galaxyRadius??o.defaultGalaxy.galaxyRadius,galaxyShape:a?.galaxyShape??r?.galaxyShape??o.defaultGalaxy.galaxyShape},economyConfig:o.economy,researchConfig:o.research,traditionConfig:o.traditions,militaryConfig:o.military,diplomacyConfig:o.diplomacy});i(Ag(d))},Y2=()=>t_(),V2=(a,i=Date.now())=>(l,o)=>{const r=o().game.session;if(!r)return;const c={...r,clock:O2(r.clock,a,i)};l(Re(c))},X2=a=>(i,l)=>{const o=l().game.session;if(!o)return;const r={...o,clock:U2(o.clock,a)};i(Re(r))},Q2=(a,i)=>async(l,o)=>{const r=o().game,c=r.session;if(!c)return;const d=k2({clock:c.clock,elapsedMs:a,tickDurationMs:L2(r.config),now:i}),m=Math.min(d.tick-c.clock.tick,5),p=m<d.tick-c.clock.tick?{...d,tick:c.clock.tick+m}:d;let y=c;if(m>0)try{y=await G2(c,m,r.config)}catch{y=A2(c,m,r.config)}l(Re({...y,clock:p}))},Pd="fls-save-v1",Z2=()=>(a,i)=>{const l=i().game.session;if(!l)return{success:!1,reason:"NO_SESSION"};if(typeof localStorage>"u")return{success:!1,reason:"STORAGE_UNAVAILABLE"};const o={version:1,savedAt:Date.now(),session:{...l,clock:{...l.clock,lastUpdate:null}}};try{return localStorage.setItem(Pd,JSON.stringify(o)),{success:!0}}catch(r){return console.error("Failed to write save",r),{success:!1,reason:"WRITE_FAILED"}}},F2=()=>a=>{if(typeof localStorage>"u")return{success:!1,reason:"STORAGE_UNAVAILABLE"};const i=localStorage.getItem(Pd);if(!i)return{success:!1,reason:"NOT_FOUND"};try{const l=JSON.parse(i);if(l?.version!==1||!l.session)return{success:!1,reason:"PARSE_ERROR"};const o={...l.session,clock:{...l.session.clock,lastUpdate:Date.now()}};return a(Ag(o)),{success:!0}}catch(l){return console.error("Failed to parse save",l),{success:!1,reason:"PARSE_ERROR"}}},K2=()=>typeof localStorage<"u"&&!!localStorage.getItem(Pd),xl=(a,i,l,o)=>{const r={id:`notif-${crypto.randomUUID()}`,tick:a.clock.tick,kind:l,message:i};return{...a,notifications:[...a.notifications,r].slice(-6)}},Kg=(a,i,l,o,r)=>{const c={id:`war-${crypto.randomUUID()}`,type:i,empireId:l,tick:o,message:r};return{...a,warEvents:[...a.warEvents,c].slice(-12)}},$2=(a,i)=>{const l={...a.resources};return Object.entries(i).forEach(([o,r])=>{if(!r)return;const c=o,d=l[c];l[c]={amount:(d?.amount??0)+r,income:d?.income??0,upkeep:d?.upkeep??0}}),{...a,resources:l}},W2=(a,i)=>({...a,population:{...a.population,...i}}),$g=(a,i)=>{const l={...a.population};return Object.keys(i).forEach(o=>{const r=i[o]??0;l[o]=Math.max(0,l[o]+r)}),W2(a,l)},J2=a=>(i,l)=>{const o=l().game,r=o.session;if(!r)return{success:!1,reason:"NO_SESSION"};const c=r.galaxy.systems.find(N=>N.id===a);if(!c)return{success:!1,reason:"SYSTEM_NOT_FOUND"};if(c.visibility==="unknown")return{success:!1,reason:"SYSTEM_UNKNOWN"};const d=r.economy.planets.some(N=>N.systemId===a);if(c.visibility!=="surveyed"&&!d)return{success:!1,reason:"SYSTEM_NOT_SURVEYED"};if(!c.habitableWorld)return{success:!1,reason:"NO_HABITABLE_WORLD"};if(r.economy.planets.some(N=>N.systemId===a))return{success:!1,reason:"ALREADY_COLONIZED"};if(r.colonizationTasks.some(N=>N.systemId===a))return{success:!1,reason:"TASK_IN_PROGRESS"};const y=o.config.colonization.cost;if(!Fi(r.economy,y))return{success:!1,reason:"INSUFFICIENT_RESOURCES"};const v=o.config.military.colonyShipDesignId,g=B2(r.fleets,v);if(!g)return{success:!1,reason:"NO_COLONY_SHIP"};const b=vl(r.economy,y),S=Z_(c,o.config.colonization,g.shipId),_={...r,economy:b,fleets:g.fleets,colonizationTasks:[...r.colonizationTasks,S]};return i(Re(xl(_,`Missione di colonizzazione avviata verso ${c.name}.`,"colonizationStarted"))),{success:!0}},eN=(a,i,l)=>(o,r)=>{const c=r().game,d=c.session;if(!d)return{success:!1,reason:"NO_SESSION"};const m=c.config.military.shipDesigns.find(S=>S.id===a);if(!m)return{success:!1,reason:"INVALID_DESIGN"};if(d.shipyardQueue.length>=c.config.military.shipyard.queueSize)return{success:!1,reason:"QUEUE_FULL"};const p=i?c.config.military.templates.find(S=>S.id===i):void 0,y=p&&p.base===m.id?{...m,attack:m.attack+p.attack,defense:m.defense+p.defense,hullPoints:m.hullPoints+p.hull,buildCost:Object.fromEntries(Object.entries(m.buildCost).map(([S,_])=>[S,Math.round((_??0)*p.costMultiplier)]))}:m,v=l?Object.fromEntries(Object.entries(y.buildCost).map(([S,_])=>[S,Math.round((_??0)*l.costMultiplier)])):y.buildCost;if(!Fi(d.economy,v))return{success:!1,reason:"INSUFFICIENT_RESOURCES"};const g=vl(d.economy,v),b=K_(m.id,m.buildTime,i,l);return o(Re({...d,economy:g,shipyardQueue:[...d.shipyardQueue,b]})),{success:!0}},tN=(a,i=null)=>(l,o)=>{const r=o().game,c=r.session;if(!c)return{success:!1,reason:"NO_SESSION"};const d=c.galaxy.systems.find(N=>N.id===a);if(!d)return{success:!1,reason:"SYSTEM_NOT_FOUND"};if(d.visibility!=="surveyed")return{success:!1,reason:"SYSTEM_NOT_SURVEYED"};if(d.shipyardBuild)return{success:!1,reason:"IN_PROGRESS"};if(d.hasShipyard)return{success:!1,reason:"ALREADY_BUILT"};if(!Object.values(c.research.branches).some(N=>N.completed.includes("orbital-shipyard")))return{success:!1,reason:"TECH_MISSING"};const p="construction";if(!c.fleets.some(N=>N.systemId===a&&N.ships.some(M=>Vn(r.config.military,M.designId)?.role===p)))return{success:!1,reason:"NO_CONSTRUCTOR"};const v=r.config.military.shipyard.buildCost??{};if(!Fi(c.economy,v))return{success:!1,reason:"INSUFFICIENT_RESOURCES"};const g=vl(c.economy,v),b=c.fleets.find(N=>N.systemId===a&&N.ships.some(M=>Vn(r.config.military,M.designId)?.role===p)),S=i??b?.anchorPlanetId??null,_=c.galaxy.systems.map(N=>N.id===a?{...N,ownerId:"player",shipyardBuild:{ticksRemaining:10,totalTicks:10,anchorPlanetId:S}}:N);return l(Re({...c,economy:g,galaxy:{...c.galaxy,systems:_}})),{success:!0}},aN=(a,i)=>(l,o)=>{const r=o().game,c=r.session;if(!c)return{success:!1,reason:"NO_SESSION"};if(!c.economy.planets.find(v=>v.id===a))return{success:!1,reason:"PLANET_NOT_FOUND"};const m=r.config.economy.districts.find(v=>v.id===i);if(!m)return{success:!1,reason:"INVALID_DISTRICT"};if(!Fi(c.economy,m.cost))return l(Re(xl(c,`Costruzione ${m.label} sospesa: risorse insufficienti.`,"districtSuspended"))),{success:!1,reason:"INSUFFICIENT_RESOURCES"};const p=vl(c.economy,m.cost),y=n2({planetId:a,districtId:i,buildTime:Math.max(1,m.buildTime)});return l(Re({...c,economy:p,districtConstructionQueue:[...c.districtConstructionQueue,y]})),{success:!0}},nN=(a,i)=>(l,o)=>{const r=o().game,c=r.session;if(!c)return{success:!1,reason:"NO_SESSION"};const d=c.economy.planets.findIndex(g=>g.id===a);if(d<0)return{success:!1,reason:"PLANET_NOT_FOUND"};if(!r.config.economy.districts.find(g=>g.id===i))return{success:!1,reason:"INVALID_DISTRICT"};const y=c.economy.planets[d].districts[i]??0;if(y<=0)return{success:!1,reason:"NONE_BUILT"};const v=c.economy.planets.map((g,b)=>b===d?{...g,districts:{...g.districts,[i]:Math.max(0,y-1)}}:g);return l(Re({...c,economy:{...c.economy,planets:v}})),{success:!0}},iN=a=>(i,l)=>{const o=l().game,r=o.session;if(!r)return{success:!1,reason:"NO_SESSION"};const c=r.districtConstructionQueue,d=c.find(v=>v.id===a);if(!d)return{success:!1,reason:"TASK_NOT_FOUND"};if(!r.economy.planets.find(v=>v.id===d.planetId))return{success:!1,reason:"PLANET_NOT_FOUND"};const p=o.config.economy.districts.find(v=>v.id===d.districtId),y=p?$2(r.economy,p.cost):r.economy;return i(Re({...r,economy:y,districtConstructionQueue:c.filter(v=>v.id!==a)})),{success:!0}},sN=a=>(i,l)=>{const o=l().game.session;if(!o)return{success:!1,reason:"NO_SESSION"};const r=[...o.districtConstructionQueue],c=r.findIndex(m=>m.id===a);if(c<0)return{success:!1,reason:"TASK_NOT_FOUND"};const[d]=r.splice(c,1);return r.unshift(d),i(Re({...o,districtConstructionQueue:r})),{success:!0}},lN=a=>(i,l)=>{const o=l().game,r=o.session;if(!r)return{success:!1,reason:"NO_SESSION"};const c=r.empires.find(g=>g.id===a);if(!c)return{success:!1,reason:"EMPIRE_NOT_FOUND"};if(c.kind==="player")return{success:!1,reason:"INVALID_TARGET"};if(c.warStatus==="war")return{success:!1,reason:"ALREADY_IN_STATE"};const d=r.clock.tick+1,m=Fg(r.empires,a,"war",-15,d),p=Qg({galaxy:r.galaxy,warsStarted:[a],tick:d,config:o.config.diplomacy.warZones}),y=Kg({...r,empires:m,galaxy:p},"warStart",a,d,`Guerra dichiarata contro ${c.name}.`),v=xl(y,`Guerra dichiarata contro ${c.name}.`,"warDeclared");return i(Re(v)),{success:!0}},oN=a=>(i,l)=>{const o=l().game.session;if(!o)return{success:!1,reason:"NO_SESSION"};const r=o.empires.find(p=>p.id===a);if(!r)return{success:!1,reason:"EMPIRE_NOT_FOUND"};if(r.kind==="player")return{success:!1,reason:"INVALID_TARGET"};if(r.warStatus==="peace")return{success:!1,reason:"ALREADY_IN_STATE"};const c=Fg(o.empires,a,"peace",10,null),d=Kg({...o,empires:c},"warEnd",a,o.clock.tick,`Pace raggiunta con ${r.name}.`),m=xl(d,`Tregua firmata con ${r.name}.`,"peaceAccepted");return i(Re(m)),{success:!0}},rN=a=>(i,l)=>{const o=l().game.session;if(!o)return{success:!1,reason:"NO_SESSION"};const r=o.empires.find(d=>d.id===a);if(!r)return{success:!1,reason:"EMPIRE_NOT_FOUND"};if(r.kind==="player")return{success:!1,reason:"INVALID_TARGET"};if(r.accessToPlayer)return{success:!1,reason:"ALREADY_GRANTED"};const c=o.empires.map(d=>d.id===a?{...d,accessToPlayer:!0,opinion:d.opinion+5}:d);return i(Re(xl({...o,empires:c},`${r.name} apre i confini.`,"peaceAccepted"))),{success:!0}},cN=(a,i)=>(l,o)=>{const r=o().game,c=r.session;if(!c)return{success:!1,reason:"NO_SESSION"};const d=c.fleets.find(y=>y.id===a);if(!d)return{success:!1,reason:"FLEET_NOT_FOUND"};const m=c.galaxy.systems.find(y=>y.id===i);if(!m)return{success:!1,reason:"SYSTEM_NOT_FOUND"};if(m.ownerId&&m.ownerId!=="player"&&m.ownerId.startsWith("ai")){const y=c.empires.find(v=>v.id===m.ownerId);if(y&&y.warStatus==="peace"&&!y.accessToPlayer)return{success:!1,reason:"BORDER_CLOSED"}}if(d.systemId===i&&d.targetSystemId===null)return{success:!1,reason:"ALREADY_IN_SYSTEM"};if(d.ships.length===0)return{success:!1,reason:"NO_SHIPS"};const p=yd(d.systemId,i,c.galaxy,r.config.military.fleet);return l(Re({...c,fleets:c.fleets.map(y=>y.id===a?{...y,targetSystemId:i,ticksToArrival:p,anchorPlanetId:null}:y)})),{success:!0}},uN=(a,i)=>(l,o)=>{const r=o().game.session;if(!r)return{success:!1,reason:"NO_SESSION"};if(a===i)return{success:!1,reason:"SAME_FLEET"};const c=r.fleets.find(p=>p.id===a),d=r.fleets.find(p=>p.id===i);if(!c)return{success:!1,reason:"FLEET_NOT_FOUND"};if(!d)return{success:!1,reason:"TARGET_NOT_FOUND"};if(c.systemId!==d.systemId)return{success:!1,reason:"DIFFERENT_SYSTEM"};const m=r.fleets.filter(p=>p.id!==a).map(p=>p.id===i?{...p,ships:[...p.ships,...c.ships]}:p);return l(Re({...r,fleets:m})),{success:!0}},dN=a=>(i,l)=>{const o=l().game.session;if(!o)return{success:!1,reason:"NO_SESSION"};const r=o.fleets.find(y=>y.id===a);if(!r)return{success:!1,reason:"FLEET_NOT_FOUND"};if(r.ships.length<=1)return{success:!1,reason:"INSUFFICIENT_SHIPS"};const c=r.ships[r.ships.length-1],d=r.ships.slice(0,-1),m=P2({ship:c,systemId:r.systemId,ownerId:r.ownerId}),p=o.fleets.map(y=>y.id===a?{...y,ships:d}:y);return i(Re({...o,fleets:[...p,m]})),{success:!0,newFleetId:m.id}},fN=(a,i)=>(l,o)=>{const r=o().game.session;if(!r)return{success:!1,reason:"NO_SESSION"};if(!r.fleets.find(m=>m.id===a))return{success:!1,reason:"FLEET_NOT_FOUND"};const d=r.fleets.map(m=>m.id===a?{...m,anchorPlanetId:i}:m);return l(Re({...r,fleets:d})),{success:!0}},hN=a=>(i,l)=>{const o=l().game.session;if(!o)return;const r=o.fleets.map(c=>c.id===a?{...c,targetSystemId:null,ticksToArrival:0}:c);i(Re({...o,fleets:r}))},mN=(a,i)=>(l,o)=>{const r=o().game,c=r.session;if(!c)return{success:!1,reason:"NO_SESSION"};if(c.scienceShips.findIndex(b=>b.id===a)<0)return{success:!1,reason:"SHIP_NOT_FOUND"};const m=c.galaxy.systems.find(b=>b.id===i);if(!m)return{success:!1,reason:"SYSTEM_NOT_FOUND"};if(m.visibility==="unknown")return{success:!1,reason:"SYSTEM_UNKNOWN"};const p=Math.max(1,r.config.exploration.travelTicks),y=c.scienceShips.map(b=>b.id===a?{...b,autoExplore:!1,status:"traveling",targetSystemId:i,ticksRemaining:p,anchorPlanetId:null}:b),v={unknown:0,revealed:1,surveyed:2},g=c.galaxy.systems.map(b=>b.id!==i||v[b.visibility]>=v.revealed?b:{...b,visibility:"revealed"});return l(Re({...c,scienceShips:y,galaxy:g===c.galaxy.systems?c.galaxy:{...c.galaxy,systems:g}})),{success:!0}},pN=(a,i)=>(l,o)=>{const r=o().game.session;if(!r)return;const c=r.scienceShips.map(d=>d.id===a?{...d,autoExplore:i}:d);l(Re({...r,scienceShips:c}))},gN=a=>(i,l)=>{const o=l().game.session;if(!o)return;const r=o.scienceShips.map(c=>c.id===a?{...c,status:"idle",targetSystemId:null,ticksRemaining:0,anchorPlanetId:c.anchorPlanetId??null}:c);i(Re({...o,scienceShips:r}))},yN=(a,i)=>(l,o)=>{const c=o().game.session;if(!c)return{success:!1,reason:"NO_SESSION"};if(!c.scienceShips.find(p=>p.id===a))return{success:!1,reason:"SHIP_NOT_FOUND"};const m=c.scienceShips.map(p=>p.id===a?{...p,anchorPlanetId:i}:p);return l(Re({...c,scienceShips:m})),{success:!0}},vN=(a,i)=>(l,o)=>{if(i==="workers")return{success:!1,reason:"INVALID_JOB"};const r=o().game.session;if(!r)return{success:!1,reason:"NO_SESSION"};const c=r.economy.planets.find(m=>m.id===a);if(!c)return{success:!1,reason:"PLANET_NOT_FOUND"};if(c.population.workers<=0)return{success:!1,reason:"NO_WORKERS"};const d=r.economy.planets.map(m=>m.id===a?$g(m,{workers:-1,[i]:1}):m);return l(Re({...r,economy:{...r.economy,planets:d}})),{success:!0}},bN=(a,i)=>(l,o)=>{if(i==="workers")return{success:!1,reason:"INVALID_JOB"};const r=o().game.session;if(!r)return{success:!1,reason:"NO_SESSION"};const c=r.economy.planets.find(m=>m.id===a);if(!c)return{success:!1,reason:"PLANET_NOT_FOUND"};if((c.population[i]??0)<=0)return{success:!1,reason:"NO_POPULATION"};const d=r.economy.planets.map(m=>m.id===a?$g(m,{workers:1,[i]:-1}):m);return l(Re({...r,economy:{...r.economy,planets:d}})),{success:!0}},xN=(a,i)=>(l,o)=>{const r=o().game,c=r.session;if(!c)return{success:!1,reason:"NO_SESSION"};const d=R_(a,i,c.research,r.config.research);return d.success?(l(Re({...c,research:d.state})),{success:!0}):{success:!1,reason:d.reason}},SN=a=>(i,l)=>{const o=l().game,r=o.session;if(!r)return{success:!1,reason:"NO_SESSION"};const c=I_(a,r.traditions,o.config.traditions);return c.success?(i(Re({...r,traditions:c.state})),{success:!0}):{success:!1,reason:c.reason}},_N=a=>(i,l)=>{const o=l().game,r=o.session;if(!r||!r.events.active)return{success:!1,reason:"NO_EVENT"};const c=r.events.active,d=c.options.find(g=>g.id===a);if(!d)return{success:!1,reason:"OPTION_NOT_FOUND"};if(!Xg(r,d))return{success:!1,reason:"INSUFFICIENT_RESOURCES"};const m=p2(r,d),{session:p,logEntry:y,queued:v}=m2({session:{...r,economy:m},option:d,activeEvent:c,tick:r.clock.tick,config:o.config});return i(Re({...p,events:{active:null,queue:[...p.events.queue,...v],log:[...p.events.log,y].slice(-20)},notifications:[...p.notifications,{id:`notif-evt-resolved-${c.id}`,tick:r.clock.tick,kind:"eventResolved",message:`${c.title}: ${d.label}`}].slice(-6)})),{success:!0}},NN=()=>gb(),we=bb,$=a=>{const i=NN(),l=we(r=>r.game),o=j.useMemo(()=>({startNewSession:r=>i(q2(r)),returnToMenu:()=>i(Y2()),setSimulationRunning:(r,c)=>i(V2(r,c)),setSpeedMultiplier:r=>i(X2(r)),advanceClockBy:(r,c)=>i(Q2(r,c)),startColonization:r=>i(J2(r)),queueShipBuild:(r,c,d)=>i(eN(r,c,d)),orderFleetMove:(r,c)=>i(cN(r,c)),orderScienceShip:(r,c)=>i(mN(r,c)),setScienceAutoExplore:(r,c)=>i(pN(r,c)),stopScienceShip:r=>i(gN(r)),setScienceShipPosition:(r,c)=>i(yN(r,c)),queueDistrictConstruction:(r,c)=>i(aN(r,c)),promotePopulation:(r,c)=>i(vN(r,c)),demotePopulation:(r,c)=>i(bN(r,c)),removeDistrict:(r,c)=>i(nN(r,c)),setFleetPosition:(r,c)=>i(fN(r,c)),cancelDistrictTask:r=>i(iN(r)),prioritizeDistrictTask:r=>i(sN(r)),declareWarOnEmpire:r=>i(lN(r)),proposePeaceWithEmpire:r=>i(oN(r)),requestBorderAccess:r=>i(rN(r)),mergeFleets:(r,c)=>i(uN(r,c)),splitFleet:r=>i(dN(r)),stopFleet:r=>i(hN(r)),buildShipyard:(r,c)=>i(tN(r,c??null)),saveSession:()=>i(Z2()),loadSession:()=>i(F2()),hasSavedSession:()=>K2(),beginResearch:(r,c)=>i(xN(r,c)),unlockTraditionPerk:r=>i(SN(r)),resolveActiveEvent:r=>i(_N(r))}),[i]);return a({...l,...o})},EN=240,MN=160;let Ju=1e4;const Lt=({title:a,initialX:i,initialY:l,initialWidth:o=280,initialHeight:r=260,children:c,onClose:d})=>{const[m,p]=j.useState({x:i,y:l}),[y,v]=j.useState({width:o,height:r}),[g,b]=j.useState(()=>++Ju),S=j.useRef(!1),_=j.useRef(!1),N=j.useRef({x:0,y:0}),M=j.useRef({x:0,y:0,width:o,height:r}),T=j.useCallback(A=>{if(S.current)p({x:A.clientX-N.current.x,y:A.clientY-N.current.y});else if(_.current){const q=A.clientX-M.current.x,I=A.clientY-M.current.y;v({width:Math.max(EN,M.current.width+q),height:Math.max(MN,M.current.height+I)})}},[]),w=j.useCallback(()=>{S.current=!1,_.current=!1,window.removeEventListener("mousemove",T)},[T]),z=j.useCallback(A=>{b(++Ju),S.current=!0,N.current={x:A.clientX-m.x,y:A.clientY-m.y},window.addEventListener("mousemove",T),window.addEventListener("mouseup",w,{once:!0})},[T,w,m.x,m.y]),D=j.useCallback(A=>{A.stopPropagation(),_.current=!0,M.current={x:A.clientX,y:A.clientY,width:y.width,height:y.height},window.addEventListener("mousemove",T),window.addEventListener("mouseup",w,{once:!0})},[T,w,y.height,y.width]);return j.useEffect(()=>()=>{window.removeEventListener("mousemove",T),window.removeEventListener("mouseup",w)},[T,w]),f.jsxs("div",{className:"draggable-panel",style:{transform:`translate(${m.x}px, ${m.y}px)`,width:`${y.width}px`,height:`${y.height}px`,zIndex:g},onMouseDown:()=>b(++Ju),children:[f.jsxs("div",{className:"draggable-panel__header",onMouseDown:z,children:[f.jsx("span",{children:a}),d?f.jsx("button",{className:"draggable-panel__close",onMouseDown:A=>A.stopPropagation(),onClick:d,"aria-label":`Chiudi ${a}`,children:"X"}):null]}),f.jsx("div",{className:"draggable-panel__content",children:c}),f.jsx("div",{className:"draggable-panel__resize",onMouseDown:D,"aria-label":`Ridimensiona ${a}`})]})},jN=()=>{const a=$(d=>d.advanceClockBy),i=$(d=>d.session?.id),l=$(d=>d.session?.clock.isRunning??!1),o=j.useRef(null),r=j.useRef(null),c=j.useRef(l);j.useEffect(()=>{c.current=l},[l]),j.useEffect(()=>{if(!i)return;const d=m=>{const p=r.current??m,y=m-p;r.current=m,c.current&&a(y,Date.now()),o.current=requestAnimationFrame(d)};return o.current=requestAnimationFrame(d),()=>{o.current!==null&&cancelAnimationFrame(o.current),o.current=null,r.current=null}},[a,i])},wN=()=>{const i=$(g=>g.session)??null,[l,o]=j.useState({root:!0}),[r,c]=j.useState([]),d=g=>o(b=>({...b,[g]:!b[g]})),m=g=>c(b=>b.includes(g)?b:[...b,g]),p=g=>c(b=>b.filter(S=>S!==g)),y=(g,b)=>!b||b==="root"?g:b.replace(/^root\./,"").split(".").reduce((S,_)=>{if(S&&typeof S=="object"&&_ in S)return S[_]},g);if(!i)return f.jsx("p",{className:"text-muted",children:"Nessuna sessione attiva."});const v=(g,b,S,_)=>{const N=typeof g=="object"&&g!==null,M=Array.isArray(g),T=N,w=l[b]??!1,z=M?`${S} [${g.length}]`:S;if(N){if(_.has(g))return f.jsx("div",{className:"debug-node",children:f.jsxs("div",{className:"debug-node__row",children:[f.jsx("button",{className:"debug-node__toggle","aria-label":"circular",disabled:!0,children:""}),f.jsx("span",{className:"debug-node__label",children:z}),f.jsx("button",{className:"debug-node__watch",onClick:()=>m(b),children:"Watch"}),f.jsx("span",{className:"text-muted",children:"[circular]"})]})},b);_.add(g)}return f.jsxs("div",{className:"debug-node",children:[f.jsxs("div",{className:"debug-node__row",children:[T?f.jsx("button",{className:"debug-node__toggle",onClick:()=>d(b),"aria-label":"toggle",children:w?"":"+"}):f.jsx("span",{className:"debug-node__spacer"}),f.jsx("span",{className:"debug-node__label",children:z}),f.jsx("button",{className:"debug-node__watch",onClick:()=>m(b),children:"Watch"}),T?null:f.jsx("span",{className:"debug-node__value",children:typeof g=="string"?`"${g}"`:String(g)})]}),T&&w?f.jsx("div",{className:"debug-node__children",children:Object.entries(g).map(([D,A])=>v(A,`${b}.${D}`,D,_))}):null]},b)};return f.jsxs("div",{className:"debug-viewer",children:[f.jsxs("div",{className:"debug-card",children:[f.jsxs("div",{className:"debug-card__header",children:[f.jsx("h4",{children:"Session JSON"}),f.jsx("span",{className:"text-muted",children:"Espandi i nodi e aggiungi watch"})]}),f.jsx("div",{className:"debug-json",children:v(i,"root","root",new WeakSet)})]}),f.jsxs("div",{className:"debug-card debug-watch",children:[f.jsxs("div",{className:"debug-card__header",children:[f.jsx("h4",{children:"Watch"}),f.jsx("span",{className:"text-muted",children:"Variabili monitorate"})]}),f.jsx("div",{className:"debug-watch__list",children:r.length===0?f.jsx("p",{className:"text-muted",children:"Nessuna variabile watchata."}):f.jsx("ul",{children:r.map(g=>f.jsxs("li",{children:[f.jsxs("div",{className:"debug-watch__row",children:[f.jsx("span",{className:"debug-watch__path",children:g}),f.jsx("button",{className:"debug-node__watch",onClick:()=>p(g),"aria-label":`Rimuovi watch ${g}`,children:"X"})]}),f.jsx("pre",{className:"debug-watch__value",children:JSON.stringify(y(i,g),null,2)})]},g))})})]})]})};const TN=a=>a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),CN=a=>a.replace(/^([A-Z])|[\s-_]+(\w)/g,(i,l,o)=>o?o.toUpperCase():l.toLowerCase()),z0=a=>{const i=CN(a);return i.charAt(0).toUpperCase()+i.slice(1)},Wg=(...a)=>a.filter((i,l,o)=>!!i&&i.trim()!==""&&o.indexOf(i)===l).join(" ").trim(),zN=a=>{for(const i in a)if(i.startsWith("aria-")||i==="role"||i==="title")return!0};var DN={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const RN=j.forwardRef(({color:a="currentColor",size:i=24,strokeWidth:l=2,absoluteStrokeWidth:o,className:r="",children:c,iconNode:d,...m},p)=>j.createElement("svg",{ref:p,...DN,width:i,height:i,stroke:a,strokeWidth:o?Number(l)*24/Number(i):l,className:Wg("lucide",r),...!c&&!zN(m)&&{"aria-hidden":"true"},...m},[...d.map(([y,v])=>j.createElement(y,v)),...Array.isArray(c)?c:[c]]));const Se=(a,i)=>{const l=j.forwardRef(({className:o,...r},c)=>j.createElement(RN,{ref:c,iconNode:i,className:Wg(`lucide-${TN(z0(a))}`,`lucide-${a}`,o),...r}));return l.displayName=z0(a),l};const AN=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],Jg=Se("activity",AN);const kN=[["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z",key:"uouzyp"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M21 21a4 4 0 0 0-3.81-4",key:"1b0z45"}],["path",{d:"M21 5a4 4 0 0 1-3.55 3.97",key:"5cxbf6"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M3 21a4 4 0 0 1 3.81-4",key:"1fjd4g"}],["path",{d:"M3 5a4 4 0 0 0 3.55 3.97",key:"1d7oge"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M9 7.13V6a3 3 0 1 1 6 0v1.13",key:"1vgav8"}]],ON=Se("bug",kN);const UN=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]],LN=Se("chart-line",UN);const BN=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]],gr=Se("circle-pause",BN);const PN=[["path",{d:"M12 6v6h4",key:"135r8i"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],IN=Se("clock-3",PN);const HN=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]],Yo=Se("crosshair",HN);const GN=[["path",{d:"M21.54 15H17a2 2 0 0 0-2 2v4.54",key:"1djwo0"}],["path",{d:"M7 3.34V5a3 3 0 0 0 3 3a2 2 0 0 1 2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2c0-1.1.9-2 2-2h3.17",key:"1tzkfa"}],["path",{d:"M11 21.95V18a2 2 0 0 0-2-2a2 2 0 0 1-2-2v-1a2 2 0 0 0-2-2H2.05",key:"14pb5j"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],qN=Se("earth",GN);const YN=[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]],VN=Se("flag",YN);const XN=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],Id=Se("flask-conical",XN);const QN=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],ZN=Se("gauge",QN);const FN=[["path",{d:"m11 17 2 2a1 1 0 1 0 3-3",key:"efffak"}],["path",{d:"m14 14 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-3-3l2.81-2.81a5.79 5.79 0 0 1 7.06-.87l.47.28a2 2 0 0 0 1.42.25L21 4",key:"9pr0kb"}],["path",{d:"m21 3 1 11h-2",key:"1tisrp"}],["path",{d:"M3 3 2 14l6.5 6.5a1 1 0 1 0 3-3",key:"1uvwmv"}],["path",{d:"M3 4h8",key:"1ep09j"}]],KN=Se("handshake",FN);const $N=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Vo=Se("info",$N);const WN=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],JN=Se("log-out",WN);const eE=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],tE=Se("map-pin",eE);const aE=[["path",{d:"M20.341 6.484A10 10 0 0 1 10.266 21.85",key:"1enhxb"}],["path",{d:"M3.659 17.516A10 10 0 0 1 13.74 2.152",key:"1crzgf"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["circle",{cx:"19",cy:"5",r:"2",key:"mhkx31"}],["circle",{cx:"5",cy:"19",r:"2",key:"v8kfzx"}]],nE=Se("orbit",aE);const iE=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],sE=Se("pause",iE);const lE=[["path",{d:"m14 13-8.381 8.38a1 1 0 0 1-3.001-3L11 9.999",key:"1lw9ds"}],["path",{d:"M15.973 4.027A13 13 0 0 0 5.902 2.373c-1.398.342-1.092 2.158.277 2.601a19.9 19.9 0 0 1 5.822 3.024",key:"ffj4ej"}],["path",{d:"M16.001 11.999a19.9 19.9 0 0 1 3.024 5.824c.444 1.369 2.26 1.676 2.603.278A13 13 0 0 0 20 8.069",key:"8tj4zw"}],["path",{d:"M18.352 3.352a1.205 1.205 0 0 0-1.704 0l-5.296 5.296a1.205 1.205 0 0 0 0 1.704l2.296 2.296a1.205 1.205 0 0 0 1.704 0l5.296-5.296a1.205 1.205 0 0 0 0-1.704z",key:"hh6h97"}]],oE=Se("pickaxe",lE);const rE=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],cE=Se("play",rE);const uE=[["path",{d:"M19.07 4.93A10 10 0 0 0 6.99 3.34",key:"z3du51"}],["path",{d:"M4 6h.01",key:"oypzma"}],["path",{d:"M2.29 9.62A10 10 0 1 0 21.31 8.35",key:"qzzz0"}],["path",{d:"M16.24 7.76A6 6 0 1 0 8.23 16.67",key:"1yjesh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M17.99 11.66A6 6 0 0 1 15.77 16.67",key:"1u2y91"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"m13.41 10.59 5.66-5.66",key:"mhq4k0"}]],dE=Se("radar",uE);const fE=[["path",{d:"m2.37 11.223 8.372-6.777a2 2 0 0 1 2.516 0l8.371 6.777",key:"f1wd0e"}],["path",{d:"M21 15a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-5.25",key:"1pfu07"}],["path",{d:"M3 15a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h9",key:"1oq9qw"}],["path",{d:"m6.67 15 6.13 4.6a2 2 0 0 0 2.8-.4l3.15-4.2",key:"1fnwu5"}],["rect",{width:"20",height:"4",x:"2",y:"11",rx:"1",key:"itshg"}]],hE=Se("sandwich",fE);const mE=[["path",{d:"M4 10a7.31 7.31 0 0 0 10 10Z",key:"1fzpp3"}],["path",{d:"m9 15 3-3",key:"88sc13"}],["path",{d:"M17 13a6 6 0 0 0-6-6",key:"15cc6u"}],["path",{d:"M21 13A10 10 0 0 0 11 3",key:"11nf8s"}]],pE=Se("satellite-dish",mE);const gE=[["path",{d:"m13.5 6.5-3.148-3.148a1.205 1.205 0 0 0-1.704 0L6.352 5.648a1.205 1.205 0 0 0 0 1.704L9.5 10.5",key:"dzhfyz"}],["path",{d:"M16.5 7.5 19 5",key:"1ltcjm"}],["path",{d:"m17.5 10.5 3.148 3.148a1.205 1.205 0 0 1 0 1.704l-2.296 2.296a1.205 1.205 0 0 1-1.704 0L13.5 14.5",key:"nfoymv"}],["path",{d:"M9 21a6 6 0 0 0-6-6",key:"1iajcf"}],["path",{d:"M9.352 10.648a1.205 1.205 0 0 0 0 1.704l2.296 2.296a1.205 1.205 0 0 0 1.704 0l4.296-4.296a1.205 1.205 0 0 0 0-1.704l-2.296-2.296a1.205 1.205 0 0 0-1.704 0z",key:"nv9zqy"}]],yE=Se("satellite",gE);const vE=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],bE=Se("save",vE);const xE=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["path",{d:"M18.944 12.33a1 1 0 0 0 0-.66 7.5 7.5 0 0 0-13.888 0 1 1 0 0 0 0 .66 7.5 7.5 0 0 0 13.888 0",key:"11ak4c"}]],SE=Se("scan-eye",xE);const _E=[["path",{d:"M15 12h-5",key:"r7krc0"}],["path",{d:"M15 8h-5",key:"1khuty"}],["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]],NE=Se("scroll-text",_E);const EE=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 22V2",key:"zs6s6o"}]],ME=Se("shield-half",EE);const jE=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],wE=Se("sparkles",jE);const TE=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],CE=Se("star",TE);const zE=[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5",key:"hbey2j"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18",key:"1hf58s"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20",key:"pidxm4"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21",key:"1pehsh"}]],ey=Se("swords",zE);const DE=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Hd=Se("target",DE);const RE=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],AE=Se("upload",RE);const kE=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],OE=Se("zap",kE),UE=({onToggleDebug:a,debugOpen:i,onShowWars:l,warUnread:o=0})=>{const[r,c]=j.useState(null),d=$(_=>_.session),m=$(_=>_.returnToMenu),p=$(_=>_.saveSession),y=$(_=>_.loadSession),v=$(_=>_.hasSavedSession),g=j.useMemo(()=>{const _=d?.research.currentEra??1,N=Dg.research.eras.find(M=>M.id===_)?.label??`Era ${_}`;return{currentEra:_,eraLabel:N}},[d]),b=j.useMemo(()=>{if(!d)return null;const{galaxy:_,scienceShips:N,empires:M}=d,T=_.systems.filter(A=>A.visibility!=="unknown").length,w=_.systems.filter(A=>A.visibility==="surveyed").length,z=_.systems.filter(A=>A.ownerId==="player").length,D=M.filter(A=>A.kind==="ai"&&A.warStatus==="war");return[{icon:qN,label:"Sistemi",desc:"Totale sistemi generati",value:_.systems.length},{icon:SE,label:"Rivelati",desc:"Sistemi rivelati",value:`${T}/${_.systems.length}`},{icon:yE,label:"Sondati",desc:"Sistemi sondati",value:`${w}/${_.systems.length}`},{icon:ME,label:"Controllati",desc:"Sistemi controllati",value:z},{icon:Id,label:"Navi scientifiche",desc:"Flotta di ricerca",value:N.length},{icon:ey,label:"Guerre",desc:"Conflitti attivi",value:D.length}]},[d]);if(!d||!b)return null;const S=[{icon:bE,label:"Salva",desc:"Salva la sessione",onClick:()=>{const _=p();c(_.success?"Partita salvata.":"Salvataggio non riuscito.")},disabled:!1},{icon:AE,label:"Carica",desc:"Carica salvataggio",onClick:()=>{const _=y();c(_.success?"Partita caricata.":"Caricamento non riuscito.")},disabled:!v()},{icon:ON,label:"Debug",desc:i?"Nascondi debug":"Apri debug",onClick:a,disabled:!1},{icon:JN,label:"Esci",desc:"Torna al menu",onClick:m,disabled:!1}];return f.jsxs("div",{className:"hud-bottom-bar",children:[f.jsx("div",{className:"hud-bottom-bar__stats",children:b.map(({icon:_,label:N,desc:M,value:T})=>f.jsxs("div",{className:"hud-stat","data-tooltip":`${N}: ${M}`,children:[f.jsx(_,{size:16}),f.jsx("div",{className:"hud-stat__value",children:T})]},N))}),f.jsx("div",{className:"hud-bottom-bar__era",children:f.jsx("div",{className:"hud-era-pill","data-tooltip":`Era corrente: ${g.eraLabel}`,children:f.jsx("span",{className:"hud-era-pill__value",children:g.eraLabel})})}),f.jsxs("div",{className:"hud-bottom-bar__actions",children:[S.map(({icon:_,label:N,desc:M,onClick:T,disabled:w})=>f.jsx("button",{className:"hud-icon-btn",onClick:T,disabled:w,"data-tooltip":`${N} - ${M}`,"aria-label":N,children:f.jsx(_,{size:16})},N)),r?f.jsx("span",{className:"text-muted",children:r}):null,l&&o>0?f.jsx("span",{className:"hud-war-chip hud-war-chip--alert",title:"Eventi guerra non letti",children:o}):null]})]})},pl={energy:"Energia",minerals:"Minerali",food:"Cibo",research:"Ricerca",influence:"Influenza"},LE={energy:f.jsx(OE,{size:16}),minerals:f.jsx(oE,{size:16}),food:f.jsx(hE,{size:16}),research:f.jsx(Id,{size:16}),influence:f.jsx(CE,{size:16})},BE={energy:"Energia accumulata e produzione per tick.",minerals:"Minerali disponibili e produzione per tick.",food:"Cibo disponibile e produzione per tick.",research:"Punti ricerca e produzione per tick.",influence:"Influenza accumulata e produzione per tick."},PE=()=>{const a=$(i=>i.session?.economy.resources);return a?f.jsx("div",{className:"resource-bar",children:gt.map(i=>{const l=a[i],o=l.income-l.upkeep,r=o>0?"is-positive":o<0?"is-negative":"is-zero",c=o>0?"+":o<0?"-":"0";return f.jsxs("div",{className:"resource-chip","data-tooltip":`${pl[i]}: ${BE[i]??""}`,children:[f.jsx("div",{className:"resource-chip__icon",children:LE[i]??null}),f.jsxs("div",{className:"resource-chip__meta",children:[f.jsx("span",{className:"resource-chip__label",children:pl[i]}),f.jsxs("div",{className:"resource-chip__values",children:[f.jsx("span",{className:"resource-chip__value",children:l.amount.toFixed(0)}),f.jsxs("span",{className:`resource-chip__delta ${r}`,children:[c,Math.abs(o).toFixed(1)]})]})]})]},i)})}):null},IE=[.5,1,2,4],D0=()=>{const a=$(d=>d.session),i=$(d=>d.setSimulationRunning),l=$(d=>d.setSpeedMultiplier);if(!a)return null;const{clock:o}=a,r=o.isRunning?Jg:gr,c=o.isRunning?"Running":"Paused";return f.jsxs("div",{className:"hud-top-bar",children:[f.jsx("div",{className:"hud-top-bar__left",children:f.jsx(PE,{})}),f.jsxs("div",{className:"hud-top-bar__right",children:[f.jsxs("div",{className:"hud-top-bar__meta",children:[f.jsxs("div",{className:"hud-chip","data-tooltip":"Tick di simulazione",children:[f.jsx(IN,{size:14}),f.jsx("span",{children:o.tick})]}),f.jsxs("div",{className:"hud-chip","data-tooltip":o.isRunning?"Simulazione in esecuzione":"Simulazione in pausa",children:[f.jsx(r,{size:14}),f.jsx("span",{children:c})]})]}),f.jsxs("div",{className:"hud-top-bar__controls",children:[f.jsx("button",{className:"hud-icon-btn",onClick:()=>i(!o.isRunning,Date.now()),"data-tooltip":o.isRunning?"Pausa simulazione":"Riprendi simulazione","aria-label":"Toggle pausa",children:o.isRunning?f.jsx(sE,{size:16}):f.jsx(cE,{size:16})}),f.jsx("div",{className:"speed-options",children:IE.map(d=>f.jsxs("button",{className:`hud-icon-btn ${d===o.speedMultiplier?"is-active":""}`,onClick:()=>l(d),"data-tooltip":`Velocit ${d}x`,"aria-label":`Velocit ${d}x`,children:[f.jsx(ZN,{size:14}),f.jsxs("span",{className:"speed-label",children:[d,"x"]})]},d))})]})]})]})},HE=a=>{const i=Math.min(80,a*.05),l=Math.max(3,i),o=Math.max(220,a*1.5);return{minZoom:l,maxZoom:o}},GE=a=>a.map(i=>`${i.id}:${i.systemId}:${i.targetSystemId??""}:${i.anchorPlanetId??""}:${i.ticksToArrival??0}`).join("|"),qE=({systems:a,galaxyShape:i,galaxySeed:l,fleetSignature:o})=>`${i}:${l}|`+a.map(r=>`${r.id}:${r.visibility}:${r.ownerId??""}:${r.hostilePower??0}:${r.orbitingPlanets.length}:${r.hasShipyard?1:0}:${r.shipyardAnchorPlanetId??""}:${r.shipyardBuild?r.shipyardBuild.ticksRemaining:0}`).join("|")+`|F:${o}`,YE=()=>{const a=$(D=>D.session?.galaxy.systems??[]),i=$(D=>D.session?.economy.planets??[]),l=$(D=>D.session?.scienceShips??[]),o=$(D=>D.session?.fleets??[]),r=$(D=>D.config.military.shipDesigns),c=$(D=>D.session?.galaxy.galaxyShape??"circle"),d=$(D=>D.session?.galaxy.seed??"default"),m=$(D=>D.config.starVisuals),p=$(D=>D.session?.empires.some(A=>A.kind==="ai"&&A.warStatus==="war")??!1),y=$(D=>D.config.map.orbitSpeed),v=$(D=>D.session?.combatReports??[]),g=j.useMemo(()=>new Set(v.slice(-3).map(D=>D.systemId)),[v]),b=j.useMemo(()=>{const D=new Set(a.filter(q=>(q.hostilePower??0)>0).map(q=>q.id)),A=o.filter(q=>D.has(q.systemId)&&q.targetSystemId===null).map(q=>q.systemId);return new Set(A)},[o,a]),S=j.useMemo(()=>{const D=new Map;return i.forEach(A=>{A.systemId&&D.set(A.systemId,{id:A.id,name:A.name})}),D},[i]),_=j.useMemo(()=>a.length?a.reduce((D,A)=>{const q=A.mapPosition??A.position,I=Math.sqrt(q.x*q.x+q.y*q.y);return Math.max(D,I)},0):400,[a]),{minZoom:N,maxZoom:M}=j.useMemo(()=>HE(_),[_]),T=j.useMemo(()=>GE(o),[o]),w=j.useMemo(()=>new Map(r.map(D=>[D.id,D])),[r]),z=j.useMemo(()=>qE({systems:a,galaxyShape:c,galaxySeed:d,fleetSignature:T}),[a,c,d,T]);return{systems:a,scienceShips:l,fleets:o,shipDesignLookup:w,galaxyShape:c,galaxySeed:d,starVisuals:m,empireWar:p,recentCombatSystems:g,activeBattles:b,orbitBaseSpeed:y,colonizedLookup:S,maxSystemRadius:_,minZoom:N,maxZoom:M,systemsSignature:z}},ty=j.createContext(null),VE=({value:a,children:i})=>f.jsx(ty.Provider,{value:a,children:i}),$i=()=>{const a=j.useContext(ty);if(!a)throw new Error("GalaxyMapContext not found");return a},vd=(a,i)=>{const l=[],o=[],r=()=>l.pop()??new Ne,c=v=>{v.set(0,0,0),l.push(v)},d=()=>o.pop()??new N1,m=v=>{v.identity(),o.push(v)},p=(v,g)=>{const b=a.get(v.systemId);if(!b)return null;if(v.planetId){const _=i.get(v.planetId);if(_){const N=r();return _.getWorldPosition(N),g.worldToLocal(N),N.z+=v.height,N}}const S=r().copy(b);return S.z+=v.height,S};return{getVector:r,releaseVector:c,getMatrix:d,releaseMatrix:m,updateAnchors:(v,g)=>{g.forEach(b=>{const S=p(b,v);if(S){if(b.mesh&&typeof b.index=="number"){const _=d().setPosition(S.x,S.y,S.z);b.mesh.setMatrixAt(b.index,_),b.mesh.instanceMatrix.needsUpdate=!0,m(_)}else b.object&&b.object.position.set(S.x,S.y,S.z);c(S)}})}}},XE=()=>{const a=j.useRef(null),i=j.useRef(null),l=j.useRef(null),o=j.useRef(new Ne(0,0,0)),r=j.useRef(170),c=j.useRef(!1),d=j.useRef({current:Math.PI/2,target:Math.PI/2}),m=j.useRef(new id),p=j.useRef(new Ne),y=j.useRef(new Map),v=j.useRef([]),g=j.useRef([]),b=j.useRef(new Map),S=j.useRef(new Map),_=j.useRef(""),N=j.useRef(null),M=j.useRef(null),T=j.useRef(null);return{containerRef:a,systemGroupRef:i,cameraRef:l,offsetTargetRef:o,zoomTargetRef:r,zoomTargetDirtyRef:c,tiltStateRef:d,tempSphericalRef:m,tempOffsetRef:p,systemPositionRef:y,scienceAnchorsRef:v,fleetAnchorsRef:g,planetAngleRef:b,planetLookupRef:S,systemsSignatureRef:_,blackHoleRef:N,nebulaRef:M,anchorResolverRef:T,cameraState:{systemGroupRef:i,cameraRef:l,offsetTargetRef:o,zoomTargetRef:r,zoomTargetDirtyRef:c,tiltStateRef:d,tempSphericalRef:m,tempOffsetRef:p},anchorState:{systemPositionRef:y,scienceAnchorsRef:v,fleetAnchorsRef:g,planetAngleRef:b,planetLookupRef:S,systemsSignatureRef:_,blackHoleRef:N,nebulaRef:M,anchorResolverRef:T},syncSceneContext:A=>{A&&(l.current=A.camera,i.current=A.systemGroup)}}},R0={type:"change"},Gd={type:"start"},ay={type:"end"},Xo=new M1,A0=new j1,QE=Math.cos(70*ol.DEG2RAD),$e=new Ne,wt=2*Math.PI,De={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},ed=1e-6;class ZE extends E1{constructor(i,l=null){super(i,l),this.state=De.NONE,this.target=new Ne,this.cursor=new Ne,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:La.ROTATE,MIDDLE:La.DOLLY,RIGHT:La.PAN},this.touches={ONE:Ii.ROTATE,TWO:Ii.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new Ne,this._lastQuaternion=new Bp,this._lastTargetPosition=new Ne,this._quat=new Bp().setFromUnitVectors(i.up,new Ne(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new id,this._sphericalDelta=new id,this._scale=1,this._panOffset=new Ne,this._rotateStart=new Pe,this._rotateEnd=new Pe,this._rotateDelta=new Pe,this._panStart=new Pe,this._panEnd=new Pe,this._panDelta=new Pe,this._dollyStart=new Pe,this._dollyEnd=new Pe,this._dollyDelta=new Pe,this._dollyDirection=new Ne,this._mouse=new Pe,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=KE.bind(this),this._onPointerDown=FE.bind(this),this._onPointerUp=$E.bind(this),this._onContextMenu=iM.bind(this),this._onMouseWheel=eM.bind(this),this._onKeyDown=tM.bind(this),this._onTouchStart=aM.bind(this),this._onTouchMove=nM.bind(this),this._onMouseDown=WE.bind(this),this._onMouseMove=JE.bind(this),this._interceptControlDown=sM.bind(this),this._interceptControlUp=lM.bind(this),this.domElement!==null&&this.connect(this.domElement),this.update()}connect(i){super.connect(i),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(i){i.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=i}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(R0),this.update(),this.state=De.NONE}update(i=null){const l=this.object.position;$e.copy(l).sub(this.target),$e.applyQuaternion(this._quat),this._spherical.setFromVector3($e),this.autoRotate&&this.state===De.NONE&&this._rotateLeft(this._getAutoRotationAngle(i)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let o=this.minAzimuthAngle,r=this.maxAzimuthAngle;isFinite(o)&&isFinite(r)&&(o<-Math.PI?o+=wt:o>Math.PI&&(o-=wt),r<-Math.PI?r+=wt:r>Math.PI&&(r-=wt),o<=r?this._spherical.theta=Math.max(o,Math.min(r,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(o+r)/2?Math.max(o,this._spherical.theta):Math.min(r,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let c=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const d=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),c=d!=this._spherical.radius}if($e.setFromSpherical(this._spherical),$e.applyQuaternion(this._quatInverse),l.copy(this.target).add($e),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let d=null;if(this.object.isPerspectiveCamera){const m=$e.length();d=this._clampDistance(m*this._scale);const p=m-d;this.object.position.addScaledVector(this._dollyDirection,p),this.object.updateMatrixWorld(),c=!!p}else if(this.object.isOrthographicCamera){const m=new Ne(this._mouse.x,this._mouse.y,0);m.unproject(this.object);const p=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),c=p!==this.object.zoom;const y=new Ne(this._mouse.x,this._mouse.y,0);y.unproject(this.object),this.object.position.sub(y).add(m),this.object.updateMatrixWorld(),d=$e.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;d!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(d).add(this.object.position):(Xo.origin.copy(this.object.position),Xo.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(Xo.direction))<QE?this.object.lookAt(this.target):(A0.setFromNormalAndCoplanarPoint(this.object.up,this.target),Xo.intersectPlane(A0,this.target))))}else if(this.object.isOrthographicCamera){const d=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),d!==this.object.zoom&&(this.object.updateProjectionMatrix(),c=!0)}return this._scale=1,this._performCursorZoom=!1,c||this._lastPosition.distanceToSquared(this.object.position)>ed||8*(1-this._lastQuaternion.dot(this.object.quaternion))>ed||this._lastTargetPosition.distanceToSquared(this.target)>ed?(this.dispatchEvent(R0),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(i){return i!==null?wt/60*this.autoRotateSpeed*i:wt/60/60*this.autoRotateSpeed}_getZoomScale(i){const l=Math.abs(i*.01);return Math.pow(.95,this.zoomSpeed*l)}_rotateLeft(i){this._sphericalDelta.theta-=i}_rotateUp(i){this._sphericalDelta.phi-=i}_panLeft(i,l){$e.setFromMatrixColumn(l,0),$e.multiplyScalar(-i),this._panOffset.add($e)}_panUp(i,l){this.screenSpacePanning===!0?$e.setFromMatrixColumn(l,1):($e.setFromMatrixColumn(l,0),$e.crossVectors(this.object.up,$e)),$e.multiplyScalar(i),this._panOffset.add($e)}_pan(i,l){const o=this.domElement;if(this.object.isPerspectiveCamera){const r=this.object.position;$e.copy(r).sub(this.target);let c=$e.length();c*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*i*c/o.clientHeight,this.object.matrix),this._panUp(2*l*c/o.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(i*(this.object.right-this.object.left)/this.object.zoom/o.clientWidth,this.object.matrix),this._panUp(l*(this.object.top-this.object.bottom)/this.object.zoom/o.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(i){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=i:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(i){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=i:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(i,l){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const o=this.domElement.getBoundingClientRect(),r=i-o.left,c=l-o.top,d=o.width,m=o.height;this._mouse.x=r/d*2-1,this._mouse.y=-(c/m)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(i){return Math.max(this.minDistance,Math.min(this.maxDistance,i))}_handleMouseDownRotate(i){this._rotateStart.set(i.clientX,i.clientY)}_handleMouseDownDolly(i){this._updateZoomParameters(i.clientX,i.clientX),this._dollyStart.set(i.clientX,i.clientY)}_handleMouseDownPan(i){this._panStart.set(i.clientX,i.clientY)}_handleMouseMoveRotate(i){this._rotateEnd.set(i.clientX,i.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const l=this.domElement;this._rotateLeft(wt*this._rotateDelta.x/l.clientHeight),this._rotateUp(wt*this._rotateDelta.y/l.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(i){this._dollyEnd.set(i.clientX,i.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(i){this._panEnd.set(i.clientX,i.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(i){this._updateZoomParameters(i.clientX,i.clientY),i.deltaY<0?this._dollyIn(this._getZoomScale(i.deltaY)):i.deltaY>0&&this._dollyOut(this._getZoomScale(i.deltaY)),this.update()}_handleKeyDown(i){let l=!1;switch(i.code){case this.keys.UP:i.ctrlKey||i.metaKey||i.shiftKey?this.enableRotate&&this._rotateUp(wt*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),l=!0;break;case this.keys.BOTTOM:i.ctrlKey||i.metaKey||i.shiftKey?this.enableRotate&&this._rotateUp(-wt*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),l=!0;break;case this.keys.LEFT:i.ctrlKey||i.metaKey||i.shiftKey?this.enableRotate&&this._rotateLeft(wt*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),l=!0;break;case this.keys.RIGHT:i.ctrlKey||i.metaKey||i.shiftKey?this.enableRotate&&this._rotateLeft(-wt*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),l=!0;break}l&&(i.preventDefault(),this.update())}_handleTouchStartRotate(i){if(this._pointers.length===1)this._rotateStart.set(i.pageX,i.pageY);else{const l=this._getSecondPointerPosition(i),o=.5*(i.pageX+l.x),r=.5*(i.pageY+l.y);this._rotateStart.set(o,r)}}_handleTouchStartPan(i){if(this._pointers.length===1)this._panStart.set(i.pageX,i.pageY);else{const l=this._getSecondPointerPosition(i),o=.5*(i.pageX+l.x),r=.5*(i.pageY+l.y);this._panStart.set(o,r)}}_handleTouchStartDolly(i){const l=this._getSecondPointerPosition(i),o=i.pageX-l.x,r=i.pageY-l.y,c=Math.sqrt(o*o+r*r);this._dollyStart.set(0,c)}_handleTouchStartDollyPan(i){this.enableZoom&&this._handleTouchStartDolly(i),this.enablePan&&this._handleTouchStartPan(i)}_handleTouchStartDollyRotate(i){this.enableZoom&&this._handleTouchStartDolly(i),this.enableRotate&&this._handleTouchStartRotate(i)}_handleTouchMoveRotate(i){if(this._pointers.length==1)this._rotateEnd.set(i.pageX,i.pageY);else{const o=this._getSecondPointerPosition(i),r=.5*(i.pageX+o.x),c=.5*(i.pageY+o.y);this._rotateEnd.set(r,c)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const l=this.domElement;this._rotateLeft(wt*this._rotateDelta.x/l.clientHeight),this._rotateUp(wt*this._rotateDelta.y/l.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(i){if(this._pointers.length===1)this._panEnd.set(i.pageX,i.pageY);else{const l=this._getSecondPointerPosition(i),o=.5*(i.pageX+l.x),r=.5*(i.pageY+l.y);this._panEnd.set(o,r)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(i){const l=this._getSecondPointerPosition(i),o=i.pageX-l.x,r=i.pageY-l.y,c=Math.sqrt(o*o+r*r);this._dollyEnd.set(0,c),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const d=(i.pageX+l.x)*.5,m=(i.pageY+l.y)*.5;this._updateZoomParameters(d,m)}_handleTouchMoveDollyPan(i){this.enableZoom&&this._handleTouchMoveDolly(i),this.enablePan&&this._handleTouchMovePan(i)}_handleTouchMoveDollyRotate(i){this.enableZoom&&this._handleTouchMoveDolly(i),this.enableRotate&&this._handleTouchMoveRotate(i)}_addPointer(i){this._pointers.push(i.pointerId)}_removePointer(i){delete this._pointerPositions[i.pointerId];for(let l=0;l<this._pointers.length;l++)if(this._pointers[l]==i.pointerId){this._pointers.splice(l,1);return}}_isTrackingPointer(i){for(let l=0;l<this._pointers.length;l++)if(this._pointers[l]==i.pointerId)return!0;return!1}_trackPointer(i){let l=this._pointerPositions[i.pointerId];l===void 0&&(l=new Pe,this._pointerPositions[i.pointerId]=l),l.set(i.pageX,i.pageY)}_getSecondPointerPosition(i){const l=i.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[l]}_customWheelEvent(i){const l=i.deltaMode,o={clientX:i.clientX,clientY:i.clientY,deltaY:i.deltaY};switch(l){case 1:o.deltaY*=16;break;case 2:o.deltaY*=100;break}return i.ctrlKey&&!this._controlActive&&(o.deltaY*=10),o}}function FE(a){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(a.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(a)&&(this._addPointer(a),a.pointerType==="touch"?this._onTouchStart(a):this._onMouseDown(a)))}function KE(a){this.enabled!==!1&&(a.pointerType==="touch"?this._onTouchMove(a):this._onMouseMove(a))}function $E(a){switch(this._removePointer(a),this._pointers.length){case 0:this.domElement.releasePointerCapture(a.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(ay),this.state=De.NONE;break;case 1:const i=this._pointers[0],l=this._pointerPositions[i];this._onTouchStart({pointerId:i,pageX:l.x,pageY:l.y});break}}function WE(a){let i;switch(a.button){case 0:i=this.mouseButtons.LEFT;break;case 1:i=this.mouseButtons.MIDDLE;break;case 2:i=this.mouseButtons.RIGHT;break;default:i=-1}switch(i){case La.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(a),this.state=De.DOLLY;break;case La.ROTATE:if(a.ctrlKey||a.metaKey||a.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(a),this.state=De.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(a),this.state=De.ROTATE}break;case La.PAN:if(a.ctrlKey||a.metaKey||a.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(a),this.state=De.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(a),this.state=De.PAN}break;default:this.state=De.NONE}this.state!==De.NONE&&this.dispatchEvent(Gd)}function JE(a){switch(this.state){case De.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(a);break;case De.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(a);break;case De.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(a);break}}function eM(a){this.enabled===!1||this.enableZoom===!1||this.state!==De.NONE||(a.preventDefault(),this.dispatchEvent(Gd),this._handleMouseWheel(this._customWheelEvent(a)),this.dispatchEvent(ay))}function tM(a){this.enabled!==!1&&this._handleKeyDown(a)}function aM(a){switch(this._trackPointer(a),this._pointers.length){case 1:switch(this.touches.ONE){case Ii.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(a),this.state=De.TOUCH_ROTATE;break;case Ii.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(a),this.state=De.TOUCH_PAN;break;default:this.state=De.NONE}break;case 2:switch(this.touches.TWO){case Ii.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(a),this.state=De.TOUCH_DOLLY_PAN;break;case Ii.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(a),this.state=De.TOUCH_DOLLY_ROTATE;break;default:this.state=De.NONE}break;default:this.state=De.NONE}this.state!==De.NONE&&this.dispatchEvent(Gd)}function nM(a){switch(this._trackPointer(a),this.state){case De.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(a),this.update();break;case De.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(a),this.update();break;case De.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(a),this.update();break;case De.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(a),this.update();break;default:this.state=De.NONE}}function iM(a){this.enabled!==!1&&a.preventDefault()}function sM(a){a.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function lM(a){a.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}const er={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = opacity * texel;


		}`};class Sl{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const oM=new w1(-1,1,1,-1,0,1);class rM extends Hn{constructor(){super(),this.setAttribute("position",new dt([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new dt([0,2,0,0,2,0],2))}}const cM=new rM;class ny{constructor(i){this._mesh=new qe(cM,i)}dispose(){this._mesh.geometry.dispose()}render(i){i.render(this._mesh,oM)}get material(){return this._mesh.material}set material(i){this._mesh.material=i}}class uM extends Sl{constructor(i,l="tDiffuse"){super(),this.textureID=l,this.uniforms=null,this.material=null,i instanceof Kt?(this.uniforms=i.uniforms,this.material=i):i&&(this.uniforms=sd.clone(i.uniforms),this.material=new Kt({name:i.name!==void 0?i.name:"unspecified",defines:Object.assign({},i.defines),uniforms:this.uniforms,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader})),this._fsQuad=new ny(this.material)}render(i,l,o){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=o.texture),this._fsQuad.material=this.material,this.renderToScreen?(i.setRenderTarget(null),this._fsQuad.render(i)):(i.setRenderTarget(l),this.clear&&i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil),this._fsQuad.render(i))}dispose(){this.material.dispose(),this._fsQuad.dispose()}}class k0 extends Sl{constructor(i,l){super(),this.scene=i,this.camera=l,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(i,l,o){const r=i.getContext(),c=i.state;c.buffers.color.setMask(!1),c.buffers.depth.setMask(!1),c.buffers.color.setLocked(!0),c.buffers.depth.setLocked(!0);let d,m;this.inverse?(d=0,m=1):(d=1,m=0),c.buffers.stencil.setTest(!0),c.buffers.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),c.buffers.stencil.setFunc(r.ALWAYS,d,4294967295),c.buffers.stencil.setClear(m),c.buffers.stencil.setLocked(!0),i.setRenderTarget(o),this.clear&&i.clear(),i.render(this.scene,this.camera),i.setRenderTarget(l),this.clear&&i.clear(),i.render(this.scene,this.camera),c.buffers.color.setLocked(!1),c.buffers.depth.setLocked(!1),c.buffers.color.setMask(!0),c.buffers.depth.setMask(!0),c.buffers.stencil.setLocked(!1),c.buffers.stencil.setFunc(r.EQUAL,1,4294967295),c.buffers.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),c.buffers.stencil.setLocked(!0)}}class dM extends Sl{constructor(){super(),this.needsSwap=!1}render(i){i.state.buffers.stencil.setLocked(!1),i.state.buffers.stencil.setTest(!1)}}class fM{constructor(i,l){if(this.renderer=i,this._pixelRatio=i.getPixelRatio(),l===void 0){const o=i.getSize(new Pe);this._width=o.width,this._height=o.height,l=new Fo(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:Ko}),l.texture.name="EffectComposer.rt1"}else this._width=l.width,this._height=l.height;this.renderTarget1=l,this.renderTarget2=l.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new uM(er),this.copyPass.material.blending=T1,this.clock=new $0}swapBuffers(){const i=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=i}addPass(i){this.passes.push(i),i.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(i,l){this.passes.splice(l,0,i),i.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(i){const l=this.passes.indexOf(i);l!==-1&&this.passes.splice(l,1)}isLastEnabledPass(i){for(let l=i+1;l<this.passes.length;l++)if(this.passes[l].enabled)return!1;return!0}render(i){i===void 0&&(i=this.clock.getDelta());const l=this.renderer.getRenderTarget();let o=!1;for(let r=0,c=this.passes.length;r<c;r++){const d=this.passes[r];if(d.enabled!==!1){if(d.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(r),d.render(this.renderer,this.writeBuffer,this.readBuffer,i,o),d.needsSwap){if(o){const m=this.renderer.getContext(),p=this.renderer.state.buffers.stencil;p.setFunc(m.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,i),p.setFunc(m.EQUAL,1,4294967295)}this.swapBuffers()}k0!==void 0&&(d instanceof k0?o=!0:d instanceof dM&&(o=!1))}}this.renderer.setRenderTarget(l)}reset(i){if(i===void 0){const l=this.renderer.getSize(new Pe);this._pixelRatio=this.renderer.getPixelRatio(),this._width=l.width,this._height=l.height,i=this.renderTarget1.clone(),i.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=i,this.renderTarget2=i.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(i,l){this._width=i,this._height=l;const o=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(o,r),this.renderTarget2.setSize(o,r);for(let c=0;c<this.passes.length;c++)this.passes[c].setSize(o,r)}setPixelRatio(i){this._pixelRatio=i,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class hM extends Sl{constructor(i,l,o=null,r=null,c=null){super(),this.scene=i,this.camera=l,this.overrideMaterial=o,this.clearColor=r,this.clearAlpha=c,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new $t}render(i,l,o){const r=i.autoClear;i.autoClear=!1;let c,d;this.overrideMaterial!==null&&(d=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor!==null&&(i.getClearColor(this._oldClearColor),i.setClearColor(this.clearColor,i.getClearAlpha())),this.clearAlpha!==null&&(c=i.getClearAlpha(),i.setClearAlpha(this.clearAlpha)),this.clearDepth==!0&&i.clearDepth(),i.setRenderTarget(this.renderToScreen?null:o),this.clear===!0&&i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil),i.render(this.scene,this.camera),this.clearColor!==null&&i.setClearColor(this._oldClearColor),this.clearAlpha!==null&&i.setClearAlpha(c),this.overrideMaterial!==null&&(this.scene.overrideMaterial=d),i.autoClear=r}}const mM={uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new $t(0)},defaultOpacity:{value:0}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform vec3 defaultColor;
		uniform float defaultOpacity;
		uniform float luminosityThreshold;
		uniform float smoothWidth;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );

			float v = luminance( texel.xyz );

			vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );

			float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );

			gl_FragColor = mix( outputColor, texel, alpha );

		}`};class Vi extends Sl{constructor(i,l=1,o,r){super(),this.strength=l,this.radius=o,this.threshold=r,this.resolution=i!==void 0?new Pe(i.x,i.y):new Pe(256,256),this.clearColor=new $t(0,0,0),this.needsSwap=!1,this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let c=Math.round(this.resolution.x/2),d=Math.round(this.resolution.y/2);this.renderTargetBright=new Fo(c,d,{type:Ko}),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let v=0;v<this.nMips;v++){const g=new Fo(c,d,{type:Ko});g.texture.name="UnrealBloomPass.h"+v,g.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(g);const b=new Fo(c,d,{type:Ko});b.texture.name="UnrealBloomPass.v"+v,b.texture.generateMipmaps=!1,this.renderTargetsVertical.push(b),c=Math.round(c/2),d=Math.round(d/2)}const m=mM;this.highPassUniforms=sd.clone(m.uniforms),this.highPassUniforms.luminosityThreshold.value=r,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new Kt({uniforms:this.highPassUniforms,vertexShader:m.vertexShader,fragmentShader:m.fragmentShader}),this.separableBlurMaterials=[];const p=[6,10,14,18,22];c=Math.round(this.resolution.x/2),d=Math.round(this.resolution.y/2);for(let v=0;v<this.nMips;v++)this.separableBlurMaterials.push(this._getSeparableBlurMaterial(p[v])),this.separableBlurMaterials[v].uniforms.invSize.value=new Pe(1/c,1/d),c=Math.round(c/2),d=Math.round(d/2);this.compositeMaterial=this._getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=l,this.compositeMaterial.uniforms.bloomRadius.value=.1;const y=[1,.8,.6,.4,.2];this.compositeMaterial.uniforms.bloomFactors.value=y,this.bloomTintColors=[new Ne(1,1,1),new Ne(1,1,1),new Ne(1,1,1),new Ne(1,1,1),new Ne(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,this.copyUniforms=sd.clone(er.uniforms),this.blendMaterial=new Kt({uniforms:this.copyUniforms,vertexShader:er.vertexShader,fragmentShader:er.fragmentShader,blending:pt,depthTest:!1,depthWrite:!1,transparent:!0}),this._oldClearColor=new $t,this._oldClearAlpha=1,this._basic=new yt,this._fsQuad=new ny(null)}dispose(){for(let i=0;i<this.renderTargetsHorizontal.length;i++)this.renderTargetsHorizontal[i].dispose();for(let i=0;i<this.renderTargetsVertical.length;i++)this.renderTargetsVertical[i].dispose();this.renderTargetBright.dispose();for(let i=0;i<this.separableBlurMaterials.length;i++)this.separableBlurMaterials[i].dispose();this.compositeMaterial.dispose(),this.blendMaterial.dispose(),this._basic.dispose(),this._fsQuad.dispose()}setSize(i,l){let o=Math.round(i/2),r=Math.round(l/2);this.renderTargetBright.setSize(o,r);for(let c=0;c<this.nMips;c++)this.renderTargetsHorizontal[c].setSize(o,r),this.renderTargetsVertical[c].setSize(o,r),this.separableBlurMaterials[c].uniforms.invSize.value=new Pe(1/o,1/r),o=Math.round(o/2),r=Math.round(r/2)}render(i,l,o,r,c){i.getClearColor(this._oldClearColor),this._oldClearAlpha=i.getClearAlpha();const d=i.autoClear;i.autoClear=!1,i.setClearColor(this.clearColor,0),c&&i.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this._fsQuad.material=this._basic,this._basic.map=o.texture,i.setRenderTarget(null),i.clear(),this._fsQuad.render(i)),this.highPassUniforms.tDiffuse.value=o.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this._fsQuad.material=this.materialHighPassFilter,i.setRenderTarget(this.renderTargetBright),i.clear(),this._fsQuad.render(i);let m=this.renderTargetBright;for(let p=0;p<this.nMips;p++)this._fsQuad.material=this.separableBlurMaterials[p],this.separableBlurMaterials[p].uniforms.colorTexture.value=m.texture,this.separableBlurMaterials[p].uniforms.direction.value=Vi.BlurDirectionX,i.setRenderTarget(this.renderTargetsHorizontal[p]),i.clear(),this._fsQuad.render(i),this.separableBlurMaterials[p].uniforms.colorTexture.value=this.renderTargetsHorizontal[p].texture,this.separableBlurMaterials[p].uniforms.direction.value=Vi.BlurDirectionY,i.setRenderTarget(this.renderTargetsVertical[p]),i.clear(),this._fsQuad.render(i),m=this.renderTargetsVertical[p];this._fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,i.setRenderTarget(this.renderTargetsHorizontal[0]),i.clear(),this._fsQuad.render(i),this._fsQuad.material=this.blendMaterial,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,c&&i.state.buffers.stencil.setTest(!0),this.renderToScreen?(i.setRenderTarget(null),this._fsQuad.render(i)):(i.setRenderTarget(o),this._fsQuad.render(i)),i.setClearColor(this._oldClearColor,this._oldClearAlpha),i.autoClear=d}_getSeparableBlurMaterial(i){const l=[],o=i/3;for(let r=0;r<i;r++)l.push(.39894*Math.exp(-.5*r*r/(o*o))/o);return new Kt({defines:{KERNEL_RADIUS:i},uniforms:{colorTexture:{value:null},invSize:{value:new Pe(.5,.5)},direction:{value:new Pe(.5,.5)},gaussianCoefficients:{value:l}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`#include <common>
				varying vec2 vUv;
				uniform sampler2D colorTexture;
				uniform vec2 invSize;
				uniform vec2 direction;
				uniform float gaussianCoefficients[KERNEL_RADIUS];

				void main() {
					float weightSum = gaussianCoefficients[0];
					vec3 diffuseSum = texture2D( colorTexture, vUv ).rgb * weightSum;
					for( int i = 1; i < KERNEL_RADIUS; i ++ ) {
						float x = float(i);
						float w = gaussianCoefficients[i];
						vec2 uvOffset = direction * invSize * x;
						vec3 sample1 = texture2D( colorTexture, vUv + uvOffset ).rgb;
						vec3 sample2 = texture2D( colorTexture, vUv - uvOffset ).rgb;
						diffuseSum += ( sample1 + sample2 ) * w;
					}
					gl_FragColor = vec4( diffuseSum, 1.0 );
				}`})}_getCompositeMaterial(i){return new Kt({defines:{NUM_MIPS:i},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;
				uniform sampler2D blurTexture1;
				uniform sampler2D blurTexture2;
				uniform sampler2D blurTexture3;
				uniform sampler2D blurTexture4;
				uniform sampler2D blurTexture5;
				uniform float bloomStrength;
				uniform float bloomRadius;
				uniform float bloomFactors[NUM_MIPS];
				uniform vec3 bloomTintColors[NUM_MIPS];

				float lerpBloomFactor(const in float factor) {
					float mirrorFactor = 1.2 - factor;
					return mix(factor, mirrorFactor, bloomRadius);
				}

				void main() {
					gl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +
						lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +
						lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +
						lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +
						lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );
				}`})}}Vi.BlurDirectionX=new Pe(1,0);Vi.BlurDirectionY=new Pe(0,1);const pM=a=>{const i=new C1;i.background=new $t(330258);const l=new z1(45,a.clientWidth/a.clientHeight,.1,1e3);l.position.set(0,0,170);const o=new D1({antialias:!0});o.setSize(a.clientWidth,a.clientHeight),a.appendChild(o.domElement);const r=new R1(16777215,.35),c=new A1(16777215,1.2);return c.position.set(60,60,100),i.add(r),i.add(c),{scene:i,camera:l,renderer:o,dispose:()=>{o.dispose(),o.domElement.remove()}}},gM=({containerRef:a,minZoom:i,maxZoom:l})=>{const o=j.useRef(null),[r,c]=j.useState(null);return j.useEffect(()=>{const d=a.current;if(!d)return;const{scene:m,camera:p,renderer:y,dispose:v}=pM(d);y.setPixelRatio(Math.min(window.devicePixelRatio??1,2));const g=new ZE(p,y.domElement);g.enableDamping=!0,g.enabled=!0,g.enablePan=!0,g.screenSpacePanning=!0,g.enableRotate=!1,g.enableZoom=!1,g.minDistance=i,g.maxDistance=l,g.mouseButtons={LEFT:La.ROTATE,MIDDLE:La.ROTATE,RIGHT:La.PAN},g.minAzimuthAngle=0,g.maxAzimuthAngle=0,g.minPolarAngle=Math.PI/2,g.maxPolarAngle=Math.PI/2+Math.PI/6;const b=new fM(y);b.addPass(new hM(m,p));const S=new Vi(new Pe(d.clientWidth,d.clientHeight),.3,.5,.2);b.addPass(S);const _=new sa;_.name="systemGroup",m.add(_);const N=new $0,M={scene:m,camera:p,renderer:y,controls:g,composer:b,clock:N,systemGroup:_};o.current=M,c(M);const T=()=>{y.setSize(d.clientWidth,d.clientHeight),p.aspect=d.clientWidth/d.clientHeight,p.updateProjectionMatrix(),b?.setSize(d.clientWidth,d.clientHeight),S.setSize(d.clientWidth,d.clientHeight)};return window.addEventListener("resize",T),()=>{window.removeEventListener("resize",T),g.dispose(),b?.dispose(),v(),o.current=null,c(null)}},[a,i,l]),r},yM=({containerRef:a,minZoom:i,maxZoom:l,onFrame:o})=>{const r=gM({containerRef:a,minZoom:i,maxZoom:l}),c=j.useRef(null),d=j.useRef(null);return j.useEffect(()=>{d.current=r??null},[r]),j.useEffect(()=>{if(!r)return;const{renderer:m,camera:p,composer:y}=r,v=()=>{const b=a.current;b&&(m.setSize(b.clientWidth,b.clientHeight),p.aspect=b.clientWidth/b.clientHeight,p.updateProjectionMatrix(),y?.setSize(b.clientWidth,b.clientHeight))};window.addEventListener("resize",v);const g=()=>{const b=d.current;if(!b)return;const S=b.clock.getDelta(),_=typeof b.clock.elapsedTime=="number"?b.clock.elapsedTime:b.clock.getElapsedTime();o(b,S,_),b.composer?b.composer.render():b.renderer.render(b.scene,b.camera),c.current=requestAnimationFrame(g)};return c.current=requestAnimationFrame(g),()=>{c.current!==null&&cancelAnimationFrame(c.current),window.removeEventListener("resize",v)}},[r,a,o]),r??null},vM=(a,i,l)=>Math.min(Math.max(a,i),l),bM=({ctx:a,delta:i,minZoom:l,maxZoom:o,offsetTargetRef:r,zoomTargetRef:c,zoomTargetDirtyRef:d,tiltStateRef:m,tempSphericalRef:p,tempOffsetRef:y})=>{const{camera:v,controls:g,systemGroup:b}=a,S=g?.target??new Ne;b.rotation.y=0,b.rotation.x=0,r.current.copy(S),g&&(g.minDistance=l,g.maxDistance=o,g.minPolarAngle=Math.PI/2,g.maxPolarAngle=Math.PI/2+Math.PI/6);const _=m.current,N=_.target-_.current;Math.abs(N)>5e-4&&(_.current+=N*.18);const M=vM(_.current,Math.PI/2,Math.PI/2+Math.PI/6),T=y.current,w=p.current;T.copy(v.position).sub(S),w.setFromVector3(T),w.phi=M;const z=w.radius;if(d.current){const A=ol.lerp(z,c.current,.1);w.radius=A,Math.abs(A-c.current)<.1&&(d.current=!1)}else c.current=z;return T.setFromSpherical(w).add(S),v.position.copy(T),v.lookAt(S),g?.update(),{zoomFactor:ol.clamp((v.position.z-l)/Math.max(1,o-l),0,1),deltaFactor:i>0?Math.min(4,i*60):1}},xM=(a,i)=>{a&&a.children.forEach(l=>{if(l instanceof In){const o=l.material,r=l.userData.baseOpacity??.2;if("uniforms"in o&&o.uniforms.uGlobalOpacity){const c=o.uniforms.uGlobalOpacity;c&&(c.value=r*(.85+i*1.1))}else"opacity"in o&&(o.opacity=r*(.85+i*1.1))}else if(l instanceof qe){const o=l.material;if(o.uniforms?.uOpacity){const r=l.userData.baseOpacity??o.uniforms.uOpacity.value??.4;o.uniforms.uOpacity.value=r*(.55+i*.7)}}})},SM=(a,i,l,o)=>{const r=a.getObjectByName("starGlow"),c=a.getObjectByName("starGlowOuter"),d=a.getObjectByName("starStreak"),m=a.getObjectByName("starStreakCross"),p=a.getObjectByName("starSparkle"),y=a.getObjectByName("starCore"),v=a.getObjectByName("starBurst"),g=a.getObjectByName("starCorona"),b=a.getObjectByName("starVisual"),S=a.getObjectByName("starVisual")?.userData?.pulseSeed??0,_=a.getObjectByName("starVisual")?.userData?.baseGlow??1,N=a.getObjectByName("starVisual")?.userData?.timeSpeed??1,M=1+l*.45,T=.8+l*.5,w=l>.55;if(y){const z=y.material;z.uniforms?.uTime&&(z.uniforms.uTime.value=(i+S*.5)*N)}if(b){const z=.15*N;b.rotation.z+=o*z}if(r){const z=i+S*.1,D=1+Math.sin(z*1.3)*.06,A=w?1.02+Math.max(0,l-.6)*.6:1,q=w?.35+Math.max(0,l-.6)*.45:1;r.scale.set(_*D*M*A,_*D*M*A,1),r.material.opacity=(.7+Math.sin(z*1.1)*.12)*T*q}if(c){const z=i+S*.06,D=1+Math.sin(z*.7)*.04,A=w?1.05+Math.max(0,l-.6)*.7:1,q=w?.4+Math.max(0,l-.6)*.4:1,I=c.material;c.scale.set(_*1.6*D*M*A,_*1.6*D*M*A,1),I.opacity!==void 0&&(I.opacity=(.22+Math.sin(z*.9)*.05)*T*q)}if(d&&(d.visible=w,w)){const z=i+S*.12,D=1+Math.sin(z*.6)*.05,A=.7+Math.max(0,l-.6)*.8,q=d.material;d.scale.set(_*1.2*D*A,_*.45*(1+Math.sin(z*.8)*.04)*A,1),q.opacity!==void 0&&(q.opacity=.12+Math.sin(z*1.1)*.03)}if(m&&(m.visible=w,w)){const z=i+S*.1,D=1+Math.sin(z*.5)*.04,A=.6+Math.max(0,l-.6)*.7,q=m.material,I=m.material;m.scale.set(_*1.1*D*A,_*.38*(1+Math.sin(z*.7)*.05)*A,1),q.opacity!==void 0&&(q.opacity=.1+Math.sin(z*.9)*.03),I.rotation=Math.PI/2+Math.sin(z*.2)*.08}if(p){p.visible=!w;const z=i+S*.14,D=1+Math.sin(z*1.5)*.1,A=p.material;p.scale.set(_*.8*D*M,_*.8*D*M,1),A.opacity!==void 0&&(A.opacity=(.3+Math.sin(z*2.1)*.08)*T)}if(g){g.visible=!w;const z=i+S*.18,D=1+Math.sin(z*1.4)*.08,A=g.material;g.scale.set(_*1.2*D*M,_*1.2*D*M,1),A.rotation=Math.sin(z*.6)*.1,A.opacity=(.16+Math.sin(z*1.1)*.05)*T}if(v){v.visible=w;const z=i+S*.08,D=Math.max(0,l-.55)/.6,A=1+Math.sin(z*.4)*.04,q=v.material,I=_*1.8*(.5+D*.8)*A;v.scale.set(I,I,1),q.opacity!==void 0&&(q.opacity=.08+D*.3)}},_M=({systemGroup:a,delta:i,elapsed:l,zoomFactor:o,planetAngleRef:r,camera:c,deltaFactor:d})=>{const m=c.position.z<105,p=c.position.z<240&&o<.9,y=p?ol.clamp(120/c.position.z,.45,1.4):1,v=y,g=p?ol.clamp(y*.75,.35,1):1,b=.2+o*.5;a.children.forEach(S=>{const _=S.getObjectByName("label");_&&(_.visible=p,p&&_.scale.set(_.userData.baseWidth*v,_.userData.baseHeight*v,1));const N=S.children.find(w=>w.userData?.kind==="ownerBase"),M=S.children.find(w=>w.userData?.kind==="ownerOrbit");N&&(N.visible=!m),M&&(M.visible=m&&M.userData?.orbitVisible);const T=S.getObjectByName("orbits");T&&(T.visible=m,m&&T.children.forEach(w=>{const z=w.userData;if((z?.kind==="planet"||z?.kind==="colonized")&&typeof z.orbitRadius=="number"){const D=z.orbitSpeed??0,A=(z.orbitAngle??0)+D*d;z.orbitAngle=A;const q=Math.cos(A)*z.orbitRadius,I=Math.sin(A)*z.orbitRadius;w.position.set(q,I,0),z.kind==="planet"&&r.current.set(z.planetId,A);const G=w.getObjectByName("planetLabel");G&&(G.visible=p,p&&G.scale.set(G.userData.baseWidth*g,G.userData.baseHeight*g,1))}})),S.children.forEach(w=>{if(w instanceof qe&&(w.userData?.kind==="owner"||w.userData?.kind==="hostile"||w.userData?.kind==="combat")){const z=w.material;z.opacity!==void 0&&(z.transparent=!0,z.opacity=b)}}),SM(S,l,o,i)})},NM=(a,i,l)=>{const o=a.current,r=o?.getObjectByName("accretionOuter"),c=o?.getObjectByName("glow"),d=o?.getObjectByName("accretionInner");(o?.userData.shaderMaterials??[]).forEach(p=>{p.uniforms.uTime&&(p.uniforms.uTime.value=l)}),o&&(o.rotation.z+=i*.12),r&&(r.rotation.z+=i*.35),d&&(d.rotation.z-=i*.28),c&&(c.rotation.z-=i*.25)},EM=a=>{const i=()=>bM({ctx:a.ctx,delta:a.delta,minZoom:a.minZoom,maxZoom:a.maxZoom,offsetTargetRef:a.offsetTargetRef,zoomTargetRef:a.zoomTargetRef,zoomTargetDirtyRef:a.zoomTargetDirtyRef,tiltStateRef:a.tiltStateRef,tempSphericalRef:a.tempSphericalRef,tempOffsetRef:a.tempOffsetRef}),l=(d,m)=>{xM(a.nebulaRef.current,d),_M({systemGroup:a.ctx.systemGroup,delta:a.delta,elapsed:a.elapsed,zoomFactor:d,planetAngleRef:a.planetAngleRef,camera:a.ctx.camera,deltaFactor:m}),NM(a.blackHoleRef,a.delta,a.elapsed)},o=()=>{a.updateAnchors(a.ctx.systemGroup,a.scienceAnchors),a.updateAnchors(a.ctx.systemGroup,a.fleetAnchors)},{zoomFactor:r,deltaFactor:c}=i();l(r,c),o()},MM=(a,i,l)=>Math.min(Math.max(a,i),l),iy=()=>{const{sceneContext:a,minZoom:i,maxZoom:l,baseTilt:o,maxTiltDown:r,cameraState:{cameraRef:c,offsetTargetRef:d,zoomTargetRef:m,zoomTargetDirtyRef:p,tiltStateRef:y}}=$i(),v=j.useCallback(M=>MM(M,i,l),[i,l]),g=j.useCallback((M,T)=>{const w=T?.zoom??m.current,z=v(w),D=M instanceof Ne?M:new Ne(M.x,M.y,M.z??0);if(a?.controls&&(a.controls.target.copy(D),a.controls.update()),d.current.copy(D),m.current=z,p.current=!0,T?.immediate&&c.current){const A=c.current,q=a?.controls?.target??D,I=A.position.clone().sub(q);I.lengthSq()===0?I.set(0,0,z):I.setLength(z),A.position.copy(I.add(q))}},[v,d,m,p,c,a]),b=j.useCallback((M,T)=>{const w=new Ne;M.getWorldPosition(w),g(w,T)},[g]),S=j.useCallback(()=>{const M=y.current,T=Math.abs(M.target-r)<.01;M.target=T?o:r},[o,r,y]),_=j.useCallback((M,{immediate:T=!1}={})=>{const w=v(M);m.current=w,p.current=!T,T&&c.current&&(c.current.position.z=w)},[v,m,p,c]),N=j.useCallback(()=>{const M=a;if(!M)return;const T=M.camera.position.distanceTo(M.controls?.target??new Ne);_(T,{immediate:!0}),p.current=!1},[a,_,p]);return j.useMemo(()=>({clampZoom:v,focusOnPosition:g,focusOnObject:b,toggleTilt:S,setZoomTarget:_,syncZoomToCurrent:N}),[v,g,b,S,_,N])},jM=a=>{const i=a.find(p=>{let y=p.object;for(;y&&!y.userData.systemId&&!y.userData.planetId&&!y.userData.kind;)y=y.parent;return!!y?.userData.systemId});if(!i)return null;let l=i.object;for(;l&&!l.userData.systemId&&!l.userData.planetId&&!l.userData.kind;)l=l.parent;if(!l)return null;const o=l.userData.systemId,r=l.userData.planetId,c=l.userData.kind,d=l.userData.visibility,m=new Ne;return l.getWorldPosition(m),{systemId:o,planetId:r,kind:c,visibility:d,worldPos:m}},wM=(a,i,l)=>{const o=a.clone().project(i),r=(o.x+1)/2*l.width,c=(-o.y+1)/2*l.height;return{x:r,y:c}},TM=({onSelectRef:a,onClearRef:i,onPlanetSelect:l,onShipyardSelect:o})=>{const{focusOnPosition:r,toggleTilt:c,clampZoom:d,setZoomTarget:m}=iy(),{sceneContext:p,cameraState:{systemGroupRef:y}}=$i(),v=j.useRef(new k1),g=j.useRef(new Pe);j.useEffect(()=>{const b=y.current??p?.systemGroup??null;if(!p||!b)return;const{renderer:S,camera:_,controls:N}=p,M=b,T=A=>A.preventDefault(),w=A=>{A.preventDefault();const q=N.target??new Ne,I=p.camera.position.distanceTo(q),G=Math.max(20,I*.35),F=Math.sign(A.deltaY)*G,Z=d(I+F);m(Z)},z=A=>{A.button===1&&(A.preventDefault(),A.stopPropagation(),c())},D=A=>{if(A.button!==0||!M.children.length)return;const q=S.domElement.getBoundingClientRect(),I=g.current,G=v.current;I.x=(A.clientX-q.left)/q.width*2-1,I.y=-((A.clientY-q.top)/q.height)*2+1,G.setFromCamera(I,_);const F=G.intersectObjects(M.children,!0),Z=jM(F);if(!Z){i.current?.();return}if(Z.visibility==="unknown"){i.current?.();return}const{systemId:J,planetId:ee,kind:re,worldPos:de}=Z;r(de,{zoom:60});const Ee=wM(de,_,{width:S.domElement.clientWidth,height:S.domElement.clientHeight});re==="shipyard"&&o?o(J,Ee):ee&&l?l(ee,J,Ee):a.current?.(J,Ee)};return S.domElement.addEventListener("contextmenu",T),S.domElement.addEventListener("wheel",w,{passive:!1}),S.domElement.addEventListener("auxclick",z),S.domElement.addEventListener("click",D),()=>{S.domElement.removeEventListener("wheel",w),S.domElement.removeEventListener("auxclick",z),S.domElement.removeEventListener("click",D),S.domElement.removeEventListener("contextmenu",T)}},[p,y,a,i,l,o,r,c,d,m])},sy=a=>{let i=a.split("").reduce((l,o)=>l+o.charCodeAt(0),0)+1831565813;return()=>{i+=1831565813;let l=Math.imul(i^i>>>15,1|i);return l^=l+Math.imul(l^l>>>7,61|l),((l^l>>>14)>>>0)/4294967296}},CM=a=>({x:a.mapPosition?.x??a.position.x,y:a.mapPosition?.y??a.position.y,z:a.mapPosition?.z??0}),zM=(a,i)=>{if(a.length===0)return null;const l=256,o=document.createElement("canvas");o.width=l,o.height=l;const r=o.getContext("2d");if(!r)return null;r.fillStyle="rgba(0,0,0,0)",r.fillRect(0,0,l,l),r.globalCompositeOperation="lighter";const c=l*.022;a.forEach(p=>{const y=CM(p),v=y.x/Math.max(1,i*1.05),g=y.y/Math.max(1,i*1.05),b=l*.5+v*l*.45,S=l*.5+g*l*.45,_=c*(.6+Math.random()*.9),N=r.createRadialGradient(b,S,0,b,S,_);N.addColorStop(0,"rgba(255,255,255,0.4)"),N.addColorStop(1,"rgba(255,255,255,0)"),r.fillStyle=N,r.beginPath(),r.arc(b,S,_,0,Math.PI*2),r.fill()}),r.filter="blur(3px)";const d=r.getImageData(0,0,l,l);r.putImageData(d,0,0);const m=new Xn(o);return m.needsUpdate=!0,m.wrapS=Wt,m.wrapT=Wt,m.minFilter=Tt,m.magFilter=Tt,m},DM=(()=>{let a=null;return()=>{if(a)return a;const i=new Uint8Array([255,255,255,255]),l=new W0(i,1,1,O1);return l.needsUpdate=!0,l.minFilter=Tt,l.magFilter=Tt,a=l,l}})(),ly=(a,i,l)=>{const o=sy(a);return()=>{const c=(.35+Math.pow(o(),l==="spiral"?.92:1.1)*.7)*i,d=3;let m=o()*Math.PI*2;if(l==="spiral"){const _=Math.floor(o()*d)/d*Math.PI*2,N=c/i*Math.PI*3.6;m=_+N+(o()-.5)*.6}else m+=(o()-.5)*.4;const p=(o()-.5)*i*.12*(1-c/i),y=Math.cos(m)*c+p,v=Math.sin(m)*c+p,g=(o()-.5)*Math.max(18,i*.05),b=1-Math.min(1,c/i);return{x:y,y:v,z:g,falloff:b,random:o}}},RM=typeof window<"u"?window.devicePixelRatio:1,AM=(()=>{let a=null;return()=>{if(a)return a;const i=128,l=document.createElement("canvas");l.width=i,l.height=i;const o=l.getContext("2d");if(!o)return a=null,null;const r=o.createRadialGradient(i/2,i/2,i*.08,i/2,i/2,i*.5);r.addColorStop(0,"rgba(255,255,255,1)"),r.addColorStop(.4,"rgba(255,255,255,0.45)"),r.addColorStop(1,"rgba(255,255,255,0)"),o.fillStyle=r,o.fillRect(0,0,i,i);const c=new Xn(l);return c.needsUpdate=!0,c.minFilter=Tt,c.magFilter=Tt,c.wrapS=Wt,c.wrapT=Wt,a=c,a}})(),kM=()=>RM,OM=({radius:a,shape:i,seed:l,maskTexture:o,baseColors:r})=>{const c=new sa,d=ly(`${l}-particles`,a,i),m=kM(),p=(b,S,_,N,M)=>{const T=new Float32Array(b*3),w=new Float32Array(b*3),z=new Float32Array(b),D=new Float32Array(b);for(let G=0;G<b;G+=1){const{x:F,y:Z,z:J,falloff:ee,random:re}=d(),de=G*3;T[de]=F+(re()-.5)*a*.08,T[de+1]=Z+(re()-.5)*a*.08,T[de+2]=J;const Ee=Math.min(1,Math.max(0,ee*.7+re()*.4)),U=N.clone().lerp(M,Ee);w[de]=U.r,w[de+1]=U.g,w[de+2]=U.b,z[G]=Math.min(1,_*1.6*(.6+re()*.8)*(.45+ee)),D[G]=S*(.5+re()*.9)}const A=new Hn;A.setAttribute("position",new dt(T,3)),A.setAttribute("color",new dt(w,3)),A.setAttribute("aAlpha",new dt(z,1)),A.setAttribute("aSize",new dt(D,1));const q=new Kt({transparent:!0,depthWrite:!1,depthTest:!1,blending:pt,uniforms:{uGlobalOpacity:{value:1},uPixelRatio:{value:m},uMask:{value:o},uMaskScale:{value:1/Math.max(1,a*1.6)}},vertexShader:`
        precision mediump float;
        precision mediump int;
        attribute float aAlpha;
        attribute float aSize;
        attribute vec3 color;
        varying vec3 vColor;
        varying float vAlpha;
        varying vec2 vMaskUv;
        uniform float uMaskScale;
        void main() {
          vColor = color;
          vAlpha = aAlpha;
          vec3 worldPos = (modelMatrix * vec4(position, 1.0)).xyz;
          vMaskUv = worldPos.xy * uMaskScale + 0.5;
          vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
          float dist = -mvPosition.z;
          float sizeAtten = aSize * uPixelRatio * clamp(300.0 / max(1.0, dist), 0.5, 4.0);
          gl_PointSize = sizeAtten;
          gl_Position = projectionMatrix * mvPosition;
        }
      `,fragmentShader:`
        precision mediump float;
        precision mediump int;
        varying vec3 vColor;
        varying float vAlpha;
        varying vec2 vMaskUv;
        uniform float uGlobalOpacity;
        uniform sampler2D uMask;
        void main() {
          vec2 uv = gl_PointCoord - 0.5;
          float d = length(uv) * 2.0;
          float falloff = smoothstep(1.0, 0.2, d);
          vec2 mUv = clamp(vMaskUv, 0.0, 1.0);
          float mask = clamp(texture2D(uMask, mUv).r, 0.0, 1.0);
          float maskAlpha = mix(0.65, 1.0, mask);
          float alpha = vAlpha * falloff * uGlobalOpacity * maskAlpha;
          if (alpha <= 0.001) discard;
          gl_FragColor = vec4(vColor * falloff, alpha);
        }
      `}),I=new In(A,q);I.userData.baseOpacity=_,I.renderOrder=-10,c.add(I)},y=Math.min(18e3,Math.max(6e3,Math.floor(a*32))),v=Math.min(14e3,Math.max(4e3,Math.floor(a*22))),g=Math.min(9e3,Math.max(2200,Math.floor(a*12)));return p(y,Math.max(1.6,a*.008),.48,r[0],r[1]),p(v,Math.max(3.4,a*.014),.38,r[0],r[1]),p(g,Math.max(7.5,a*.03),.28,r[1],r[2]),c},UM=({radius:a,shape:i,seed:l,baseColors:o})=>{const r=sy(`${l}-fog`),c=new Kt({transparent:!0,depthWrite:!1,depthTest:!0,blending:pt,uniforms:{uColorA:{value:o[0].clone()},uColorB:{value:o[2].clone()},uOpacity:{value:.04},uScale:{value:i==="spiral"?2.4:1.9},uOffset:{value:new Pe(r()*500,r()*500)},uRotation:{value:r()*Math.PI*2}},vertexShader:`
      precision mediump float;
      precision mediump int;
      varying vec2 vUv;
      void main() {
        vUv = uv;
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
      }
    `,fragmentShader:`
      precision mediump float;
      precision mediump int;
      varying vec2 vUv;
      uniform vec3 uColorA;
      uniform vec3 uColorB;
      uniform float uOpacity;
      uniform float uScale;
      uniform vec2 uOffset;
      uniform float uRotation;

      float hash(vec2 p) { return fract(sin(dot(p, vec2(127.1, 311.7))) * 43758.5453123); }
      float noise(vec2 p) {
        vec2 i = floor(p);
        vec2 f = fract(p);
        float a = hash(i);
        float b = hash(i + vec2(1.0, 0.0));
        float c = hash(i + vec2(0.0, 1.0));
        float d = hash(i + vec2(1.0, 1.0));
        vec2 u = f * f * (3.0 - 2.0 * f);
        return mix(a, b, u.x) + (c - a) * u.y * (1.0 - u.x) + (d - b) * u.x * u.y;
      }
      float fbm(vec2 p) {
        float sum = 0.0;
        float amp = 0.5;
        float freq = 1.0;
        for (int i = 0; i < 4; i++) {
          sum += amp * noise(p * freq);
          freq *= 2.2;
          amp *= 0.55;
        }
        return sum;
      }

      void main() {
        vec2 centered = vUv - 0.5;
        float r = length(centered) * 2.0;
        float mask = smoothstep(1.0, 0.4, r);
        float angle = uRotation;
        float cs = cos(angle);
        float sn = sin(angle);
        mat2 rot = mat2(cs, -sn, sn, cs);
        vec2 p = (rot * centered) * uScale + uOffset;
        float n = fbm(p);
        float d = smoothstep(0.25, 0.75, n);
        vec3 col = mix(uColorA, uColorB, d);
        float alpha = mask * d * uOpacity;
        if (alpha <= 0.001) discard;
        gl_FragColor = vec4(col, alpha);
      }
    `}),d=new qe(new qi(a*2.1,a*2.1,1,1),c);return d.name="nebulaFog",d.userData.baseOpacity=.12,d.position.set(0,0,-6),d.rotation.z=i==="spiral"?r()*.6:0,d.renderOrder=-20,d},LM=({radius:a,shape:i,seed:l,baseColors:o})=>{const r=AM();if(!r)return null;const c=new sa;c.name="starfield";const d=ly(`${l}-stars`,a,i),m=({count:b,size:S,opacity:_,colorBias:N})=>{const M=new Float32Array(b*3),T=new Float32Array(b*3);for(let A=0;A<b;A+=1){const{x:q,y:I,z:G,falloff:F,random:Z}=d(),J=A*3;M[J]=q*1.05+(Z()-.5)*a*.05,M[J+1]=I*1.05+(Z()-.5)*a*.05,M[J+2]=G*.35;const ee=o[1].clone().lerp(o[2],F*N);T[J]=ee.r,T[J+1]=ee.g,T[J+2]=ee.b}const w=new Hn;w.setAttribute("position",new dt(M,3)),w.setAttribute("color",new dt(T,3));const z=new al({size:S,map:r,transparent:!0,depthWrite:!1,blending:pt,vertexColors:!0,opacity:_,sizeAttenuation:!0}),D=new In(w,z);return D.renderOrder=-15,D},p=Math.min(4500,Math.max(900,Math.floor(a*1.8))),y=Math.min(2200,Math.max(600,Math.floor(a))),v=m({count:p,size:Math.max(1.6,a*.007),opacity:1,colorBias:.8}),g=m({count:y,size:Math.max(2.6,a*.012),opacity:.35,colorBias:.45});return c.add(g),c.add(v),c},BM=({radius:a,shape:i,seed:l,mask:o})=>{const r=new sa;r.name="nebula";const c=o??DM();r.userData.maskTexture=c,r.userData.maskOwned=!!o;const d=[new $t("#3b6fcf"),new $t("#72e3ff"),new $t("#c39bff")],m=OM({radius:a,shape:i,seed:l,maskTexture:c,baseColors:d});r.add(m);const p=UM({radius:a,shape:i,seed:l,baseColors:d});r.add(p);const y=LM({radius:a,shape:i,seed:l,baseColors:d});return y&&r.add(y),r},PM=a=>{if(!a)return;const i=a.userData.maskTexture,l=a.userData.maskOwned;i&&l&&i.dispose(),a.children.forEach(o=>{if(o instanceof In||o instanceof qe){o.geometry.dispose();const r=o.material;Array.isArray(r)?r.forEach(c=>c.dispose()):r&&r.dispose()}}),a.clear()},IM=({group:a,systems:i,galaxyShape:l,galaxySeed:o,maxSystemRadius:r})=>{const c=Math.max(r*1.08,140),d=zM(i,c),m=BM({radius:c,shape:l,seed:o,mask:d});return a.add(m),m},HM={friendly:new Hi({color:7647487}),hostile:new Hi({color:16739179}),revealed:new Hi({color:5004930,emissive:329485,transparent:!0,opacity:.8}),fogged:new Hi({color:1712434,emissive:329485,transparent:!0,opacity:.5}),ship:new yt({color:16777215})},GM={idle:new yt({color:8381327}),traveling:new yt({color:16762967}),surveying:new yt({color:5104383})},qM={idle:new vn({color:8381327,transparent:!0,opacity:.35}),traveling:new vn({color:16762967,transparent:!0,opacity:.45}),surveying:new vn({color:5104383,transparent:!0,opacity:.45})},YM={idle:new yt({color:10469887}),line:new vn({color:10469887,transparent:!0,opacity:.4}),war:new yt({color:16751498}),warLine:new vn({color:16751498,transparent:!0,opacity:.5})},VM=new yt({color:16739179,transparent:!0,opacity:.6}),XM=new yt({color:16762967,transparent:!0,opacity:.7}),O0=new yt({color:16739179,transparent:!0,opacity:.9}),Qo={player:new yt({color:7317759,transparent:!0,opacity:.08,depthWrite:!1}),ai:new yt({color:16762967,transparent:!0,opacity:.14,depthWrite:!1})},U0=["#72fcd5","#f9d976","#f58ef6","#8ec5ff","#c7ddff"],L0=new Map,B0=new Map,QM=new U1({color:"#4c5c7a",dashSize:1.4,gapSize:.9,transparent:!0,opacity:.45}),oy=a=>{const i=document.createElement("canvas"),l=i.getContext("2d");if(!l)return null;const o=48;l.font=`600 ${o}px Inter`;const r=l.measureText(a).width+40;i.width=r,i.height=o*1.8,l.font=`600 ${o}px Inter`,l.fillStyle="#e5ecff",l.fillText(a,20,o);const c=new Xn(i);c.needsUpdate=!0;const d=new gn({map:c,transparent:!0,depthTest:!1,depthWrite:!1}),m=new yn(d);return m.userData.baseWidth=i.width/30,m.userData.baseHeight=i.height/30,m.scale.set(m.userData.baseWidth,m.userData.baseHeight,1),m.position.set(0,8,0),m.renderOrder=20,m.raycast=()=>null,m.name="label",m},ZM=(a,i,l,o,r,c,d)=>{const m=new sa;m.name="orbits",m.userData.systemId=o,m.visible=!1,m.raycast=()=>null;const p=l+i%7*4e-4,y=d&&a.length>0?a.find(v=>v.id===d.id)?.id??a[0]?.id??null:null;return a.forEach(v=>{const g=r.get(v.id)??Math.random()*Math.PI*2;r.set(v.id,g);const b=new Hi({color:v.color??U0[i%U0.length]}),S=L0.get(v.size)??(()=>{const q=new Yi(v.size,16,16);return L0.set(v.size,q),q})(),_=new qe(S,b),N=p*v.orbitSpeed;_.userData={..._.userData,kind:"planet",systemId:o,planetId:v.id,orbitRadius:v.orbitRadius,orbitSpeed:N,orbitAngle:g},_.position.set(Math.cos(g)*v.orbitRadius,Math.sin(g)*v.orbitRadius,0),c.set(v.id,_);const M=y===v.id,T=M?d?.name??v.name:v.name,w=oy(T);if(w&&(w.name="planetLabel",w.position.set(0,v.size+2.5,.2),w.raycast=()=>null,_.add(w)),M){const q=new qe(new rl(v.size*1.3,v.size*1.6,40),new yt({color:"#6fe6a5",transparent:!0,opacity:.08,depthWrite:!1,side:Gn}));q.raycast=()=>null,q.rotation.set(0,0,0),q.userData={planetId:v.id,systemId:o},q.raycast=()=>null,_.add(q),d&&c.set(d.id,_)}m.add(_);const z=`${v.orbitRadius.toFixed(2)}`,D=B0.get(z)??(()=>{const I=[];let G=0;const F=[];for(let J=0;J<=96;J+=1){const ee=J/96*Math.PI*2,re=Math.cos(ee)*v.orbitRadius,de=Math.sin(ee)*v.orbitRadius;if(I.push(re,de,0),J>0){const Ee=I[(J-1)*3],U=I[(J-1)*3+1],L=re-Ee,K=de-U;G+=Math.sqrt(L*L+K*K)}F.push(G)}const Z=new Hn;return Z.setAttribute("position",new dt(I,3)),Z.setAttribute("lineDistance",new dt(F,1)),Z.computeBoundingSphere(),B0.set(z,Z),Z})(),A=new J0(D,QM);A.computeLineDistances(),A.raycast=()=>null,A.userData={...A.userData,kind:"ring",systemId:o},m.add(A)}),m},FM=(()=>{let a=null;return()=>{if(a)return a;const i=128,l=document.createElement("canvas");l.width=i,l.height=i;const o=l.getContext("2d");if(!o)return null;const r=o.createRadialGradient(i/2,i/2,i*.08,i/2,i/2,i*.5);return r.addColorStop(0,"rgba(255,255,255,1)"),r.addColorStop(.4,"rgba(255,255,255,0.65)"),r.addColorStop(1,"rgba(255,255,255,0)"),o.fillStyle=r,o.fillRect(0,0,i,i),a=new Xn(l),a.needsUpdate=!0,a.minFilter=Tt,a.magFilter=Tt,a.wrapS=Wt,a.wrapT=Wt,a}})(),KM=(()=>{let a=null;return()=>{if(a)return a;const i=256,l=document.createElement("canvas");l.width=i,l.height=i;const o=l.getContext("2d");if(!o)return null;const r=o.createLinearGradient(0,i/2,i,i/2);return r.addColorStop(0,"rgba(255,255,255,0)"),r.addColorStop(.2,"rgba(255,255,255,0.55)"),r.addColorStop(.5,"rgba(255,255,255,0.9)"),r.addColorStop(.8,"rgba(255,255,255,0.55)"),r.addColorStop(1,"rgba(255,255,255,0)"),o.fillStyle=r,o.fillRect(0,i/2-i*.08,i,i*.16),a=new Xn(l),a.needsUpdate=!0,a.minFilter=Tt,a.magFilter=Tt,a.wrapS=Wt,a.wrapT=Wt,a}})(),$M=(()=>{let a=null;return()=>{if(a)return a;const i=128,l=document.createElement("canvas");l.width=i,l.height=i;const o=l.getContext("2d");if(!o){const p=new Uint8Array(i*i*3).fill(255),y=new W0(p,i,i,L1);return y.needsUpdate=!0,a=y,y}const r=o.createImageData(i,i);let c=1337;const d=()=>(c=c*16807%2147483647,(c-1)/2147483646);for(let p=0;p<i;p+=1)for(let y=0;y<i;y+=1){const v=y-i/2,g=p-i/2,b=Math.sqrt(v*v+g*g)/(i*.5),S=Math.max(0,1-b),_=(d()*.5+d()*.35)*S,N=Math.min(1,.5*S+_),M=(p*i+y)*4,T=Math.floor(N*255);r.data[M]=T,r.data[M+1]=T,r.data[M+2]=T,r.data[M+3]=255}o.putImageData(r,0,0);const m=new Xn(l);return m.needsUpdate=!0,m.minFilter=Tt,m.magFilter=Tt,m.wrapS=Wt,m.wrapT=Wt,a=m,m}})(),WM=(()=>{let a=null;return()=>{if(a)return a;const i=256,l=document.createElement("canvas");l.width=i,l.height=i;const o=l.getContext("2d");if(!o)return null;o.translate(i/2,i/2);const r=o.createRadialGradient(0,0,i*.04,0,0,i*.5);r.addColorStop(0,"rgba(255,255,255,1)"),r.addColorStop(.25,"rgba(255,255,255,0.65)"),r.addColorStop(1,"rgba(255,255,255,0)"),o.fillStyle=r,o.beginPath(),o.arc(0,0,i*.5,0,Math.PI*2),o.fill();const c=(d,m,p)=>{o.save(),o.rotate(p);const y=o.createLinearGradient(-i/2,0,i/2,0);y.addColorStop(0,"rgba(255,255,255,0)"),y.addColorStop(.5,`rgba(255,255,255,${m})`),y.addColorStop(1,"rgba(255,255,255,0)"),o.fillStyle=y,o.fillRect(-i/2,-d/2,i,d),o.restore()};return c(i*.08,.6,0),c(i*.05,.4,Math.PI/4),a=new Xn(l),a.needsUpdate=!0,a.minFilter=Tt,a.magFilter=Tt,a.wrapS=Wt,a.wrapT=Wt,a}})(),bd={O:{coreColor:"#b9d8ff",glowColor:"#7ecbff",coreRadius:6.5,glowScale:22,plasmaSpeed:1.4,jetIntensity:.32,streakOpacity:.2},B:{coreColor:"#9fc4ff",glowColor:"#7ac8ff",coreRadius:5.8,glowScale:19.5,plasmaSpeed:1.25,jetIntensity:.28,streakOpacity:.18},A:{coreColor:"#c7d6ff",glowColor:"#9cc5ff",coreRadius:5,glowScale:17.5,plasmaSpeed:1.1,jetIntensity:.22,streakOpacity:.16},F:{coreColor:"#f7f2d0",glowColor:"#ffd27a",coreRadius:4.6,glowScale:16.2,plasmaSpeed:1.05,jetIntensity:.2,streakOpacity:.15},G:{coreColor:"#ffd27a",glowColor:"#ffbe55",coreRadius:4.2,glowScale:14.5,plasmaSpeed:1,jetIntensity:.18,streakOpacity:.14},K:{coreColor:"#ffb36b",glowColor:"#ff9b5f",coreRadius:3.6,glowScale:12.5,plasmaSpeed:.95,jetIntensity:.16,streakOpacity:.12},M:{coreColor:"#ff8a5c",glowColor:"#ff6b5f",coreRadius:3.2,glowScale:10.8,plasmaSpeed:.9,jetIntensity:.14,streakOpacity:.1}},JM=({preset:a,visibility:i,seed:l})=>{if(i==="unknown")return HM.fogged;const o=$M(),r=new $t(a.coreColor),c=new Ne(r.r,r.g,r.b);return new Kt({transparent:!0,depthWrite:!0,blending:pt,uniforms:{uTexture:{value:o},uTint:{value:c},uGlow:{value:1.2},uFresnelPower:{value:2.8},uTime:{value:0},uSeed:{value:l},uSpeed:{value:a.plasmaSpeed},uJetIntensity:{value:a.jetIntensity}},vertexShader:`
      precision mediump float;
      precision mediump int;
      varying vec2 vUv;
      varying vec3 vNormal;
      varying vec3 vViewDir;
      void main() {
        vUv = uv;
        vec4 worldPos = modelMatrix * vec4(position, 1.0);
        vNormal = normalize(normalMatrix * normal);
        vViewDir = normalize(cameraPosition - worldPos.xyz);
        gl_Position = projectionMatrix * viewMatrix * worldPos;
      }
    `,fragmentShader:`
      precision mediump float;
      precision mediump int;
      varying vec2 vUv;
      varying vec3 vNormal;
      varying vec3 vViewDir;
      uniform sampler2D uTexture;
      uniform vec3 uTint;
      uniform float uGlow;
      uniform float uFresnelPower;
      uniform float uTime;
      uniform float uSeed;
      uniform float uSpeed;
      uniform float uJetIntensity;

      float hash(vec2 p) {
        return fract(sin(dot(p, vec2(127.1, 311.7))) * 43758.5453123);
      }

      float noise(vec2 p) {
        vec2 i = floor(p);
        vec2 f = fract(p);
        float a = hash(i);
        float b = hash(i + vec2(1.0, 0.0));
        float c = hash(i + vec2(0.0, 1.0));
        float d = hash(i + vec2(1.0, 1.0));
        vec2 u = f * f * (3.0 - 2.0 * f);
        return mix(a, b, u.x) + (c - a) * u.y * (1.0 - u.x) + (d - b) * u.x * u.y;
      }

      float fbm(vec2 p) {
        float value = 0.0;
        float amp = 0.7;
        float freq = 1.6;
        for (int i = 0; i < 5; i++) {
          value += amp * noise(p * freq);
          freq *= 2.05;
          amp *= 0.52;
        }
        return value;
      }

      void main() {
        vec2 uvCentered = vUv - 0.5;
        float time = uTime * uSpeed;
        vec2 warped = uvCentered + fbm(uvCentered * 5.2 + time * 0.28 + uSeed) * 0.06;
        vec3 tex = texture2D(uTexture, warped + 0.5).rrr;
        float plasma = fbm(warped * 9.0 + time * 0.26) * 0.95 + fbm((warped + vec2(0.28, -0.18)) * 5.4 - time * 0.18) * 0.8;
        float angle = atan(uvCentered.y, uvCentered.x);
        float jetBurst = sin(time * 0.65 + uSeed * 3.7) * 0.5 + 0.5;
        float jets = pow(max(0.0, sin(angle * 6.2 + uSeed * 12.0 + time * 0.92)), 3.0) * jetBurst;
        jets *= smoothstep(0.2, 0.75, length(uvCentered)) * uJetIntensity;
        plasma += jets * 0.5;
        // Sunspot mask: coarse noise projected on disk to darken areas
        float spotNoise = fbm(uvCentered * 7.5 + time * 0.12 + uSeed * 1.7);
        float spotMask = smoothstep(0.52, 0.78, spotNoise) * smoothstep(0.18, 0.85, length(uvCentered));
        float spotDarken = mix(0.0, 0.65, spotMask);
        float fresnel = pow(1.0 - max(dot(normalize(vNormal), normalize(vViewDir)), 0.0), uFresnelPower);
        float plasmaMask = clamp(plasma, 0.0, 1.0);
        vec3 color = (tex * 0.9 + plasmaMask * 0.6 + jets * 0.35) * uTint * (0.88 + uGlow * 0.6);
        color *= (1.0 - spotDarken * 0.7);
        color += fresnel * vec3(1.0, 1.0, 1.0);
        float alpha = clamp(max(max(tex.r, plasmaMask), fresnel) + jets * 0.3, 0.0, 1.0);
        alpha *= (1.0 - spotMask * 0.15);
        gl_FragColor = vec4(color, alpha);
      }
    `,name:"starCoreMaterial"})},ej=(a,i,l,o)=>{const r=o[a]??bd[a]??bd.G,c=new sa;c.name="starVisual",c.userData={...c.userData,pulseSeed:l,baseGlow:r.glowScale,timeSpeed:r.plasmaSpeed};const d=JM({preset:r,visibility:i,seed:l}),m=new qe(new Yi(r.coreRadius,32,32),d);if(m.userData.systemId=null,m.name="starCore",c.add(m),i!=="unknown"){const p=FM();if(p){const y=new yn(new gn({map:p,color:r.glowColor,transparent:!0,depthWrite:!1,blending:pt,opacity:.7,name:"starGlowMaterial"}));y.name="starGlow",y.userData.systemId=null,y.scale.set(r.glowScale,r.glowScale,1),c.add(y);const v=new yn(new gn({map:p,color:r.glowColor,transparent:!0,depthWrite:!1,blending:pt,opacity:.28,name:"starGlowOuterMaterial"}));v.name="starGlowOuter",v.userData.systemId=null;const g=r.glowScale*1.6;v.scale.set(g,g,1),c.add(v);const b=KM();if(b){const M=new yn(new gn({map:b,color:r.glowColor,transparent:!0,depthWrite:!1,blending:pt,opacity:r.streakOpacity}));M.name="starStreak",M.userData.systemId=null,M.scale.set(r.glowScale*1.8,r.glowScale*.65,1),c.add(M);const T=new yn(new gn({map:b,color:r.glowColor,transparent:!0,depthWrite:!1,blending:pt,opacity:r.streakOpacity*.75}));T.name="starStreakCross",T.userData.systemId=null,T.scale.set(r.glowScale*1.6,r.glowScale*.55,1),T.material.rotation=Math.PI/2,c.add(T)}const S=new yn(new gn({map:p,color:"#ffffff",transparent:!0,depthWrite:!1,blending:pt,opacity:.4}));S.name="starSparkle",S.userData.systemId=null,S.scale.set(r.glowScale*.8,r.glowScale*.8,1),c.add(S);const _=new yn(new gn({map:p,color:r.glowColor,transparent:!0,depthWrite:!1,blending:pt,opacity:.18}));_.name="starCorona",_.userData.systemId=null,_.scale.set(r.glowScale*1.2,r.glowScale*1.2,1),c.add(_);const N=WM();if(N){const M=new yn(new gn({map:N,color:r.glowColor,transparent:!0,depthWrite:!1,blending:pt,opacity:.12}));M.name="starBurst",M.userData.systemId=null,M.scale.set(r.glowScale*2,r.glowScale*2,1),c.add(M)}}}return c},tj=({node:a,systemId:i,baseRadius:l,maxOrbitRadius:o,orbitVisible:r,ownerKey:c})=>{const d=l+3.6,m=d+2.5,p=r?o+1:d,y=r?o+1.6:m,v=new qe(new rl(d,m,32),Qo[c]??Qo.player);v.material.side=Gn,v.userData.systemId=i,v.userData.kind="ownerBase",v.raycast=()=>null,a.add(v);const g=new qe(new rl(p,y,32),Qo[c]??Qo.player);g.material.side=Gn,g.userData.systemId=i,g.userData.kind="ownerOrbit",g.userData.orbitVisible=r,g.visible=!1,g.raycast=()=>null,a.add(g)},aj=(a,i,l)=>{if(!i.hostilePower||i.hostilePower<=0)return;const o=new qe(new rl(l+1.2,l+2.1,24),VM);o.material.side=Gn,o.userData.systemId=i.id,o.userData.kind="hostile",o.raycast=()=>null,a.add(o)},nj=(a,i,l,o)=>{if(!o.has(i))return;const r=new qe(new rl(l+2.2,l+3.6,24),XM);r.material.side=Gn,r.userData.systemId=i,r.userData.kind="combat",r.raycast=()=>null,a.add(r)},ij=(a,i,l,o)=>{if(!o.has(i))return;const r=new qe(new qi((l+3)*1.6,(l+3)*1.6),O0);r.position.z=.5,r.material.side=Gn,r.userData.systemId=i,O0.depthWrite=!1,r.scale.set(1,.2,1),r.raycast=()=>null,a.add(r)},sj=({node:a,system:i,baseRadius:l,planetLookup:o})=>{if(!i.hasShipyard)return;const r=new qe(new qi(l*1.6,l*1.6),new yt({color:"#7fc1ff",opacity:.35,transparent:!0,depthWrite:!1}));r.userData.systemId=i.id,r.userData.kind="shipyard",r.rotation.z=Math.PI/4;const c=i.shipyardAnchorPlanetId&&o?o.get(i.shipyardAnchorPlanetId):null;if(c){const d=c;d.geometry&&!d.geometry.boundingSphere&&d.geometry.computeBoundingSphere();const m=d.geometry?.boundingSphere?.radius??2.5;r.position.set(0,m+1.5,.6),c.add(r);return}r.position.set(0,l+2.5,1),a.add(r)},lj=(a,i,l,o,r,c,d,m)=>{const p=new sa;p.name=a.id,p.userData.systemId=a.id,p.userData.visibility=a.visibility;const y=a.mapPosition??a.position;p.position.set(y.x,y.y,0);const v=a.visibility!=="unknown",g=a.visibility==="surveyed",b=m??bd,S=b[a.starClass]?.coreRadius??2.1,_=ej(a.starClass,a.visibility,a.id.charCodeAt(0),b);_.userData.systemId=a.id,p.add(_);const N=v?oy(a.name):null;N&&(N.position.y=S+6,p.add(N));const M=g?a.orbitingPlanets.reduce((w,z)=>Math.max(w,z.orbitRadius+(z.size??0)),0):0,T=g&&M>0;if(a.ownerId){const w=a.ownerId==="player"?"player":"ai";tj({node:p,systemId:a.id,baseRadius:S,maxOrbitRadius:M,orbitVisible:T,ownerKey:w})}if(aj(p,a,S),nj(p,a.id,S,r),ij(p,a.id,S,c),sj({node:p,system:a,baseRadius:S,planetLookup:o}),g&&a.orbitingPlanets.length>0){const w=ZM(a.orbitingPlanets,a.id.charCodeAt(0),i,a.id,l,o,d??null);p.add(w)}return p},oj=({group:a,systems:i,orbitBaseSpeed:l,colonizedLookup:o,planetAngleRef:r,planetLookupRef:c,recentCombatSystems:d,activeBattles:m,starVisuals:p,starRotations:y})=>{const v=new Map;return i.forEach(g=>{const b=o.get(g.id),_=lj(g,l,r,c,d,m,b,p),N=y?.get(g.id);if(N!==void 0){const M=_.getObjectByName("starVisual");M&&(M.rotation.z=N)}a.add(_),v.set(g.id,_.position.clone())}),v},xd=({group:a,positions:i,fromSystemId:l,toSystemId:o,lineMaterial:r,targetGeometry:c,targetMaterial:d,targetHeight:m,getVector:p,releaseVector:y})=>{const v=i.get(l),g=i.get(o);if(!v||!g)return;const b=p().set(v.x,v.y,v.z+.2),S=p().set(g.x,g.y,g.z+.2),_=[b,S],N=new Hn().setFromPoints(_),M=new J0(N,r);a.add(M);const T=new qe(c,d);T.position.set(g.x,g.y,g.z+m),a.add(T),y(b),y(S)},rj=({group:a,scienceShips:i,positions:l,scienceAnchorsRef:o,scienceMaterials:r,scienceLineMaterials:c,getVector:d,releaseVector:m})=>{const p=new sa;p.name="scienceTargets";const y=new Yi(.6,12,12),v=new Yi(.35,10,10);return o.length=0,["idle","traveling","surveying"].forEach(g=>{const b=i.filter(_=>_.status===g);if(b.length===0)return;const S=new eg(y,r[g]??r.idle,b.length);S.userData={entityKind:"science",instances:b},b.forEach((_,N)=>{if(o.push({mesh:S,index:N,systemId:_.currentSystemId,planetId:_.targetSystemId&&_.targetSystemId!==_.currentSystemId?null:_.anchorPlanetId??null,height:6}),_.targetSystemId&&_.targetSystemId!==_.currentSystemId){const M=c[g]??c.idle,T=r[g]??r.idle;xd({group:p,positions:l,fromSystemId:_.currentSystemId,toSystemId:_.targetSystemId,lineMaterial:M,targetGeometry:v,targetMaterial:T,targetHeight:1.5,getVector:d,releaseVector:m})}}),S.instanceMatrix.needsUpdate=!0,a.add(S)}),a.add(p),p},cj=/^[og]\s*(.+)?/,uj=/^mtllib /,dj=/^usemtl /,fj=/^usemap /,P0=/\s+/,I0=new Ne,td=new Ne,H0=new Ne,G0=new Ne,Ft=new Ne,Zo=new $t;function hj(){const a={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(i,l){if(this.object&&this.object.fromDeclaration===!1){this.object.name=i,this.object.fromDeclaration=l!==!1;return}const o=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:i||"",fromDeclaration:l!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(r,c){const d=this._finalize(!1);d&&(d.inherited||d.groupCount<=0)&&this.materials.splice(d.index,1);const m={index:this.materials.length,name:r||"",mtllib:Array.isArray(c)&&c.length>0?c[c.length-1]:"",smooth:d!==void 0?d.smooth:this.smooth,groupStart:d!==void 0?d.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(p){const y={index:typeof p=="number"?p:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return y.clone=this.clone.bind(y),y}};return this.materials.push(m),m},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(r){const c=this.currentMaterial();if(c&&c.groupEnd===-1&&(c.groupEnd=this.geometry.vertices.length/3,c.groupCount=c.groupEnd-c.groupStart,c.inherited=!1),r&&this.materials.length>1)for(let d=this.materials.length-1;d>=0;d--)this.materials[d].groupCount<=0&&this.materials.splice(d,1);return r&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),c}},o&&o.name&&typeof o.clone=="function"){const r=o.clone(0);r.inherited=!0,this.object.materials.push(r)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(i,l){const o=parseInt(i,10);return(o>=0?o-1:o+l/3)*3},parseNormalIndex:function(i,l){const o=parseInt(i,10);return(o>=0?o-1:o+l/3)*3},parseUVIndex:function(i,l){const o=parseInt(i,10);return(o>=0?o-1:o+l/2)*2},addVertex:function(i,l,o){const r=this.vertices,c=this.object.geometry.vertices;c.push(r[i+0],r[i+1],r[i+2]),c.push(r[l+0],r[l+1],r[l+2]),c.push(r[o+0],r[o+1],r[o+2])},addVertexPoint:function(i){const l=this.vertices;this.object.geometry.vertices.push(l[i+0],l[i+1],l[i+2])},addVertexLine:function(i){const l=this.vertices;this.object.geometry.vertices.push(l[i+0],l[i+1],l[i+2])},addNormal:function(i,l,o){const r=this.normals,c=this.object.geometry.normals;c.push(r[i+0],r[i+1],r[i+2]),c.push(r[l+0],r[l+1],r[l+2]),c.push(r[o+0],r[o+1],r[o+2])},addFaceNormal:function(i,l,o){const r=this.vertices,c=this.object.geometry.normals;I0.fromArray(r,i),td.fromArray(r,l),H0.fromArray(r,o),Ft.subVectors(H0,td),G0.subVectors(I0,td),Ft.cross(G0),Ft.normalize(),c.push(Ft.x,Ft.y,Ft.z),c.push(Ft.x,Ft.y,Ft.z),c.push(Ft.x,Ft.y,Ft.z)},addColor:function(i,l,o){const r=this.colors,c=this.object.geometry.colors;r[i]!==void 0&&c.push(r[i+0],r[i+1],r[i+2]),r[l]!==void 0&&c.push(r[l+0],r[l+1],r[l+2]),r[o]!==void 0&&c.push(r[o+0],r[o+1],r[o+2])},addUV:function(i,l,o){const r=this.uvs,c=this.object.geometry.uvs;c.push(r[i+0],r[i+1]),c.push(r[l+0],r[l+1]),c.push(r[o+0],r[o+1])},addDefaultUV:function(){const i=this.object.geometry.uvs;i.push(0,0),i.push(0,0),i.push(0,0)},addUVLine:function(i){const l=this.uvs;this.object.geometry.uvs.push(l[i+0],l[i+1])},addFace:function(i,l,o,r,c,d,m,p,y){const v=this.vertices.length;let g=this.parseVertexIndex(i,v),b=this.parseVertexIndex(l,v),S=this.parseVertexIndex(o,v);if(this.addVertex(g,b,S),this.addColor(g,b,S),m!==void 0&&m!==""){const _=this.normals.length;g=this.parseNormalIndex(m,_),b=this.parseNormalIndex(p,_),S=this.parseNormalIndex(y,_),this.addNormal(g,b,S)}else this.addFaceNormal(g,b,S);if(r!==void 0&&r!==""){const _=this.uvs.length;g=this.parseUVIndex(r,_),b=this.parseUVIndex(c,_),S=this.parseUVIndex(d,_),this.addUV(g,b,S),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(i){this.object.geometry.type="Points";const l=this.vertices.length;for(let o=0,r=i.length;o<r;o++){const c=this.parseVertexIndex(i[o],l);this.addVertexPoint(c),this.addColor(c)}},addLineGeometry:function(i,l){this.object.geometry.type="Line";const o=this.vertices.length,r=this.uvs.length;for(let c=0,d=i.length;c<d;c++)this.addVertexLine(this.parseVertexIndex(i[c],o));for(let c=0,d=l.length;c<d;c++)this.addUVLine(this.parseUVIndex(l[c],r))}};return a.startObject("",!1),a}class mj extends B1{constructor(i){super(i),this.materials=null}load(i,l,o,r){const c=this,d=new P1(this.manager);d.setPath(this.path),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials),d.load(i,function(m){try{l(c.parse(m))}catch(p){r?r(p):console.error(p),c.manager.itemError(i)}},o,r)}setMaterials(i){return this.materials=i,this}parse(i){const l=new hj;i.indexOf(`\r
`)!==-1&&(i=i.replace(/\r\n/g,`
`)),i.indexOf(`\\
`)!==-1&&(i=i.replace(/\\\n/g,""));const o=i.split(`
`);let r=[];for(let m=0,p=o.length;m<p;m++){const y=o[m].trimStart();if(y.length===0)continue;const v=y.charAt(0);if(v!=="#")if(v==="v"){const g=y.split(P0);switch(g[0]){case"v":l.vertices.push(parseFloat(g[1]),parseFloat(g[2]),parseFloat(g[3])),g.length>=7?(Zo.setRGB(parseFloat(g[4]),parseFloat(g[5]),parseFloat(g[6]),I1),l.colors.push(Zo.r,Zo.g,Zo.b)):l.colors.push(void 0,void 0,void 0);break;case"vn":l.normals.push(parseFloat(g[1]),parseFloat(g[2]),parseFloat(g[3]));break;case"vt":l.uvs.push(parseFloat(g[1]),parseFloat(g[2]));break}}else if(v==="f"){const b=y.slice(1).trim().split(P0),S=[];for(let N=0,M=b.length;N<M;N++){const T=b[N];if(T.length>0){const w=T.split("/");S.push(w)}}const _=S[0];for(let N=1,M=S.length-1;N<M;N++){const T=S[N],w=S[N+1];l.addFace(_[0],T[0],w[0],_[1],T[1],w[1],_[2],T[2],w[2])}}else if(v==="l"){const g=y.substring(1).trim().split(" ");let b=[];const S=[];if(y.indexOf("/")===-1)b=g;else for(let _=0,N=g.length;_<N;_++){const M=g[_].split("/");M[0]!==""&&b.push(M[0]),M[1]!==""&&S.push(M[1])}l.addLineGeometry(b,S)}else if(v==="p"){const b=y.slice(1).trim().split(" ");l.addPointGeometry(b)}else if((r=cj.exec(y))!==null){const g=(" "+r[0].slice(1).trim()).slice(1);l.startObject(g)}else if(dj.test(y))l.object.startMaterial(y.substring(7).trim(),l.materialLibraries);else if(uj.test(y))l.materialLibraries.push(y.substring(7).trim());else if(fj.test(y))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(v==="s"){if(r=y.split(" "),r.length>1){const b=r[1].trim().toLowerCase();l.object.smooth=b!=="0"&&b!=="off"}else l.object.smooth=!0;const g=l.object.currentMaterial();g&&(g.smooth=l.object.smooth)}else{if(y==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+y+'"')}}l.finalize();const c=new sa;if(c.materialLibraries=[].concat(l.materialLibraries),!(l.objects.length===1&&l.objects[0].geometry.vertices.length===0)===!0)for(let m=0,p=l.objects.length;m<p;m++){const y=l.objects[m],v=y.geometry,g=y.materials,b=v.type==="Line",S=v.type==="Points";let _=!1;if(v.vertices.length===0)continue;const N=new Hn;N.setAttribute("position",new dt(v.vertices,3)),v.normals.length>0&&N.setAttribute("normal",new dt(v.normals,3)),v.colors.length>0&&(_=!0,N.setAttribute("color",new dt(v.colors,3))),v.hasUVIndices===!0&&N.setAttribute("uv",new dt(v.uvs,2));const M=[];for(let w=0,z=g.length;w<z;w++){const D=g[w],A=D.name+"_"+D.smooth+"_"+_;let q=l.materials[A];if(this.materials!==null){if(q=this.materials.create(D.name),b&&q&&!(q instanceof vn)){const I=new vn;ld.prototype.copy.call(I,q),I.color.copy(q.color),q=I}else if(S&&q&&!(q instanceof al)){const I=new al({size:10,sizeAttenuation:!1});ld.prototype.copy.call(I,q),I.color.copy(q.color),I.map=q.map,q=I}}q===void 0&&(b?q=new vn:S?q=new al({size:1,sizeAttenuation:!1}):q=new H1,q.name=D.name,q.flatShading=!D.smooth,q.vertexColors=_,l.materials[A]=q),M.push(q)}let T;if(M.length>1){for(let w=0,z=g.length;w<z;w++){const D=g[w];N.addGroup(D.groupStart,D.groupCount,w)}b?T=new Pp(N,M):S?T=new In(N,M):T=new qe(N,M)}else b?T=new Pp(N,M[0]):S?T=new In(N,M[0]):T=new qe(N,M[0]);T.name=y.name,c.add(T)}else if(l.vertices.length>0){const m=new al({size:1,sizeAttenuation:!1}),p=new Hn;p.setAttribute("position",new dt(l.vertices,3)),l.colors.length>0&&l.colors[0]!==void 0&&(p.setAttribute("color",new dt(l.colors,3)),m.vertexColors=!0);const y=new In(p,m);c.add(y)}return c}}const pj=(()=>{let a=null;const i=new URL("/fls-node-epicronicles/assets/base-BArDsB-p.obj",import.meta.url).href,l=new URL("/fls-node-epicronicles/assets/texture_diffuse-D46mTWdC.png",import.meta.url).href,o=new URL("/fls-node-epicronicles/assets/texture_normal-VIRvFbwP.png",import.meta.url).href,r=new URL("/fls-node-epicronicles/assets/texture_roughness-C8XgDTct.png",import.meta.url).href,c=new URL("/fls-node-epicronicles/assets/texture_metallic-dvK-NG_7.png",import.meta.url).href;return()=>a||(a=new Promise((d,m)=>{const p=new mj,y=new G1,v=y.load(l),g=y.load(o),b=y.load(r),S=y.load(c);p.load(i,_=>{_.traverse(N=>{if(N.isMesh){const M=N;M.material=new Hi({map:v,normalMap:g,roughnessMap:b,metalnessMap:S,metalness:.6,roughness:.5,color:new $t("#9acfff"),emissive:new $t("#18354d"),emissiveIntensity:.25,side:Gn}),M.castShadow=!1,M.receiveShadow=!1}}),_.scale.set(1.8,1.8,1.8),_.rotation.x=Math.PI/2,d(_)},void 0,_=>m(_))}),a)})(),gj=a=>{const i=a.clone(!0);return i.traverse(l=>{if(l.isMesh){const o=l;Array.isArray(o.material)?o.material=o.material.map(r=>r.clone()):o.material&&(o.material=o.material.clone())}}),i},q0=(a,i)=>a.ships.some(l=>i.get(l.designId)?.role==="construction"),yj=({group:a,fleets:i,positions:l,empireWar:o,fleetAnchorsRef:r,fleetMaterials:c,getVector:d,releaseVector:m,shipDesignLookup:p})=>{const y=new sa;y.name="fleetTargets";const v=new Yi(.8,12,12),g=new q1(.5,.5,.5);return r.length=0,["idle","war"].forEach(b=>{const S=i.filter(()=>b==="war"?o:!o);if(S.length===0)return;const _=S.filter(M=>q0(M,p)),N=S.filter(M=>!q0(M,p));if(N.length>0){const M=b==="war"?c.war:c.idle,T=new eg(v,M,N.length);T.userData={entityKind:"fleet",instances:N},N.forEach((w,z)=>{if(r.push({mesh:T,index:z,systemId:w.systemId,planetId:w.targetSystemId&&w.targetSystemId!==w.systemId?null:w.anchorPlanetId??null,height:5}),w.targetSystemId&&w.targetSystemId!==w.systemId){const D=b==="war"?c.warLine:c.line,A=b==="war"?c.war:c.idle;xd({group:y,positions:l,fromSystemId:w.systemId,toSystemId:w.targetSystemId,lineMaterial:D,targetGeometry:g,targetMaterial:A,targetHeight:1.5,getVector:d,releaseVector:m})}}),T.instanceMatrix.needsUpdate=!0,a.add(T)}if(_.length>0){const M=b==="war"?c.warLine:c.line,T=b==="war"?c.war:c.idle,w=b==="war"?c.war:c.idle;pj().then(z=>{_.forEach(D=>{const A=new qe(v,w);A.scale.set(2.2,2.2,2.2),A.name="constructionPlaceholder";const q={object:A,systemId:D.systemId,planetId:D.targetSystemId&&D.targetSystemId!==D.systemId?null:D.anchorPlanetId??null,height:3};r.push(q),a.add(A);const I=gj(z);I.name="constructionShip",I.traverse(G=>{G.isMesh&&(G.castShadow=!1,G.receiveShadow=!1)}),I.position.copy(A.position),I.position.z+=q.height,a.add(I),a.remove(A),q.object=I,D.targetSystemId&&D.targetSystemId!==D.systemId&&xd({group:y,positions:l,fromSystemId:D.systemId,toSystemId:D.targetSystemId,lineMaterial:M,targetGeometry:g,targetMaterial:T,targetHeight:1.5,getVector:d,releaseVector:m})})}).catch(()=>{})}}),a.add(y),y},vj=a=>{const{group:i,systems:l,galaxyShape:o,galaxySeed:r,maxSystemRadius:c,orbitBaseSpeed:d,colonizedLookup:m,recentCombatSystems:p,activeBattles:y,starVisuals:v,scienceShips:g,fleets:b,empireWar:S,planetAngleRef:_,planetLookupRef:N,scienceMaterials:M,scienceLineMaterials:T,fleetMaterials:w,scienceAnchorsRef:z,fleetAnchorsRef:D,getVector:A,releaseVector:q,getMatrix:I,releaseMatrix:G,shipDesignLookup:F,starRotations:Z}=a,J=IM({group:i,systems:l,galaxyShape:o,galaxySeed:r,maxSystemRadius:c}),ee=oj({group:i,systems:l,orbitBaseSpeed:d,colonizedLookup:m,planetAngleRef:_,planetLookupRef:N,recentCombatSystems:p,activeBattles:y,starVisuals:v,starRotations:Z}),re=rj({group:i,scienceShips:g,positions:ee,scienceAnchorsRef:z,scienceMaterials:M,scienceLineMaterials:T,getVector:A,releaseVector:q}),de=yj({group:i,fleets:b,positions:ee,empireWar:S,fleetAnchorsRef:D,fleetMaterials:w,getVector:A,releaseVector:q,shipDesignLookup:F});return{nebula:J,positions:ee,scienceTargetGroup:re,fleetTargetGroup:de,updateAnchorInstances:()=>{const U=L=>{const K=ee.get(L.systemId);if(!K)return;const fe=L.planetId;let te=K;if(fe){const Ae=N.get(fe);if(Ae){const le=A();Ae.getWorldPosition(le),i.worldToLocal(le),le.z+=L.height,te=le}}if(L.mesh&&typeof L.index=="number"){const Ae=I().setPosition(te.x,te.y,te.z);L.mesh.setMatrixAt(L.index,Ae),L.mesh.instanceMatrix.needsUpdate=!0,G(Ae)}else L.object&&L.object.position.set(te.x,te.y,te.z);te!==K&&q(te)};z.forEach(U),D.forEach(U)}}},bj=a=>{const i=a;i.geometry&&i.geometry.dispose();const l=i.material;l&&(Array.isArray(l)?l:[l]).forEach(r=>{r.map?.dispose&&r.map.dispose(),r instanceof ld&&r.dispose()})},xj=(a,i)=>{a.children.forEach(l=>{const o=l.getObjectByName("orbits");o&&o.children.forEach(r=>{const c=r.userData?.planetId;c&&typeof r.userData?.orbitAngle=="number"&&i.set(c,r.userData.orbitAngle)})})},Sj=a=>{const i=new Map;return a.children.forEach(l=>{const o=l.userData?.systemId;if(!o)return;const r=l.getObjectByName("starVisual");r&&i.set(o,r.rotation.z)}),i},_j=a=>{a.traverse(i=>{i!==a&&bj(i)}),a.clear()},Nj=({systems:a,galaxyShape:i,galaxySeed:l,maxSystemRadius:o,orbitBaseSpeed:r,colonizedLookup:c,recentCombatSystems:d,activeBattles:m,starVisuals:p,scienceShips:y,fleets:v,empireWar:g,systemsSignature:b,scienceMaterials:S,scienceLineMaterials:_,fleetMaterials:N,shipDesignLookup:M})=>{const{sceneContext:T,cameraState:{systemGroupRef:w},anchorState:{systemPositionRef:z,planetAngleRef:D,planetLookupRef:A,systemsSignatureRef:q,nebulaRef:I,blackHoleRef:G,scienceAnchorsRef:F,fleetAnchorsRef:Z,anchorResolverRef:J}}=$i();j.useEffect(()=>{const ee=w.current??T?.systemGroup??null;if(!T||!ee||q.current===b)return;q.current=b,I.current&&(PM(I.current),I.current=null),xj(ee,D.current);const re=Sj(ee);_j(ee),A.current.clear();const de=J.current??vd(z.current,A.current),{nebula:Ee,positions:U,updateAnchorInstances:L}=vj({group:ee,systems:a,galaxyShape:i,galaxySeed:l,maxSystemRadius:o,orbitBaseSpeed:r,colonizedLookup:c,recentCombatSystems:d,activeBattles:m,starVisuals:p,scienceShips:y,fleets:v,empireWar:g,planetAngleRef:D.current,planetLookupRef:A.current,scienceMaterials:S,scienceLineMaterials:_,fleetMaterials:N,scienceAnchorsRef:F.current,fleetAnchorsRef:Z.current,getVector:de.getVector,releaseVector:de.releaseVector,getMatrix:de.getMatrix,releaseMatrix:de.releaseMatrix,shipDesignLookup:M,starRotations:re});I.current=Ee,z.current=U,J.current=vd(z.current,A.current),G.current&&(G.current.position.set(0,0,0),ee.add(G.current)),L()},[T,a,i,l,o,r,c,d,m,p,y,v,M,g,b,S,_,N,J,w,z,D,A,q,I,G,F,Z])},Ej=()=>{const a=new sa;a.name="blackHole";const i=[],l=0,o=new qe(new Yi(10,64,64),new yt({color:0,depthWrite:!0}));a.add(o);const r=new Kt({transparent:!0,depthWrite:!1,blending:pt,uniforms:{uTime:{value:0}},vertexShader:`
      precision mediump float;
      precision mediump int;
      varying vec2 vUv;
      void main() {
        vUv = uv;
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
      }
    `,fragmentShader:`
      precision mediump float;
      precision mediump int;
      varying vec2 vUv;
      uniform float uTime;
      void main() {
        vec2 uv = vUv - 0.5;
        float r = length(uv);
        float angle = atan(uv.y, uv.x);

        float inner = smoothstep(0.12, 0.16, r);
        float outer = 1.0 - smoothstep(0.56, 0.62, r);
        float disc = inner * outer;

        float beaming = 0.6 + 0.4 * cos(angle - uTime * 0.9);
        float swirl = sin(r * 32.0 - uTime * 2.5 + sin(angle * 6.0) * 0.4) * 0.03;
        float band = exp(-pow((r - 0.24 + swirl) * 16.0, 2.0));

        vec3 warm = vec3(1.15, 0.95, 0.8);
        vec3 cool = vec3(0.45, 0.65, 1.0);
        vec3 color = mix(cool, warm, 0.55 + 0.45 * beaming);
        color *= band * disc * 0.6;

        float alpha = clamp(disc * (0.2 + 0.2 * band), 0.0, 0.6);
        gl_FragColor = vec4(color, alpha);
      }
    `});i.push(r);const c=new Kt({transparent:!0,depthWrite:!1,blending:pt,uniforms:{uTime:{value:0}},vertexShader:`
      precision mediump float;
      precision mediump int;
      varying vec2 vUv;
      void main() {
        vUv = uv;
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
      }
    `,fragmentShader:`
      precision mediump float;
      precision mediump int;
      varying vec2 vUv;
      uniform float uTime;
      void main() {
        vec2 uv = vUv - 0.5;
        float r = length(uv);
        float angle = atan(uv.y, uv.x);

        float inner = smoothstep(0.14, 0.18, r);
        float outer = 1.0 - smoothstep(0.48, 0.52, r);
        float disc = inner * outer;

        float beaming = 0.6 + 0.4 * cos(angle - uTime * 0.8);
        float swirl = sin(r * 28.0 - uTime * 2.0) * 0.2;
        float band = exp(-pow((r - 0.28 + swirl * 0.01) * 10.0, 2.0));

        vec3 warm = vec3(1.2, 1.0, 0.85);
        vec3 cool = vec3(0.4, 0.6, 1.0);
        vec3 color = mix(cool, warm, 0.65 + 0.35 * beaming);
        color *= band * disc * 0.55;

        float glow = 1.0 - smoothstep(0.5, 0.9, r);
        color += vec3(0.1, 0.15, 0.25) * glow * 0.4;

        float alpha = clamp(disc * 0.8, 0.0, 0.5) * (0.25 + 0.35 * band);
        gl_FragColor = vec4(color, alpha);
      }
    `});i.push(c);const d=new qe(new qi(200,200,1,1),r);d.name="accretionOuter",d.rotation.set(l,0,0),a.add(d);const m=new qe(new qi(170,170,1,1),c);m.name="accretionInner",m.rotation.set(l,0,0),m.position.set(0,0,.15),a.add(m);const p=new Kt({transparent:!0,depthWrite:!1,blending:pt,uniforms:{uTime:{value:0}},vertexShader:`
      precision mediump float;
      precision mediump int;
      varying vec2 vUv;
      void main() {
        vUv = uv;
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
      }
    `,fragmentShader:`
      precision mediump float;
      precision mediump int;
      varying vec2 vUv;
      uniform float uTime;
      void main() {
        vec2 uv = vUv - 0.5;
        float r = length(uv);
        float ring = smoothstep(0.32, 0.34, r) * (1.0 - smoothstep(0.38, 0.42, r));
        float pulse = 0.75 + 0.25 * sin(uTime * 1.2 + r * 8.0);
        vec3 color = mix(vec3(0.85, 0.9, 1.0), vec3(1.0, 0.9, 0.8), ring) * pulse;
        gl_FragColor = vec4(color, ring * 0.6);
      }
    `});i.push(p);const y=new qe(new qi(220,220,1,1),p);return y.name="glow",y.rotation.set(l,0,0),y.position.set(0,0,.2),a.add(y),a.userData.shaderMaterials=i,a},Mj=()=>{const{sceneContext:a,anchorState:{blackHoleRef:i}}=$i();j.useEffect(()=>{const l=a?.systemGroup??null;if(!a||!l)return;const o=Ej();return i.current=o,l.add(o),()=>{i.current&&l&&l.remove(i.current),i.current=null}},[a,i])},jj=({focusSystemId:a,focusPlanetId:i,focusTrigger:l,systems:o,onClearFocus:r})=>{const{focusOnPosition:c,focusOnObject:d,clampZoom:m}=iy(),{cameraState:{systemGroupRef:p},sceneContext:y}=$i(),v=j.useRef(null),g=j.useRef(null),b=j.useRef({id:null,trigger:-1});j.useEffect(()=>{y&&(b.current={id:null,trigger:-1},v.current=null,g.current=null)},[y]),j.useEffect(()=>{if(!a||i){a||(v.current=null,b.current={id:null,trigger:-1});return}if(b.current.id===a&&b.current.trigger===l)return;const _=o.find(M=>M.id===a);if(!_)return;if(_.visibility==="unknown"){r?.();return}const N={x:_.mapPosition?.x??_.position.x,y:_.mapPosition?.y??_.position.y};c(N,{zoom:60,immediate:!0}),v.current=a,b.current={id:a,trigger:l}},[a,i,o,r,l,c]),j.useEffect(()=>{if(!i){g.current=null;return}if(g.current===i)return;const S=p.current?.getObjectByProperty("userData.planetId",i);if(S){d(S,{zoom:m(70),immediate:!0}),g.current=i;return}const _=o.find(N=>N.id===a)??null;if(_){const N={x:_.mapPosition?.x??_.position.x,y:_.mapPosition?.y??_.position.y};c(N,{zoom:60,immediate:!0})}g.current=i},[i,o,a,d,c,m,p])},wj=({data:a,focusSystemId:i,focusPlanetId:l,focusTrigger:o,onPlanetSelect:r,onShipyardSelect:c,onClearFocus:d,onSelectRef:m,onClearRef:p})=>{const{refs:y}=$i(),{containerRef:v}=y;return Mj(),TM({onSelectRef:m,onClearRef:p,onPlanetSelect:r,onShipyardSelect:c}),Nj({systems:a.systems,galaxyShape:a.galaxyShape,galaxySeed:a.galaxySeed,maxSystemRadius:a.maxSystemRadius,orbitBaseSpeed:a.orbitBaseSpeed,colonizedLookup:a.colonizedLookup,recentCombatSystems:a.recentCombatSystems,activeBattles:a.activeBattles,starVisuals:a.starVisuals,scienceShips:a.scienceShips,fleets:a.fleets,empireWar:a.empireWar,systemsSignature:a.systemsSignature,scienceMaterials:GM,scienceLineMaterials:qM,fleetMaterials:YM,shipDesignLookup:a.shipDesignLookup}),jj({focusSystemId:i,focusPlanetId:l,focusTrigger:o,systems:a.systems,onClearFocus:d}),f.jsx("div",{className:"galaxy-map",ref:v})},Tj=({data:a,refs:i,sceneContext:l})=>{const{cameraState:o,anchorState:r}=i;return j.useMemo(()=>({cameraState:o,anchorState:r,refs:i,sceneContext:l,minZoom:a.minZoom,maxZoom:a.maxZoom,baseTilt:Math.PI/2,maxTiltDown:Math.PI/2+Math.PI/6}),[r,o,i,l,a.minZoom,a.maxZoom])},Cj=({focusSystemId:a,focusPlanetId:i,focusTrigger:l=0,onSystemSelect:o,onPlanetSelect:r,onShipyardSelect:c,onClearFocus:d})=>{const m=XE(),p=j.useRef(o),y=j.useRef(d);j.useEffect(()=>{p.current=o,y.current=d},[d,o]);const v=YE(),{containerRef:g,systemGroupRef:b,offsetTargetRef:S,zoomTargetRef:_,zoomTargetDirtyRef:N,tiltStateRef:M,tempSphericalRef:T,tempOffsetRef:w,systemPositionRef:z,scienceAnchorsRef:D,fleetAnchorsRef:A,planetAngleRef:q,planetLookupRef:I,blackHoleRef:G,nebulaRef:F,anchorResolverRef:Z,syncSceneContext:J}=m,ee=j.useCallback((Ee,U,L)=>{Z.current||(Z.current=vd(z.current,I.current)),!(!Z.current||!b.current)&&EM({ctx:Ee,delta:U,elapsed:L,minZoom:v.minZoom,maxZoom:v.maxZoom,offsetTargetRef:S,zoomTargetRef:_,tiltStateRef:M,tempSphericalRef:T,tempOffsetRef:w,planetAngleRef:q,nebulaRef:F,blackHoleRef:G,scienceAnchors:D.current,fleetAnchors:A.current,updateAnchors:Z.current.updateAnchors,zoomTargetDirtyRef:N})},[v.maxZoom,v.minZoom,Z,z,I,S,_,N,M,T,w,q,F,G,D,A,b]),re=yM({containerRef:g,minZoom:v.minZoom,maxZoom:v.maxZoom,onFrame:ee});j.useEffect(()=>{re&&J(re)},[re,J]);const de=Tj({data:v,refs:m,sceneContext:re});return f.jsx(VE,{value:de,children:f.jsx(wj,{data:v,focusSystemId:a??null,focusPlanetId:i??null,focusTrigger:l,onPlanetSelect:r,onShipyardSelect:c,onClearFocus:d,onSelectRef:p,onClearRef:y})})},zj=({focusSystemId:a,focusPlanetId:i,focusTrigger:l=0,mapMessage:o,onSelectSystem:r,onSelectPlanet:c,onSelectShipyard:d,onClearFocus:m})=>f.jsxs("div",{className:"game-map-layer",children:[f.jsx(Cj,{focusSystemId:a,focusPlanetId:i,focusTrigger:l,onSystemSelect:r,onPlanetSelect:c,onShipyardSelect:d,onClearFocus:m}),o?f.jsx("div",{className:"map-alert",children:o}):null]}),Dj="modulepreload",Rj=function(a){return"/fls-node-epicronicles/"+a},Y0={},Aj=function(i,l,o){let r=Promise.resolve();if(l&&l.length>0){let p=function(y){return Promise.all(y.map(v=>Promise.resolve(v).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),m=d?.nonce||d?.getAttribute("nonce");r=p(l.map(y=>{if(y=Rj(y),y in Y0)return;Y0[y]=!0;const v=y.endsWith(".css"),g=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${g}`))return;const b=document.createElement("link");if(b.rel=v?"stylesheet":Dj,v||(b.as="script"),b.crossOrigin="",b.href=y,m&&b.setAttribute("nonce",m),document.head.appendChild(b),v)return new Promise((S,_)=>{b.addEventListener("load",S),b.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${y}`)))})}))}function c(d){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=d,window.dispatchEvent(m),!m.defaultPrevented)throw d}return r.then(d=>{for(const m of d||[])m.status==="rejected"&&c(m.reason);return i().catch(c)})},kj={O:{label:"Gigante blu (Classe O)",temperature:"30.000-50.000 K"},B:{label:"Blu-bianca (Classe B)",temperature:"10.000-30.000 K"},A:{label:"Bianca (Classe A)",temperature:"7.500-10.000 K"},F:{label:"Bianco-gialla (Classe F)",temperature:"6.000-7.500 K"},G:{label:"Gialla (Classe G)",temperature:"5.200-6.000 K"},K:{label:"Arancio (Classe K)",temperature:"3.700-5.200 K"},M:{label:"Rossa (Classe M)",temperature:"2.400-3.700 K"}},Oj=({system:a,ownerLabel:i,shipyardLabel:l,onClose:o})=>{const r=kj[a.starClass]??{label:`Classe ${a.starClass}`,temperature:"-"};return f.jsxs("div",{className:"system-mini-panel",children:[f.jsxs("header",{className:"system-mini-panel__header",children:[f.jsxs("div",{children:[f.jsx("p",{className:"system-mini-panel__eyebrow",children:"Stella"}),f.jsx("h4",{className:"system-mini-panel__title",children:a.name})]}),f.jsx("button",{className:"system-mini-panel__close",onClick:o,children:"X"})]}),f.jsxs("div",{className:"system-mini-panel__rows",children:[f.jsxs("div",{className:"system-mini-panel__row",children:[f.jsx("span",{className:"text-muted",children:"Tipologia"}),f.jsx("span",{children:r.label})]}),f.jsxs("div",{className:"system-mini-panel__row",children:[f.jsx("span",{className:"text-muted",children:"Temperatura"}),f.jsx("span",{children:r.temperature})]}),f.jsxs("div",{className:"system-mini-panel__row",children:[f.jsx("span",{className:"text-muted",children:"Stato"}),f.jsx("span",{children:a.visibility==="surveyed"?"Sondato":a.visibility==="revealed"?"Rivelato":"Sconosciuto"})]}),f.jsxs("div",{className:"system-mini-panel__row",children:[f.jsx("span",{className:"text-muted",children:"Proprietario"}),f.jsx("span",{children:i(a.ownerId)})]}),f.jsxs("div",{className:"system-mini-panel__row",children:[f.jsx("span",{className:"text-muted",children:"Minaccia"}),f.jsx("span",{children:a.hostilePower??0})]}),f.jsxs("div",{className:"system-mini-panel__row",children:[f.jsx("span",{className:"text-muted",children:"Cantiere"}),f.jsx("span",{children:l(a)})]}),f.jsxs("div",{className:"system-mini-panel__row",children:[f.jsx("span",{className:"text-muted",children:"Pianeti"}),f.jsx("span",{children:a.orbitingPlanets?.length??0})]})]})]})},Uj=({planet:a,orbitingPlanet:i,system:l,onClose:o})=>f.jsxs("div",{className:"planet-mini-panel",children:[f.jsxs("header",{className:"system-mini-panel__header",children:[f.jsxs("div",{children:[f.jsx("p",{className:"system-mini-panel__eyebrow",children:"Pianeta"}),f.jsx("h4",{className:"system-mini-panel__title",children:a?.name??i?.name??"Pianeta"}),f.jsx("small",{className:"text-muted",children:l?.name??"Sistema sconosciuto"})]}),f.jsx("button",{className:"system-mini-panel__close",onClick:o,children:"X"})]}),f.jsxs("div",{className:"system-mini-panel__rows",children:[f.jsxs("div",{className:"system-mini-panel__row",children:[f.jsx("span",{className:"text-muted",children:"Tipo"}),f.jsx("span",{children:a?.kind??"Sconosciuto"})]}),f.jsxs("div",{className:"system-mini-panel__row",children:[f.jsx("span",{className:"text-muted",children:"Abitabilit"}),f.jsx("span",{children:a?`${Math.round(a.habitability)}%`:"Sconosciuta"})]}),f.jsxs("div",{className:"system-mini-panel__row",children:[f.jsx("span",{className:"text-muted",children:"Dimensione"}),f.jsx("span",{children:a?.size??i?.size??"?"})]}),f.jsxs("div",{className:"system-mini-panel__row",children:[f.jsx("span",{className:"text-muted",children:"Popolazione"}),f.jsx("span",{children:a?.population?.total??0})]}),f.jsxs("div",{className:"system-mini-panel__row",children:[f.jsx("span",{className:"text-muted",children:"Distretto"}),f.jsx("span",{children:a?Object.values(a.districts??{}).reduce((r,c)=>r+(c??0),0):0})]})]})]}),Lj=j.lazy(()=>Aj(()=>import("./index-DoZ3Ovpb.js"),__vite__mapDeps([0,1,2,3])).then(a=>({default:a.ShipyardWindow}))),Bj=({focusedSystem:a,focusedPlanet:i,focusedOrbitingPlanet:l,focusedPlanetSystem:o,viewportWidth:r,viewportHeight:c,onClearFocusTargets:d,shipyardSystem:m,closeShipyard:p})=>{const y=Math.min(1280,r-60),v=Math.min(780,c-80),g=Math.max(20,(r-y)/2),b=Math.max(20,(c-v)/2),S=N=>N?N==="player"?"Noi":N:"Indefinito",_=N=>N?N.shipyardBuild?`In costruzione (${Math.round((1-N.shipyardBuild.ticksRemaining/Math.max(1,N.shipyardBuild.totalTicks))*100)}%)`:N.hasShipyard?"Presente":"Assente":"";return f.jsxs("div",{className:"floating-panels",children:[a&&!i?f.jsx(Oj,{system:a,ownerLabel:S,shipyardLabel:_,onClose:d}):null,i||l?f.jsx(Uj,{planet:i,orbitingPlanet:l,system:o,onClose:d}):null,m?f.jsx(Lt,{title:`Cantieri - ${m.name}`,initialX:g,initialY:b,initialWidth:y,initialHeight:v,onClose:p,children:f.jsx(j.Suspense,{fallback:f.jsx("p",{className:"text-muted",children:"Caricamento..."}),children:f.jsx(Lj,{system:m})})}):null]})},Sd="warSeen",Pj=a=>{if(typeof localStorage>"u")return null;try{const i=localStorage.getItem(Sd);return i?JSON.parse(i)[a]??null:null}catch{return null}},V0=(a,i)=>{if(!(typeof localStorage>"u"))try{const l=localStorage.getItem(Sd),o=l?JSON.parse(l):{};i?o[a]=i:delete o[a],localStorage.setItem(Sd,JSON.stringify(o))}catch{}},Ij=a=>{const[i,l]=j.useState(null);j.useEffect(()=>{if(!a){l(null);return}const d=Pj(a.id);l(d)},[a]);const o=j.useMemo(()=>{if(!a)return new Set;if(!i)return new Set(a.warEvents.map(p=>p.id));const d=a.warEvents.findIndex(p=>p.id===i),m=d>=0?a.warEvents.slice(d+1):a.warEvents;return new Set(m.map(p=>p.id))},[a,i]);return{warUnread:o.size,lastSeenWarId:i,setLastSeenWarId:l,unreadWarIds:o,markWarsRead:()=>{if(!a?.warEvents?.length){l(null);return}const d=a.warEvents.at(-1)?.id??null;l(d),a&&V0(a.id,d)},persistLastSeen:d=>{a&&V0(a.id,d)}}},Hj={preparing:"Allestimento",traveling:"In viaggio",colonizing:"Insediamento"},Gj={preparing:"is-preparing",traveling:"is-traveling",colonizing:"is-colonizing"},qj=a=>a.missionTotalTicks<=0?0:Math.round(Math.min(1,a.missionElapsedTicks/a.missionTotalTicks)*100),Yj=a=>a.totalTicks<=0?"0/0 tick":`${Math.max(0,a.totalTicks-a.ticksRemaining)}/${a.totalTicks} tick`,Vj=()=>{const a=we(Lg),i=we(Ki),l=j.useMemo(()=>a.map(o=>({task:o,system:i.find(r=>r.id===o.systemId)??null,missionProgress:qj(o),stageProgress:Yj(o)})),[a,i]);return f.jsxs("div",{className:"missions-panel",children:[f.jsxs("header",{className:"missions-panel__header",children:[f.jsxs("div",{children:[f.jsx("p",{className:"missions-panel__eyebrow",children:"Riepilogo missioni"}),f.jsx("h2",{children:"Missioni in corso"})]}),f.jsxs("div",{className:"missions-panel__summary",children:[f.jsxs("span",{className:"pill",children:["Totali: ",f.jsx("strong",{children:a.length})]}),f.jsxs("span",{className:"pill pill--success",children:["In corso: ",f.jsx("strong",{children:a.filter(o=>o.status!=="preparing").length})]})]})]}),l.length===0?f.jsx("p",{className:"text-muted",children:"Nessuna missione attiva."}):f.jsx("div",{className:"missions-grid",children:l.map(({task:o,system:r,missionProgress:c,stageProgress:d})=>f.jsxs("div",{className:"mission-card",children:[f.jsxs("div",{className:"mission-card__head",children:[f.jsxs("div",{children:[f.jsx("p",{className:"mission-card__eyebrow",children:"Colonizzazione"}),f.jsx("h3",{children:r?.name??o.systemId}),f.jsx("span",{className:`colonization-status ${Gj[o.status]}`,children:Hj[o.status]})]}),f.jsxs("div",{className:"mission-card__progress",children:[f.jsxs("span",{className:"mission-card__percent",children:[c,"%"]}),f.jsxs("small",{children:["Missione ",o.missionElapsedTicks,"/",o.missionTotalTicks," ","tick"]})]})]}),f.jsxs("div",{className:"mission-card__body",children:[f.jsx("div",{className:"mission-card__bar",children:f.jsx("div",{className:"mission-card__bar-fill",style:{width:`${c}%`}})}),f.jsxs("div",{className:"mission-card__meta",children:[f.jsxs("span",{children:["Stadio: ",d]}),f.jsxs("span",{children:["Durata stimata: ",o.totalTicks," tick"]})]})]})]},o.id))})]})},Xj=({onOpenMissions:a,onOpenEvents:i,onOpenDiplomacy:l,onOpenEconomy:o,onOpenResearch:r,onOpenGalaxy:c,onOpenColonization:d,onOpenBattles:m,onOpenLog:p,showColonization:y=!0})=>f.jsx("aside",{className:"side-dock",children:f.jsxs("div",{className:"side-dock__items",children:[f.jsx("button",{type:"button",className:"side-dock__btn",onClick:p,"aria-label":"Log eventi","data-tooltip":"Log eventi",children:f.jsx(NE,{size:18})}),f.jsx("button",{type:"button",className:"side-dock__btn",onClick:a,"aria-label":"Missioni in corso","data-tooltip":"Missioni in corso",children:f.jsx(pE,{size:18})}),f.jsx("button",{type:"button",className:"side-dock__btn",onClick:i,"aria-label":"Eventi e anomalie","data-tooltip":"Eventi e anomalie",children:f.jsx(wE,{size:18})}),f.jsx("button",{type:"button",className:"side-dock__btn",onClick:l,"aria-label":"Diplomazia","data-tooltip":"Diplomazia",children:f.jsx(KN,{size:18})}),f.jsx("button",{type:"button",className:"side-dock__btn",onClick:o,"aria-label":"Bilancio economico","data-tooltip":"Bilancio economico",children:f.jsx(LN,{size:18})}),f.jsx("button",{type:"button",className:"side-dock__btn",onClick:r,"aria-label":"Ricerca & Tradizioni","data-tooltip":"Ricerca & Tradizioni",children:f.jsx(Id,{size:18})}),y?f.jsx("button",{type:"button",className:"side-dock__btn",onClick:d,"aria-label":"Colonizzazione","data-tooltip":"Colonizzazione",children:f.jsx(VN,{size:18})}):null,f.jsx("button",{type:"button",className:"side-dock__btn",onClick:m,"aria-label":"Flotte & Battaglie","data-tooltip":"Flotte & Battaglie",children:f.jsx(ey,{size:18})}),f.jsx("button",{type:"button",className:"side-dock__btn",onClick:c,"aria-label":"Panoramica galassia","data-tooltip":"Panoramica galassia",children:f.jsx(nE,{size:18})})]})}),Qj={peace:"Pace",war:"Guerra"},Zj=a=>a>=25?"Amichevole":a<=-25?"Ostile":"Neutro",Fj=a=>a>=25?"sentiment-positive":a<=-25?"sentiment-negative":"sentiment-neutral",X0={NO_SESSION:"Nessuna sessione attiva.",EMPIRE_NOT_FOUND:"Impero non trovato.",INVALID_TARGET:"Bersaglio non valido.",ALREADY_IN_STATE:"Stato diplomatico invariato.",ALREADY_GRANTED:"Confini gia aperti."},Kj=(a,i)=>i==="war"?`Guerra dichiarata a ${a.name}.`:`Pace proposta a ${a.name}.`,$j=()=>{const a=$(b=>!!b.session),i=we(kg),l=$(b=>b.declareWarOnEmpire),o=$(b=>b.proposePeaceWithEmpire),r=$(b=>b.requestBorderAccess),[c,d]=j.useState(null),m=j.useMemo(()=>i.filter(b=>b.kind==="ai"),[i]),p=m.filter(b=>b.warStatus==="war").length,y=m.length-p;if(!a)return f.jsx("p",{className:"text-muted",children:"Nessuna sessione attiva."});const v=(b,S)=>{const _=S==="war"?l(b.id):o(b.id);_.success?d(Kj(b,S)):d(X0[_.reason]??"Azione non disponibile.")},g=b=>{const S=r(b.id);S.success?d(`${b.name} apre i confini al giocatore.`):d(X0[S.reason]??"Richiesta non accettata.")};return f.jsxs("section",{className:"diplomacy-panel",children:[f.jsxs("header",{className:"diplomacy-panel__header",children:[f.jsxs("div",{children:[f.jsx("p",{className:"diplomacy-panel__eyebrow",children:"Relazioni tra imperi"}),f.jsx("h2",{children:"Diplomazia"}),f.jsx("p",{className:"text-muted",children:"Gestisci stati di guerra, pace e accesso ai confini con gli imperi conosciuti."})]}),f.jsxs("div",{className:"diplomacy-panel__summary",children:[f.jsxs("span",{className:"pill pill--success",children:["Pace: ",f.jsx("strong",{children:y})]}),f.jsxs("span",{className:"pill pill--alert",children:["Guerre: ",f.jsx("strong",{children:p})]})]})]}),c?f.jsx("p",{className:"panel-message",children:c}):null,m.length===0?f.jsx("p",{className:"text-muted",children:"Nessun altro impero conosciuto."}):f.jsx("div",{className:"diplomacy-grid",children:m.map(b=>f.jsxs("div",{className:"diplomacy-card",children:[f.jsxs("div",{className:"diplomacy-card__head",children:[f.jsxs("div",{children:[f.jsx("p",{className:"diplomacy-card__eyebrow",children:"Impero"}),f.jsx("h3",{children:b.name}),f.jsx("span",{className:`diplomacy-status status-${b.warStatus}`,children:Qj[b.warStatus]})]}),f.jsxs("div",{className:"diplomacy-card__sentiment",children:[f.jsx("span",{className:`sentiment-badge ${Fj(b.opinion)}`,children:Zj(b.opinion)}),f.jsxs("small",{children:["Opinione: ",b.opinion]})]})]}),f.jsxs("div",{className:"diplomacy-card__body",children:[f.jsxs("div",{className:"diplomacy-meta",children:[f.jsxs("span",{children:["Personalit:"," ",f.jsx("strong",{children:b.personality??"Sconosciuta"})]}),f.jsxs("span",{children:["Confini:"," ",f.jsx("strong",{children:b.accessToPlayer?"Aperti":"Chiusi"})]})]}),f.jsxs("div",{className:"diplomacy-actions",children:[b.warStatus==="peace"?f.jsx("button",{className:"panel__action panel__action--compact",onClick:()=>v(b,"war"),children:"Dichiara guerra"}):f.jsx("button",{className:"panel__action panel__action--compact",onClick:()=>v(b,"peace"),children:"Proponi pace"}),b.warStatus==="peace"?f.jsx("button",{className:"panel__action panel__action--compact",onClick:()=>g(b),disabled:b.accessToPlayer,children:"Richiedi accesso confini"}):null]})]})]},b.id))})]})},sl=a=>Object.entries(a).filter(([,i])=>i&&i>0).map(([i,l])=>`${pl[i]} ${l}`).join(" | "),Pi=a=>{if(Math.abs(a)<.001)return"+0";const i=Math.abs(a),o=Math.abs(Math.round(i)-i)<.01?Math.round(i).toString():i.toFixed(1);return`${a>=0?"+":"-"}${o}`},ad=["energy","minerals","food","research","influence"],Wj=a=>a>=0?"economy-pill is-positive":"economy-pill is-negative",Jj=()=>{const a=we(Od),i=we(mr),l=we(l_),o=j.useMemo(()=>!a||!l?null:{net:l,resources:a},[a,l]);if(!o)return f.jsx("p",{className:"text-muted",children:"Nessuna informazione economica."});const r=ad.reduce((c,d)=>c+o.resources[d].amount,0);return f.jsxs("section",{className:"economy-modal",children:[f.jsxs("header",{className:"economy-modal__header",children:[f.jsxs("div",{children:[f.jsx("p",{className:"economy-modal__eyebrow",children:"Risorse & flussi"}),f.jsx("h2",{children:"Bilancio economico"}),f.jsxs("p",{className:"text-muted",children:["Produzione, consumi e riserve aggregate. Colonie attive: ",i.length]})]}),f.jsxs("div",{className:"economy-modal__summary",children:[f.jsxs("span",{className:"pill pill--success",children:["Riserve totali: ",f.jsx("strong",{children:r.toFixed(0)})]}),f.jsxs("span",{className:"pill",children:["Risorse monitorate: ",f.jsx("strong",{children:ad.length})]})]})]}),f.jsx("div",{className:"economy-grid",children:ad.map(c=>{const d=o.resources[c],m=o.net[c];return f.jsxs("div",{className:"economy-card",children:[f.jsx("div",{className:"economy-card__head",children:f.jsxs("div",{children:[f.jsx("p",{className:"economy-card__eyebrow",children:pl[c]}),f.jsx("h3",{children:d.amount.toFixed(1)}),f.jsxs("span",{className:Wj(m),children:["Net ",Pi(m)]})]})}),f.jsxs("div",{className:"economy-card__body",children:[f.jsxs("div",{className:"economy-meta",children:[f.jsxs("span",{children:["Produzione: +",d.income.toFixed(1)]}),f.jsxs("span",{children:["Consumo: -",d.upkeep.toFixed(1)]})]}),f.jsx("div",{className:"economy-progress",children:f.jsx("div",{className:"economy-progress__fill",style:{width:`${Math.min(100,Math.max(0,d.income))}%`}})})]})]},c)})})]})},ew=a=>a==="crisis"?"Crisi":a==="anomaly"?"Anomalia":"Evento",tw=({option:a,affordable:i,onSelect:l})=>{const o=S2(a);return f.jsxs("button",{className:`event-option ${i?"":"is-disabled"}`,onClick:()=>l(a),disabled:!i,children:[f.jsxs("div",{className:"event-option__header",children:[f.jsx("span",{className:"event-option__title",children:a.label}),o?f.jsx("span",{className:"event-option__cost",children:o}):null]}),f.jsx("p",{className:"event-option__desc",children:a.description})]},a.id)},aw=()=>{const a=we(i_),i=we(Ug),l=$(y=>y.session),o=$(y=>y.resolveActiveEvent),[r,c]=j.useState(null),d=a?.active??null,m=j.useMemo(()=>a?.log??[],[a]);if(!l)return f.jsx("p",{className:"text-muted",children:"Nessuna sessione attiva."});const p=y=>{if(!d)return;const v=o(y.id);c(v.success?"Evento risolto.":"Azione non disponibile.")};return f.jsx("div",{className:"event-panel-modern",children:f.jsxs("div",{className:"event-panel-modern__body",children:[f.jsxs("section",{className:"event-panel-modern__active",children:[f.jsxs("header",{className:"event-panel-modern__header",children:[f.jsx("div",{className:"pill pill--muted",children:"In corso"}),f.jsxs("div",{className:"event-panel-modern__meta",children:[f.jsxs("span",{className:"pill",children:["Tick ",i]}),r?f.jsx("span",{className:"pill pill--success",children:r}):null]})]}),d?f.jsxs("div",{className:"event-hero",children:[f.jsx("div",{className:"event-hero__badge",children:ew(d.kind)}),f.jsx("div",{className:"event-hero__title",children:d.title}),f.jsx("p",{className:"event-hero__desc",children:d.description}),f.jsx("div",{className:"event-hero__options",children:d.options.map(y=>f.jsx(tw,{option:y,affordable:Xg(l,y),onSelect:p},y.id))})]}):f.jsxs("div",{className:"event-empty",children:[f.jsx("p",{className:"eyebrow",children:"Nessun evento attivo"}),f.jsx("p",{className:"text-muted",children:"Attendi l'arrivo di nuove anomalie o notifiche."})]})]}),f.jsxs("section",{className:"event-panel-modern__log",children:[f.jsx("header",{className:"event-log__header",children:f.jsx("p",{className:"eyebrow",children:"Registro"})}),f.jsx("div",{className:"event-timeline",children:m.length===0?f.jsx("p",{className:"text-muted",children:"Ancora nessun evento risolto."}):f.jsx("ul",{children:m.slice().reverse().map(y=>f.jsxs("li",{className:"event-timeline__item",children:[f.jsxs("div",{className:"event-timeline__meta",children:[f.jsxs("span",{className:"pill",children:["Tick ",y.tick]}),f.jsx("span",{className:"event-timeline__title",children:y.title})]}),f.jsx("p",{className:"event-timeline__result",children:y.result})]},y.id))})})]})]})})},Q0={foundation:"Fondamenta",feature:"Feature",rare:"Rara"};function Z0(a,i){const l={};return a.forEach(o=>{const r=i(o);l[r]||(l[r]=[]),l[r].push(o)}),l}const nw=()=>{const a=we(Og),i=we(n_),l=$(G=>G.config),o=$(G=>G.beginResearch),r=$(G=>G.unlockTraditionPerk),[c,d]=j.useState(null),[m,p]=j.useState(!1),[y,v]=j.useState(!1),[g,b]=j.useState(!1),S=l.research.branches,_=j.useMemo(()=>i?H_(i,l.traditions):[],[i,l.traditions]),N=j.useMemo(()=>a?.exclusivePicks?Object.entries(a.exclusivePicks).map(([G,F])=>({group:G,name:l.research.techs.find(Z=>Z.id===F)?.name??F})):[],[l.research.techs,a]),M=j.useMemo(()=>i?.exclusivePicks?Object.entries(i.exclusivePicks).map(([G,F])=>({group:G,name:l.traditions.perks.find(Z=>Z.id===F)?.name??F})):[],[l.traditions.perks,i]),T=(G,F)=>{const Z=o(G,F);d(Z.success?"Ricerca avviata.":"Impossibile avviare: requisiti o risorse mancanti.")},w=G=>{const F=r(G);d(F.success?"Tradizione sbloccata.":"Punti insufficienti o prerequisiti mancanti.")},z=(G,F,Z,J)=>{const ee=Z==="relic"?"tech-card__badge--relic":Z==="anomaly"?"tech-card__badge--anomaly":Z==="faction"?"tech-card__badge--faction":"tech-card__badge--muted";return f.jsxs("span",{className:"tech-card__badges",children:[f.jsxs("span",{className:"tech-card__badge tech-card__badge--muted",children:["Era ",G||1]}),F?f.jsx("span",{className:"tech-card__badge tech-card__badge--muted",children:Q0[F]?Q0[F]:F}):null,Z&&Z!=="standard"?f.jsx("span",{className:`tech-card__badge ${ee}`,children:Z}):null,J?f.jsxs("span",{className:"tech-card__badge tech-card__badge--warning",children:["Esclusiva",J?`: ${J}`:""]}):null]})},D=a&&i?S.map(G=>({branch:G,offers:O_(G.id,a,l.research),state:a.branches[G.id],techs:l.research.techs.filter(F=>F.branch===G.id)})):[],A=Z0(_,G=>G.tree),q=j.useMemo(()=>{if(!a)return[];const G=a.currentEra+1,F=l.research.eras?.find(Z=>Z.id===G);return F?F.gatewayTechs?.map(Z=>l.research.techs.find(J=>J.id===Z)).filter(Boolean):[]},[l,a]),I=j.useMemo(()=>{if(!a)return null;const G=a.currentEra+1,F=l.research.eras?.find(ee=>ee.id===G);if(!F||!F.gatewayTechs||F.gatewayTechs.length===0)return null;const Z=F.gatewayTechs.filter(ee=>Object.values(a.branches).some(re=>re.completed.includes(ee))).length,J=F.gatewayTechs.length;return{targetEra:G,completed:Z,total:J}},[l,a]);return!a||!i?f.jsx("p",{className:"text-muted",children:"Nessuna sessione attiva."}):f.jsxs("div",{className:"tech-panel tech-panel__grid",children:[f.jsx("div",{className:"tech-panel__column",children:f.jsxs("div",{className:"tech-panel__section",children:[f.jsxs("header",{className:"panel-section__header tech-panel__header",children:[f.jsxs("div",{children:[f.jsx("h4",{children:"Ricerca"}),c?f.jsx("span",{className:"panel-message",children:c}):null]}),f.jsxs("div",{className:"tech-panel__summary",children:[f.jsxs("span",{className:"pill pill--glass",children:["Era: ",a.currentEra]}),f.jsxs("span",{className:"text-muted",children:["Ere sbloccate: ",a.unlockedEras.join(", ")||"1"]}),I?f.jsxs("span",{className:"pill pill--glass",children:["Gateway Era ",I.targetEra,": ",I.completed,"/",I.total]}):null]})]}),f.jsxs("div",{className:"tech-panel__toolbar",children:[f.jsxs("div",{className:"tech-panel__filters",children:[f.jsxs("label",{children:[f.jsx("input",{type:"checkbox",checked:m,onChange:G=>p(G.target.checked)})," ","Mostra completate"]}),f.jsxs("label",{children:[f.jsx("input",{type:"checkbox",checked:y,onChange:G=>v(G.target.checked)})," ","Solo rare"]}),f.jsxs("label",{children:[f.jsx("input",{type:"checkbox",checked:g,onChange:G=>b(G.target.checked)})," ","Tutte le ere"]})]}),f.jsxs("div",{className:"tech-panel__legend",children:[f.jsx("span",{className:"text-muted",children:"Origine:"}),f.jsx("span",{className:"tech-card__badge tech-card__badge--muted",children:"standard"}),f.jsx("span",{className:"tech-card__badge tech-card__badge--relic",children:"relic"}),f.jsx("span",{className:"tech-card__badge tech-card__badge--anomaly",children:"anomaly"}),f.jsx("span",{className:"tech-card__badge tech-card__badge--faction",children:"faction"})]})]}),N.length>0?f.jsxs("div",{className:"tech-panel__exclusive",children:[f.jsx("span",{className:"text-muted",children:"Percorsi esclusivi scelti:"}),f.jsx("div",{className:"tech-panel__exclusive-list",children:N.map(G=>f.jsxs("span",{className:"pill pill--glass",children:[G.group,": ",G.name]},G.group))})]}):null,f.jsx("div",{className:"tech-panel__scroll",children:D.map(({branch:G,offers:F,state:Z})=>{const J=Z.currentTechId?l.research.techs.find(te=>te.id===Z.currentTechId):null,ee=new Set(Z.completed),re=g?F.concat(l.research.techs.filter(te=>te.branch===G.id&&!F.find(Ae=>Ae.id===te.id))):F,de=m&&!g?re.concat(l.research.techs.filter(te=>te.branch===G.id&&ee.has(te.id))):re,U=Array.from(new Map(de.map(te=>[te.id,te])).values()).filter(te=>!(!m&&ee.has(te.id)||y&&te.kind!=="rare"||!g&&te.era&&te.era>a.currentEra)),L=Z0(U,te=>te.clusterId?te.clusterId:"Generiche"),K=l.research.techs.filter(te=>te.branch===G.id).length,fe=K>0?Z.completed.length/K:0;return f.jsxs("div",{className:"tech-branch",children:[f.jsxs("div",{className:"tech-branch__header",children:[f.jsxs("div",{children:[f.jsx("div",{className:"tech-branch__title",children:G.label}),f.jsx("p",{className:"text-muted",children:G.description})]}),f.jsx("div",{className:"tech-branch__status",children:J?f.jsxs("span",{children:["In corso: ",J.name," ",Math.round(Z.progress/J.cost*100),"%"]}):f.jsx("span",{className:"text-muted",children:"Nessuna ricerca attiva"})})]}),f.jsxs("div",{className:"tech-branch__progress",children:[f.jsx("div",{className:"tech-branch__progress-bar",children:f.jsx("span",{className:"tech-branch__progress-fill",style:{width:`${Math.min(100,fe*100)}%`}})}),f.jsxs("small",{className:"text-muted",children:["Completate: ",Z.completed.length,"/",K||"?"]})]}),f.jsxs("div",{className:"tech-branch__clusters",children:[Object.entries(L).map(([te,Ae])=>f.jsxs("div",{className:"tech-cluster",children:[f.jsx("div",{className:"tech-cluster__header",children:f.jsxs("span",{className:"text-muted",children:["Cluster: ",te]})}),f.jsx("div",{className:"tech-branch__techs",children:Ae.map(le=>{const ye=Z.completed.includes(le.id),Le=Z.currentTechId===le.id,et=!!(le.mutuallyExclusiveGroup&&a.exclusivePicks&&a.exclusivePicks[le.mutuallyExclusiveGroup]&&a.exclusivePicks[le.mutuallyExclusiveGroup]!==le.id),vt=le.mutuallyExclusiveGroup;return f.jsxs("div",{className:"tech-card",children:[f.jsxs("div",{className:"tech-card__title",children:[le.name," ",ye?f.jsx("span",{className:"tech-card__badge",children:"Completata"}):null,z(le.era,le.kind,le.origin,le.mutuallyExclusiveGroup)]}),vt?f.jsxs("p",{className:"text-muted",children:["Percorso esclusivo: ",vt,et?" (bloccato)":""]}):null,et?f.jsx("p",{className:"text-muted",children:"Bloccata: scelta esclusiva gi effettuata."}):null,f.jsx("p",{className:"text-muted",children:le.description}),f.jsxs("div",{className:"tech-card__meta",children:[f.jsxs("span",{children:["Costo: ",le.cost]}),Le?f.jsx("span",{className:"tech-card__badge tech-card__badge--active",children:"In corso"}):f.jsx("button",{className:"panel__action panel__action--compact",onClick:()=>T(G.id,le.id),disabled:ye||et,title:et?"Bloccata da un percorso esclusivo gi scelto.":void 0,children:"Avvia"})]})]},le.id)})})]},te)),F.length===0?f.jsxs("div",{className:"tech-empty",children:[f.jsx("p",{className:"text-muted",children:"Nessuna tecnologia disponibile."}),q.length>0?f.jsxs("p",{className:"text-muted",children:["Suggerimento: completa le gateway dell'Era ",a.currentEra+1,":"," ",q.map(te=>te.name).join(", "),"."]}):null]}):null]})]},G.id)})})]})}),f.jsx("div",{className:"tech-panel__column",children:f.jsxs("div",{className:"tech-panel__section",children:[f.jsxs("header",{className:"panel-section__header tech-panel__header",children:[f.jsx("div",{children:f.jsx("h4",{children:"Tradizioni"})}),f.jsxs("div",{className:"tech-panel__summary",children:[f.jsxs("span",{className:"pill pill--glass",children:["Punti: ",i.availablePoints.toFixed(2)]}),f.jsxs("span",{className:"text-muted",children:["Alberi: ",Object.keys(A).length]})]})]}),f.jsx("div",{className:"tech-panel__toolbar",children:f.jsxs("div",{className:"tech-panel__legend",children:[f.jsx("span",{className:"text-muted",children:"Origine:"}),f.jsx("span",{className:"tech-card__badge tech-card__badge--muted",children:"standard"}),f.jsx("span",{className:"tech-card__badge tech-card__badge--relic",children:"relic"}),f.jsx("span",{className:"tech-card__badge tech-card__badge--anomaly",children:"anomaly"}),f.jsx("span",{className:"tech-card__badge tech-card__badge--faction",children:"faction"})]})}),M.length>0?f.jsxs("div",{className:"tech-panel__exclusive tech-panel__exclusive--compact",children:[f.jsx("span",{className:"text-muted",children:"Percorsi esclusivi (tradizioni):"}),f.jsx("div",{className:"tech-panel__exclusive-list",children:M.map(G=>f.jsxs("span",{className:"pill pill--glass",children:[G.group,": ",G.name]},G.group))})]}):null,f.jsx("div",{className:"tech-panel__scroll",children:f.jsxs("div",{className:"tech-branch__techs",children:[Object.entries(A).map(([G,F])=>f.jsxs("div",{className:"tech-branch",children:[f.jsx("div",{className:"tech-branch__header",children:f.jsx("div",{children:f.jsx("div",{className:"tech-branch__title",children:G})})}),f.jsx("div",{className:"tech-branch__clusters",children:F.map(Z=>{const J=i.unlocked.includes(Z.id),ee=!!(Z.mutuallyExclusiveGroup&&i.exclusivePicks&&i.exclusivePicks[Z.mutuallyExclusiveGroup]&&i.exclusivePicks[Z.mutuallyExclusiveGroup]!==Z.id),re=Z.mutuallyExclusiveGroup;return f.jsxs("div",{className:"tech-card",children:[f.jsxs("div",{className:"tech-card__title",children:[Z.name," ",J?f.jsx("span",{className:"tech-card__badge",children:"Sbloccata"}):null,z(Z.era,void 0,Z.origin,Z.mutuallyExclusiveGroup)]}),re?f.jsxs("p",{className:"text-muted",children:["Percorso esclusivo: ",re,ee?" (bloccato)":""]}):null,ee?f.jsx("p",{className:"text-muted",children:"Bloccata: scelta esclusiva gi effettuata."}):null,f.jsx("p",{className:"text-muted",children:Z.description}),f.jsxs("div",{className:"tech-card__meta",children:[f.jsxs("span",{children:["Costo: ",Z.cost]}),f.jsx("button",{className:"panel__action panel__action--compact",onClick:()=>w(Z.id),disabled:J||ee,title:ee?"Bloccata da un percorso esclusivo gi scelto.":void 0,children:"Sblocca"})]})]},Z.id)})})]},G)),_.length===0?f.jsx("p",{className:"text-muted",children:"Nessun perk disponibile ora."}):null]})})]})})]})},Bi=360,iw={O:"#b9d8ff",B:"#9fc4ff",A:"#c7d6ff",F:"#f7f2d0",G:"#ffd27a",K:"#ffb36b",M:"#ff8a5c"},sw={unknown:.25,revealed:.65,surveyed:1},nd={unknown:4,revealed:5,surveyed:6},lw={idle:"In attesa",traveling:"In viaggio",surveying:"Analisi"},ow=({onFocusSystem:a})=>{const i=$(g=>g.session?.galaxy.systems??[]),l=$(g=>g.session?.scienceShips??[]),o=$(g=>g.session?.economy.planets??[]),r=$(g=>g.config.starVisuals),c=j.useMemo(()=>{if(i.length===0)return[];const g=i.map(z=>z.position.x),b=i.map(z=>z.position.y),S=Math.min(...g),_=Math.max(...g),N=Math.min(...b),M=Math.max(...b),T=_-S||1,w=M-N||1;return i.map(z=>({...z,screenX:(z.position.x-S)/T*(Bi-30)+15,screenY:(z.position.y-N)/w*(Bi-30)+15}))},[i]),d=j.useMemo(()=>{const g=new Map;return c.forEach(b=>g.set(b.id,b)),g},[c]),m=i.filter(g=>g.visibility==="surveyed").length,p=i.filter(g=>g.visibility!=="unknown").length,y=i.filter(g=>(g.hostilePower??0)>0),v=l.map(g=>{const b=d.get(g.currentSystemId)??null,S=g.targetSystemId?d.get(g.targetSystemId)??null:null;return{ship:g,currentSystem:b,target:S}});return f.jsxs("section",{className:"galaxy-modal",children:[f.jsxs("header",{className:"galaxy-modal__header",children:[f.jsxs("div",{children:[f.jsx("p",{className:"galaxy-modal__eyebrow",children:"Situazione galattica"}),f.jsx("h2",{children:"Panoramica galassia"}),f.jsx("p",{className:"text-muted",children:"Stato di sistemi, colonie e navi scientifiche. Clicca su un sistema noto per centrare la mappa."})]}),f.jsxs("div",{className:"galaxy-modal__summary",children:[f.jsxs("span",{className:"pill",children:["Sistemi: ",f.jsx("strong",{children:i.length})]}),f.jsxs("span",{className:"pill pill--success",children:["Sondati: ",f.jsx("strong",{children:m})]}),f.jsxs("span",{className:"pill",children:["Rivelati: ",f.jsx("strong",{children:p})]}),f.jsxs("span",{className:"pill pill--alert",children:["Ostili: ",f.jsx("strong",{children:y.length})]}),f.jsxs("span",{className:"pill",children:["Colonie: ",f.jsx("strong",{children:o.length})]})]})]}),f.jsxs("div",{className:"galaxy-modal__content",children:[f.jsx("div",{className:"galaxy-modal__map","aria-label":"Mappa galattica",children:f.jsxs("svg",{viewBox:`0 0 ${Bi} ${Bi}`,role:"presentation",children:[f.jsx("rect",{width:Bi,height:Bi,fill:"rgba(255,255,255,0.02)",stroke:"rgba(255,255,255,0.1)"}),c.map(g=>{const S=r[g.starClass]?.coreColor??iw[g.starClass];return f.jsxs("g",{className:"galaxy-modal__system",children:[g.hostilePower&&g.hostilePower>0?f.jsx("circle",{cx:g.screenX,cy:g.screenY,r:nd[g.visibility]+5,className:"galaxy-modal__hostile"}):null,f.jsx("circle",{cx:g.screenX,cy:g.screenY,r:nd[g.visibility],fill:S,opacity:sw[g.visibility]}),f.jsx("text",{x:g.screenX+8,y:g.screenY+4,className:"galaxy-modal__label",children:g.name}),a?f.jsx("circle",{cx:g.screenX,cy:g.screenY,r:nd[g.visibility]+8,className:"galaxy-modal__focus",onClick:()=>g.visibility!=="unknown"?a(g.id):null}):null]},g.id)}),v.map(({ship:g,currentSystem:b})=>b?f.jsx("circle",{cx:b.screenX,cy:b.screenY,r:4,className:"galaxy-modal__ship"},g.id):null)]})}),f.jsxs("div",{className:"galaxy-modal__lists",children:[f.jsxs("div",{className:"galaxy-modal__block",children:[f.jsx("h3",{children:"Sistemi ostili"}),f.jsx("ul",{className:"galaxy-modal__list",children:y.length===0?f.jsx("li",{className:"text-muted",children:"Nessuna minaccia rilevata."}):y.map(g=>f.jsxs("li",{children:[f.jsxs("div",{className:"galaxy-list__row",children:[f.jsx("span",{children:g.name}),f.jsxs("span",{className:"galaxy-list__tag",children:[g.hostilePower," forza"]})]}),f.jsxs("small",{className:"text-muted",children:["Stato: ",g.visibility]})]},g.id))})]}),f.jsxs("div",{className:"galaxy-modal__block",children:[f.jsx("h3",{children:"Navi scientifiche"}),f.jsx("ul",{className:"galaxy-modal__list",children:v.length===0?f.jsx("li",{className:"text-muted",children:"Nessuna nave scientifica attiva."}):v.map(({ship:g,currentSystem:b,target:S})=>f.jsxs("li",{children:[f.jsxs("div",{className:"galaxy-list__row",children:[f.jsx("span",{children:g.name}),f.jsx("span",{className:`ship-status ship-status--${g.status}`,children:lw[g.status]})]}),f.jsxs("small",{className:"text-muted",children:["Presente in: ",b?b.name:"???"]}),f.jsxs("small",{className:"text-muted",children:["Obiettivo: ",S?`${S.name} (${g.ticksRemaining} tick)`:"Nessuno"]})]},g.id))})]})]})]})]})},rw={NO_SESSION:"Nessuna sessione.",SYSTEM_NOT_FOUND:"Sistema non trovato.",SYSTEM_UNKNOWN:"Devi prima rivelare il sistema.",SYSTEM_NOT_SURVEYED:"Sonda prima il sistema.",NO_HABITABLE_WORLD:"Nessun mondo abitabile.",ALREADY_COLONIZED:"Sistema gia colonizzato.",TASK_IN_PROGRESS:"Colonizzazione gia attiva.",INSUFFICIENT_RESOURCES:"Risorse insufficienti.",NO_COLONY_SHIP:"Serve una nave colonia disponibile."},F0={preparing:"Allestimento",traveling:"In viaggio",colonizing:"Insediamento"},cw={preparing:"is-preparing",traveling:"is-traveling",colonizing:"is-colonizing"},uw=a=>a.missionTotalTicks<=0?0:Math.round(Math.min(1,a.missionElapsedTicks/a.missionTotalTicks)*100),dw=a=>a.totalTicks<=0?"0/0 tick":`${Math.max(0,a.totalTicks-a.ticksRemaining)}/${a.totalTicks} tick`,fw=({onFocusSystem:a})=>{const i=we(Ki),l=we(Lg),o=we(Ud),r=we(Od),c=$(N=>N.startColonization),d=$(N=>N.config.colonization),m=$(N=>N.config.military.colonyShipDesignId),p=$(N=>N.session),[y,v]=j.useState(null),g=j.useMemo(()=>{const N=new Map;return l.forEach(M=>{N.set(M.systemId,M)}),N},[l]),b=j.useMemo(()=>p?p.fleets.reduce((N,M)=>{const T=M.ships.filter(w=>w.designId===m).length;return N+T},0):0,[p,m]),S=()=>r?Object.entries(d.cost).every(([N,M])=>M?(r[N]?.amount??0)>=M:!0):!1,_=N=>{const M=c(N);M.success?v("Colonizzazione avviata."):v(rw[M.reason])};return f.jsxs("section",{className:"colonization-panel",children:[f.jsxs("header",{className:"panel-section__header",children:[f.jsxs("div",{children:[f.jsx("p",{className:"economy-modal__eyebrow",children:"Espansione"}),f.jsx("h2",{children:"Colonizzazione"}),f.jsxs("p",{className:"text-muted",children:["Avvia e monitora le missioni di colonizzazione. Navi colonia disponibili: ",b]}),f.jsxs("p",{className:"text-muted",children:["Costi: ",sl(d.cost)]})]}),f.jsxs("div",{className:"pill",children:["Missioni attive: ",l.length]})]}),y?f.jsx("p",{className:"panel-message",children:y}):null,f.jsx("div",{className:"colonization-panel__table",children:f.jsxs("table",{children:[f.jsx("thead",{children:f.jsxs("tr",{children:[f.jsx("th",{children:"Sistema"}),f.jsx("th",{children:"Stato"}),f.jsx("th",{children:"Missione"}),f.jsx("th",{children:"Azioni"})]})}),f.jsx("tbody",{children:i.map(N=>{const M=N.habitableWorld,T=o.has(N.id),w=g.get(N.id),z=w?uw(w):0,D=S(),A=M?N.visibility!=="surveyed"?"Serve sondaggio":T?"Colonia attiva":w?`Missione in corso (${F0[w.status]})`:D?b<=0?"Nessuna nave colonia disponibile":null:"Risorse insufficienti":"Nessun mondo";return f.jsxs("tr",{children:[f.jsx("td",{children:f.jsxs("div",{className:"colony-table__system",children:[f.jsx("span",{children:N.name}),a?f.jsx("button",{type:"button",className:"colony-table__link",onClick:()=>a(N.id),children:"Vai"}):null]})}),f.jsx("td",{children:T?"Colonia attiva":w?f.jsx("span",{className:`colonization-status ${cw[w.status]}`,children:F0[w.status]}):"-"}),f.jsx("td",{children:w?f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"colonization-mission__status",children:[dw(w),f.jsxs("span",{className:"colonization-mission__ticks",children:[z,"% missione"]})]}),f.jsx("div",{className:"colonization-progress",children:f.jsx("div",{className:"colonization-progress__bar",style:{width:`${z}%`}})})]}):f.jsx("span",{className:"text-muted",children:"Nessuna missione"})}),f.jsx("td",{children:f.jsx("button",{className:"panel__action panel__action--compact",disabled:!!A,title:A??"Avvia colonizzazione",onClick:()=>_(N.id),children:"Colonizza"})})]},N.id)})})]})})]})},hw={peace:"Pace",war:"Guerra"},mw=({empires:a,sessionTick:i})=>{const l=a.filter(o=>o.kind==="ai");return f.jsxs("div",{className:"panel-section",children:[f.jsx("div",{className:"panel-section__header",children:f.jsx("h3",{children:"Guerre attive"})}),f.jsx("ul",{children:l.map(o=>{const r=o.warSince!==null?Math.max(0,i-(o.warSince??0)):0;return f.jsx("li",{children:f.jsxs("div",{className:"fleet-row",children:[f.jsxs("div",{children:[f.jsx("strong",{children:o.name}),f.jsxs("span",{className:"text-muted",children:["Opinione: ",o.opinion]}),f.jsxs("span",{className:"text-muted",children:["Durata: ",r," tick"]})]}),f.jsx("span",{className:o.warStatus==="war"?"sentiment-negative":"sentiment-positive",children:hw[o.warStatus]})]})},o.id)})})]})},pw=({warEvents:a,empires:i,unreadWarIds:l,onMarkWarRead:o,warEventsRef:r})=>{const[c,d]=j.useState("all"),m=c==="all"?a:a.filter(p=>p.type===c);return f.jsxs("div",{className:"panel-section",children:[f.jsxs("div",{className:"panel-section__header",children:[f.jsx("h3",{children:"Eventi di guerra"}),f.jsxs("label",{className:"fleet-panel__order",children:[f.jsx("span",{className:"text-muted",children:"Filtro"}),f.jsxs("select",{value:c,onChange:p=>d(p.target.value),children:[f.jsx("option",{value:"all",children:"Tutti"}),f.jsx("option",{value:"warStart",children:"Inizio guerra"}),f.jsx("option",{value:"warEnd",children:"Pace"})]})]}),o?f.jsx("button",{className:"panel__action panel__action--compact panel__action--inline",onClick:o,children:"Segna letti"}):null]}),f.jsx("ul",{ref:r,children:m.length===0?f.jsx("li",{className:"text-muted",children:"Nessun evento registrato."}):m.map(p=>{const y=i.find(g=>g.id===p.empireId),v=l?.has(p.id);return f.jsxs("li",{className:v?"war-event war-event--new":"war-event",children:[f.jsxs("div",{className:"fleet-row",children:[f.jsx("strong",{children:y?.name??p.empireId}),f.jsxs("span",{className:"text-muted",children:["Tick ",p.tick]})]}),f.jsx("p",{className:"text-muted",children:p.message})]},p.id)})})]})},gw={playerVictory:"Vittoria",playerDefeat:"Sconfitta",mutualDestruction:"Mutua distruzione",stalemate:"Stallo"},yw=a=>({total:a.length,victories:a.filter(l=>l.result==="playerVictory").length,defeats:a.filter(l=>l.result==="playerDefeat").length,mutual:a.filter(l=>l.result==="mutualDestruction").length,stalemate:a.filter(l=>l.result==="stalemate").length,shipsLost:a.reduce((l,o)=>l+o.losses.reduce((r,c)=>r+c.shipsLost,0),0),avgDamageTaken:a.length>0?Math.round(a.reduce((l,o)=>l+o.damageTaken,0)/a.length):0}),vw=({reports:a,systems:i})=>{const l=j.useMemo(()=>yw(a),[a]),o=r=>i.find(c=>c.id===r)?.name??r;return f.jsxs("div",{className:"panel-section",children:[f.jsx("div",{className:"panel-section__header",children:f.jsx("h3",{children:"Rapporti di combattimento"})}),f.jsxs("div",{className:"fleet-panel__order",children:[f.jsxs("span",{className:"text-muted",children:["Totali: ",l.total," | Vittorie ",l.victories," | Sconfitte"," ",l.defeats," | Stallo ",l.stalemate," | Mutua"," ",l.mutual]}),f.jsxs("span",{className:"text-muted",children:["Navi perse: ",l.shipsLost," | Danno medio subito: ",l.avgDamageTaken]})]}),f.jsx("ul",{children:a.map(r=>f.jsxs("li",{children:[f.jsxs("div",{className:"combat-log__header",children:[f.jsx("strong",{children:gw[r.result]}),f.jsxs("span",{className:"text-muted",children:["Tick ",r.tick," - ",o(r.systemId)]})]}),f.jsxs("p",{children:["Potenza flotta: ",r.playerPower," | Difesa: ",r.playerDefense," | Danno subito:"," ",r.damageTaken]}),f.jsxs("p",{children:["Minaccia: ",r.hostilePower]}),r.losses.map(c=>f.jsxs("p",{className:"text-muted",children:["Perdite flotta ",c.fleetId.slice(0,6),": ",c.shipsLost]},`${r.id}-${c.fleetId}`))]},r.id))})]})},bw=j.memo(function({events:i,empires:l,warEventsRef:o,unreadWarIds:r,onMarkWarRead:c}){return f.jsx(pw,{warEvents:i,empires:l,unreadWarIds:r,onMarkWarRead:c,warEventsRef:o})}),xw=({warEventsRef:a,unreadWarIds:i,onMarkWarRead:l})=>{const o=we(kg),r=we(Ki),c=we(s_).slice().reverse().slice(0,30),d=we(o_).slice().reverse().slice(0,20),m=we(Ug);return f.jsxs("section",{className:"battles-panel",children:[f.jsx(mw,{empires:o,sessionTick:m}),f.jsx(bw,{events:d,empires:o,unreadWarIds:i,onMarkWarRead:l,warEventsRef:a}),f.jsx(vw,{reports:c,systems:r})]})},Sw=j.memo(xw),_w=({planet:a,systemName:i,onPromote:l,onDemote:o,automationConfig:r,populationJobs:c,districtDefinitions:d,canAffordDistricts:m,planetDistrictQueue:p,populationMessage:y,onQueueDistrict:v,onRemoveDistrict:g})=>{const b=Xx(a,{homeworld:{name:a.name,kind:a.kind,size:a.size,population:a.population.total,baseProduction:a.baseProduction,upkeep:a.upkeep},districts:d,populationJobs:c});return f.jsxs("div",{className:"planet-detail",children:[f.jsxs("aside",{className:"planet-detail__production",children:[b?f.jsxs("div",{className:"planet-production planet-production--vertical",children:[f.jsx("h4",{children:"Produzione netta"}),f.jsx("div",{className:"planet-production__stack",children:gt.map(S=>{const _=b[S];if(!_)return null;const N=pl[S],M=_.net>=0?"is-positive":"is-negative",T=`planet-production__card planet-production__card--${_.net>=0?"positive":"negative"}`;return f.jsxs("div",{className:T,children:[f.jsxs("div",{className:"planet-production__header",children:[f.jsx("span",{className:"planet-production__label",children:N}),f.jsx("span",{className:`planet-production__pill ${M}`,children:Pi(_.net)})]}),f.jsxs("div",{className:"planet-production__stats",children:[f.jsxs("div",{className:"planet-production__stat",children:[f.jsx("span",{className:"text-muted",children:"Base"}),f.jsx("span",{className:_.base>=0?"is-positive":"is-negative",children:Pi(_.base)})]}),f.jsxs("div",{className:"planet-production__stat",children:[f.jsx("span",{className:"text-muted",children:"Distretti"}),f.jsx("span",{className:_.districts>=0?"is-positive":"is-negative",children:Pi(_.districts)})]}),f.jsxs("div",{className:"planet-production__stat",children:[f.jsx("span",{className:"text-muted",children:"Popolazione"}),f.jsx("span",{className:_.population>=0?"is-positive":"is-negative",children:Pi(_.population)})]}),f.jsxs("div",{className:"planet-production__stat",children:[f.jsx("span",{className:"text-muted",children:"Upkeep"}),f.jsx("span",{className:_.upkeep<=0?"is-positive":"is-negative",children:Pi(-_.upkeep)})]})]})]},S)})})]}):null,f.jsxs("div",{className:"planet-districts planet-districts--compact",children:[f.jsx("h4",{children:"Coda costruzione"}),p.length===0?f.jsx("p",{className:"text-muted",children:"Nessun distretto in costruzione."}):f.jsx("ul",{children:p.map(S=>f.jsxs("li",{children:[f.jsxs("div",{className:"district-queue__header",children:[f.jsx("strong",{children:S.label}),f.jsxs("span",{className:"text-muted",children:["Tick rimanenti: ",S.ticksRemaining,"/",S.totalTicks]})]}),f.jsx("div",{className:"progress-bar",children:f.jsx("div",{className:"progress-bar__fill",style:{width:`${Math.round(S.progress*100)}%`}})})]},S.id))})]})]}),f.jsxs("div",{className:"planet-detail__body",children:[f.jsxs("div",{className:"planet-body__header",children:[f.jsxs("div",{children:[f.jsx("p",{className:"planet-detail__eyebrow",children:"Dettagli pianeta"}),f.jsxs("h3",{className:"planet-detail__title",children:[a.name," ",f.jsxs("span",{className:"planet-detail__system",children:["(",i,")"]})]})]}),f.jsxs("div",{className:"planet-body__meta",children:[f.jsxs("span",{className:"planet-detail__pill",children:["Stabilita ",Math.round(a.stability)]}),f.jsxs("span",{className:"planet-detail__pill",children:["Felicita ",Math.round(a.happiness)]}),f.jsxs("span",{className:"planet-detail__pill",children:["Tipo: ",a.kind]}),f.jsxs("span",{className:"planet-detail__pill",children:["Pop: ",a.population.workers," L / ",a.population.specialists," S / ",a.population.researchers," R"]})]})]}),f.jsxs("div",{className:"planet-meta",children:[f.jsxs("span",{children:["Popolazione: ",a.population.workers," L / ",a.population.specialists," S /"," ",a.population.researchers," R"]}),f.jsxs("span",{children:["Tipo pianeta: ",a.kind]})]}),f.jsxs("div",{className:"planet-districts",children:[f.jsx("h4",{children:"Distretti"}),f.jsx("ul",{className:"district-card-list",children:d.map(S=>{const _=a.districts[S.id]??0,M=`${Math.min(_,12)/12*100}%`,T=!m[S.id],w=T?"Risorse insufficienti per costruire questo distretto.":void 0;return f.jsxs("li",{className:"district-card",children:[f.jsxs("div",{className:"district-card__header",children:[f.jsxs("div",{className:"district-card__title",children:[f.jsx("strong",{children:S.label}),f.jsx("span",{className:"text-muted",children:S.description})]}),f.jsxs("span",{className:"district-card__pill",children:[_," costruiti"]})]}),f.jsx("div",{className:"district-card__progress",children:f.jsx("div",{className:"district-bar",children:f.jsx("div",{className:"district-bar__fill",style:{width:M}})})}),f.jsxs("div",{className:"district-card__stats",children:[f.jsxs("div",{className:"district-card__stat",children:[f.jsx("span",{className:"text-muted",children:"Costo"}),f.jsx("div",{className:"district-card__chip",children:sl(S.cost)})]}),f.jsxs("div",{className:"district-card__stat",children:[f.jsx("span",{className:"text-muted",children:"Produzione"}),f.jsx("div",{className:"district-card__chip",children:sl(S.production)})]})]}),f.jsxs("div",{className:"district-card__actions",children:[f.jsx("button",{className:"panel__action panel__action--compact",disabled:T,title:w,onClick:()=>v(S.id),children:"Costruisci"}),f.jsx("button",{className:"panel__action panel__action--compact panel__action--danger",disabled:_<=0,onClick:()=>g(S.id),children:"Rimuovi"})]})]},S.id)})})]})]}),f.jsx("aside",{className:"planet-detail__roles",children:f.jsxs("div",{className:"planet-population",children:[f.jsx("h4",{children:"Ruoli popolazione"}),r?.enabled?f.jsxs("p",{className:"text-muted",children:["Bilanciamento automatico attivo (priorita: ",r.priorities.join(" > "),")"]}):null,y?f.jsx("p",{className:"panel-message",children:y}):null,f.jsx("ul",{className:"population-role-list",children:c.map(S=>{const _=a.population[S.id]??0;return f.jsxs("li",{className:"population-role",children:[f.jsxs("div",{className:"population-role__top",children:[f.jsxs("div",{className:"population-role__headline",children:[f.jsx("strong",{children:S.label}),f.jsx("span",{className:"text-muted",children:S.description})]}),f.jsx("span",{className:"population-role__badge",children:_})]}),f.jsxs("div",{className:"population-role__stat-grid",children:[f.jsxs("div",{className:"population-role__stat-block",children:[f.jsx("span",{className:"population-role__label",children:"Produzione"}),f.jsx("span",{className:"population-role__chip population-role__chip--accent",children:sl(S.production)})]}),f.jsxs("div",{className:"population-role__stat-block",children:[f.jsx("span",{className:"population-role__label",children:"Upkeep"}),f.jsx("span",{className:"population-role__chip population-role__chip--muted",children:sl(S.upkeep)})]})]}),f.jsxs("div",{className:"population-role__actions",children:[f.jsx("button",{className:"panel__action panel__action--compact",onClick:()=>l(S.id),children:"Promuovi"}),S.id!=="workers"?f.jsx("button",{className:"panel__action panel__action--compact",onClick:()=>o(S.id),children:"Declassa"}):null]})]},S.id)})})]})})]})},Nw=()=>{const a=$(l=>l.session),i=j.useMemo(()=>{if(!a)return[];const l=a.notifications.map(r=>({kind:"notification",tick:r.tick,message:r.message,label:r.kind})),o=a.warEvents.map(r=>({kind:"war",tick:r.tick,message:r.message,label:"evento guerra"}));return[...l,...o].sort((r,c)=>c.tick-r.tick)},[a]);return a?f.jsxs("section",{className:"log-panel",children:[f.jsxs("header",{className:"panel-section__header",children:[f.jsxs("div",{children:[f.jsx("p",{className:"economy-modal__eyebrow",children:"Log di sessione"}),f.jsx("h2",{children:"Eventi & Notifiche"}),f.jsx("p",{className:"text-muted",children:"Tutte le notifiche di gioco, incluse anomalie, eventi e guerre."})]}),f.jsxs("span",{className:"pill",children:["Totale: ",i.length]})]}),f.jsx("div",{className:"log-panel__list",children:i.length===0?f.jsx("p",{className:"text-muted",children:"Nessuna notifica registrata."}):f.jsx("ul",{children:i.map((l,o)=>f.jsx("li",{children:f.jsxs("div",{className:"log-row",children:[f.jsx("span",{className:`log-badge log-badge--${l.kind}`,children:l.label}),f.jsxs("span",{className:"log-tick",children:["t",l.tick]}),f.jsx("span",{className:"log-message",children:l.message})]})},`${l.kind}-${o}-${l.tick}`))})})]}):f.jsx("p",{className:"text-muted",children:"Nessuna sessione attiva."})},el=({variant:a,onSelect:i,onCenter:l})=>{we(mr),we(Ud);const o=we(Ki),r=we(Bg),c=$(b=>b.session),d=$(b=>b.config.military.shipDesigns),m=j.useMemo(()=>new Map(d.map(b=>[b.id,b])),[d]),p=j.useMemo(()=>c?.fleets.filter(b=>!b.ownerId||b.ownerId==="player")??[],[c]),y=b=>m.get(b)?.role??"military",v=c?.economy.planets.map(b=>({id:b.id,name:b.name,systemId:b.systemId}))??[],g=b=>o.find(S=>S.id===b)?.name??b;if(a==="colonies")return f.jsx("aside",{className:"side-entity-dock",children:f.jsxs("section",{children:[f.jsx("h4",{children:"Colonie"}),f.jsx("ul",{children:v.length===0?f.jsx("li",{className:"text-muted",children:"Nessuna colonia."}):v.map(b=>f.jsxs("li",{children:[f.jsxs("div",{className:"dock-row",children:[f.jsx("span",{className:"dock-name",children:b.name}),f.jsxs("div",{className:"dock-actions",children:[f.jsx("button",{className:"hud-icon-btn","data-tooltip":"Centra",onClick:()=>l(b.systemId,b.id),children:f.jsx(Yo,{size:14})}),f.jsx("button",{className:"hud-icon-btn","data-tooltip":"Dettagli",onClick:()=>i({kind:"colony",planetId:b.id,systemId:b.systemId}),children:f.jsx(Vo,{size:14})})]})]}),f.jsx("small",{className:"text-muted",children:g(b.systemId)})]},b.id))})]})});if(a==="fleets"){const b=p.filter(S=>{const _=S.ships.map(M=>y(M.designId));return _.includes("military")?!0:!_.some(M=>M==="construction"||M==="colony"||M==="science")&&S.ships.length>0});return f.jsx("aside",{className:"side-entity-dock",children:f.jsxs("section",{children:[f.jsx("h4",{children:"Flotte militari"}),f.jsx("ul",{children:b.length===0?f.jsx("li",{className:"text-muted",children:"Nessuna flotta."}):b.map(S=>f.jsxs("li",{children:[f.jsxs("div",{className:"dock-row",children:[f.jsx("span",{className:"dock-name",children:S.name??S.id}),f.jsxs("div",{className:"dock-actions",children:[f.jsx("button",{className:"hud-icon-btn","data-tooltip":"Centra",onClick:()=>l(S.systemId),children:f.jsx(Yo,{size:14})}),f.jsx("button",{className:"hud-icon-btn","data-tooltip":"Dettagli",onClick:()=>i({kind:"fleet",fleetId:S.id,systemId:S.systemId,source:"fleet"}),children:f.jsx(Vo,{size:14})})]})]}),f.jsxs("small",{className:"text-muted",children:[g(S.systemId)," - Navi: ",S.ships.length]})]},S.id))})]})})}if(a==="colonization"||a==="construction"){const b=a==="colonization"?"colony":"construction",S=p.flatMap(M=>M.ships.filter(T=>y(T.designId)===b).map(T=>({shipId:T.id,fleetId:M.id,systemId:M.systemId,designId:T.designId,fleetName:M.name??M.id}))),_=a==="colonization"?"Navi colonia":"Navi costruttrici",N=M=>m.get(M)?.name??M;return f.jsx("aside",{className:"side-entity-dock",children:f.jsxs("section",{children:[f.jsx("h4",{children:_}),f.jsx("ul",{children:S.length===0?f.jsx("li",{className:"text-muted",children:"Nessuna nave."}):S.map(M=>f.jsxs("li",{children:[f.jsxs("div",{className:"dock-row",children:[f.jsx("span",{className:"dock-name",children:N(M.designId)}),f.jsxs("div",{className:"dock-actions",children:[f.jsx("button",{className:"hud-icon-btn","data-tooltip":"Centra",onClick:()=>l(M.systemId),children:f.jsx(Yo,{size:14})}),f.jsx("button",{className:"hud-icon-btn","data-tooltip":"Dettagli flotta",onClick:()=>i({kind:"fleet",fleetId:M.fleetId,systemId:M.systemId,source:a==="construction"?"construction":"colonization"}),children:f.jsx(Vo,{size:14})})]})]}),f.jsxs("small",{className:"text-muted",children:[g(M.systemId)," - ",M.fleetName]})]},M.shipId))})]})})}return f.jsx("aside",{className:"side-entity-dock",children:f.jsxs("section",{children:[f.jsx("h4",{children:"Navi scientifiche"}),f.jsx("ul",{children:r.length===0?f.jsx("li",{className:"text-muted",children:"Nessuna nave scientifica."}):r.map(b=>f.jsxs("li",{children:[f.jsxs("div",{className:"dock-row",children:[f.jsx("span",{className:"dock-name",children:b.name??b.id}),f.jsxs("div",{className:"dock-actions",children:[f.jsx("button",{className:"hud-icon-btn","data-tooltip":"Centra",onClick:()=>l(b.currentSystemId),children:f.jsx(Yo,{size:14})}),f.jsx("button",{className:"hud-icon-btn","data-tooltip":"Dettagli",onClick:()=>i({kind:"science",shipId:b.id,systemId:b.currentSystemId}),children:f.jsx(Vo,{size:14})})]})]}),f.jsxs("small",{className:"text-muted",children:[g(b.currentSystemId)," - ",b.status]})]},b.id))})]})})},Ew={NO_SESSION:"Nessuna sessione.",FLEET_NOT_FOUND:"Flotta non trovata.",SYSTEM_NOT_FOUND:"Sistema non valido.",ALREADY_IN_SYSTEM:"La flotta  gi nel sistema.",NO_SHIPS:"La flotta non ha navi.",BORDER_CLOSED:"Confini chiusi: richiedi accesso o dichiara guerra."},K0={NO_SESSION:"Nessuna sessione attiva.",FLEET_NOT_FOUND:"Flotta non trovata.",TARGET_NOT_FOUND:"Flotta bersaglio non trovata.",SAME_FLEET:"Seleziona una flotta diversa.",DIFFERENT_SYSTEM:"Le flotte devono essere nello stesso sistema.",INSUFFICIENT_SHIPS:"Servono almeno 2 navi per dividere."},Mw={idle:"In stazione",traveling:"In viaggio",surveying:"Sondando"},jw=(a,i)=>{const l=new Map;return a.forEach(o=>{const r=String(o.designId);l.set(r,(l.get(r)??0)+1)}),Array.from(l.entries()).map(([o,r])=>`${i.get(o)?.name??o} x${r}`).join(", ")},ww=({fleet:a,fleets:i,systems:l,scienceShips:o,designs:r,completedTechs:c,onOrder:d,showConstructionActions:m=!0,onAnchorChange:p,onCenter:y,onStop:v,onMerge:g,onSplit:b,onBuildShipyard:S,onClose:_})=>{const[N,M]=j.useState(null),T=j.useMemo(()=>new Map(r.map(L=>[L.id,L])),[r]),w=L=>l.find(K=>K.id===L)?.name??L,z=l.filter(L=>L.visibility==="surveyed"),D=l.find(L=>L.id===a.systemId),A=D?.orbitingPlanets?.map(L=>({id:L.id,name:L.name??L.id}))??[],q=D?.shipyardBuild,I=!!q,G=o.filter(L=>L.currentSystemId===a.systemId||L.targetSystemId===a.systemId),F=L=>{const K=d(a.id,L);K.success?M("Rotta aggiornata."):K.reason&&M(Ew[K.reason])},Z=i.filter(L=>L.id!==a.id&&L.systemId===a.systemId),J=a.ships.some(L=>T.get(L.designId)?.role==="construction"),ee=J&&c.includes("orbital-shipyard")&&D?.visibility==="surveyed"&&!I&&!D?.hasShipyard,re=J?D?.visibility!=="surveyed"?"Il sistema deve essere ispezionato.":I?"Costruzione gi in corso.":D?.hasShipyard?"Cantiere gi presente nel sistema.":c.includes("orbital-shipyard")?null:"Richiede tecnologia Cantiere orbitale.":"Serve una nave costruttrice.",de=(()=>{if(!J)return[];const L=[];return c.includes("orbital-shipyard")&&L.push({id:"build-shipyard",label:"Costruisci cantiere orbitale"}),L})(),Ee=!!D?.hasShipyard,U=()=>{if(!S||!D)return;const L=S(D.id,a.anchorPlanetId??null);if(L.success)M("Costruzione cantiere avviata (10 tick).");else if(L.reason){const K=L.reason;M(K==="IN_PROGRESS"?"Costruzione cantiere gi in corso.":{NO_SESSION:"Nessuna sessione attiva.",SYSTEM_NOT_FOUND:"Sistema non valido.",SYSTEM_NOT_SURVEYED:"Il sistema deve essere ispezionato.",TECH_MISSING:"Richiede la tecnologia Cantiere orbitale.",IN_PROGRESS:"Costruzione gi in corso.",ALREADY_BUILT:"Cantiere gi presente nel sistema.",NO_CONSTRUCTOR:"Serve una nave costruttrice nel sistema.",INSUFFICIENT_RESOURCES:"Risorse insufficienti."}[K]??"Azione non disponibile.")}};return f.jsxs("div",{className:"fleet-detail fleet-detail--split",children:[f.jsxs("div",{className:"fleet-detail__left",children:[f.jsxs("header",{className:"fleet-detail__header",children:[f.jsxs("div",{children:[f.jsx("p",{className:"fleet-detail__eyebrow",children:"Dettagli flotta"}),f.jsx("h3",{className:"fleet-detail__title",children:a.name??a.id}),f.jsxs("div",{className:"fleet-detail__meta",children:[f.jsx("span",{children:w(a.systemId)}),f.jsxs("span",{children:[" Navi: ",a.ships.length]})]}),f.jsxs("div",{className:"fleet-detail__tags",children:[a.targetSystemId?f.jsxs("span",{className:"pill pill--glass",children:["In rotta verso ",w(a.targetSystemId),typeof a.ticksToArrival=="number"?` (${a.ticksToArrival} tick)`:""]}):f.jsx("span",{className:"pill pill--glass",children:"In stazione"}),a.anchorPlanetId?f.jsx("span",{className:"pill pill--glass",children:"Agganciata a pianeta"}):f.jsx("span",{className:"pill pill--glass",children:"Agganciata a stella"})]})]}),f.jsx("button",{className:"dock-detail__close",onClick:_,children:""})]}),f.jsxs("section",{className:"fleet-detail__section",children:[f.jsx("h4",{children:"Composizione"}),f.jsx("p",{className:"fleet-detail__ships",children:a.ships.length>0?jw(a.ships,T):"Nessuna nave attiva"}),G.length>0?f.jsxs("div",{className:"fleet-detail__science",children:[f.jsx("span",{className:"text-muted",children:"Supporto scientifico:"}),f.jsx("div",{className:"fleet-detail__chips",children:G.map(L=>f.jsxs("span",{className:"fleet-chip",children:[f.jsx("span",{children:L.name}),f.jsx("small",{children:Mw[L.status]})]},L.id))})]}):null]}),f.jsxs("section",{className:"fleet-detail__section",children:[f.jsxs("div",{className:"fleet-detail__actions",children:[f.jsx("button",{className:"hud-icon-btn","data-tooltip":"Centra sulla flotta",onClick:()=>y?.(a.systemId),children:f.jsx(Hd,{size:14})}),f.jsx("button",{className:"hud-icon-btn","data-tooltip":"Ferma la flotta",onClick:()=>v?.(a.id),children:f.jsx(gr,{size:14})})]}),f.jsxs("div",{className:"fleet-detail__row",children:[f.jsxs("div",{className:"fleet-detail__field",children:[f.jsx("label",{className:"text-muted",children:"Destinazione"}),f.jsx("select",{value:a.targetSystemId??a.systemId,onChange:L=>F(L.target.value),children:z.map(L=>f.jsx("option",{value:L.id,children:L.name},L.id))})]}),f.jsxs("div",{className:"fleet-detail__field",children:[f.jsx("label",{className:"text-muted",children:"Aggancio (sistema attuale)"}),f.jsxs("select",{value:a.anchorPlanetId??"",onChange:L=>{p(a.id,L.target.value?L.target.value:null)},children:[f.jsx("option",{value:"",children:"Stella"}),A.map(L=>f.jsx("option",{value:L.id,children:L.name},L.id))]})]}),f.jsxs("div",{className:"fleet-detail__field",children:[f.jsx("label",{className:"text-muted",children:"Unisci con"}),f.jsxs("select",{value:"",onChange:L=>{if(!L.target.value)return;const K=g(a.id,L.target.value);M(K.success?"Flotte unite.":K0[K.reason])},children:[f.jsx("option",{value:"",children:"Seleziona flotta..."}),Z.map(L=>f.jsx("option",{value:L.id,children:L.name??L.id},L.id))]})]})]}),f.jsx("div",{className:"fleet-detail__actions",children:f.jsx("button",{className:"panel__action panel__action--compact",onClick:()=>{const L=b(a.id);M(L.success?"Nuova flotta creata.":K0[L.reason])},disabled:a.ships.length<=1,children:"Dividi 1 nave"})}),N?f.jsx("p",{className:"panel-message",children:N}):null]})]}),J&&m?f.jsx("aside",{className:"fleet-detail__aside",children:f.jsxs("div",{className:"fleet-detail__section",children:[f.jsx("h4",{children:"Costruzione"}),I&&q?f.jsxs("div",{className:"fleet-construction-card",children:[f.jsxs("div",{children:[f.jsx("p",{className:"fleet-construction__title",children:"Cantiere in costruzione"}),f.jsxs("small",{className:"text-muted",children:["Progresso:"," ",Math.round((1-q.ticksRemaining/Math.max(1,q.totalTicks))*100),"%"]})]}),f.jsx("button",{className:"panel__action panel__action--compact",disabled:!0,children:"In corso"})]}):Ee?f.jsx("p",{className:"text-muted",children:"Cantiere orbitale gi presente nel sistema."}):de.length>0?de.map(L=>f.jsxs("div",{className:"fleet-construction-card",children:[f.jsxs("div",{children:[f.jsx("p",{className:"fleet-construction__title",children:L.label}),f.jsx("small",{className:"text-muted",children:re??"Richiede costruttrice nel sistema e risorse."})]}),f.jsx("button",{className:"panel__action panel__action--compact",onClick:U,disabled:!ee,children:"Costruisci"})]},L.id)):f.jsx("p",{className:"text-muted",children:re??"Nessuna azione disponibile."})]})}):null]})},Tw={NO_SESSION:"Nessuna sessione attiva.",SYSTEM_NOT_FOUND:"Sistema non valido.",SYSTEM_NOT_SURVEYED:"Serve sondare il sistema.",TECH_MISSING:"Richiede tecnologia Cantiere orbitale.",IN_PROGRESS:"Costruzione gia in corso.",ALREADY_BUILT:"Cantiere gia presente.",NO_CONSTRUCTOR:"Serve una nave costruttrice nel sistema.",INSUFFICIENT_RESOURCES:"Risorse insufficienti."},Cw=({fleet:a,systems:i,designs:l,completedTechs:o,onOrder:r,onAnchorChange:c,onBuildShipyard:d,onStop:m,onCenter:p})=>{const[y,v]=j.useState(null),g=j.useMemo(()=>new Map(l.map(I=>[I.id,I])),[l]),b=i.find(I=>I.id===a.systemId),S=b?.shipyardBuild,_=!!S,N=!!b?.hasShipyard,M=o.includes("orbital-shipyard")&&!N&&!_,T=b?.orbitingPlanets?.map(I=>({id:I.id,name:I.name??I.id}))??[],w=i.filter(I=>I.visibility==="surveyed"),z=()=>{if(!d||!b)return;const I=d(b.id,a.anchorPlanetId??null);I.success?v("Costruzione cantiere avviata."):I.reason&&v(Tw[I.reason]??"Azione non disponibile.")},D=S&&S.totalTicks>0?Math.round((1-S.ticksRemaining/Math.max(1,S.totalTicks))*100):0,A=()=>a.ships.map(I=>g.get(I.designId)?.name??I.designId).join(", "),q=[{id:"shipyard",label:"Cantiere orbitale",description:N?"Cantiere gia presente in questo sistema.":"Permette di produrre nuove navi direttamente nel sistema.",actionLabel:_?"In corso":N?"Completato":"Costruisci",enabled:M&&!N,onAction:z,status:_?`Progresso ${D}%`:void 0},{id:"orbital-defense",label:"Difese orbitali",description:"Slot disponibile per strutture difensive (non ancora ricercate).",actionLabel:"Bloccato",enabled:!1,status:"Richiede tecnologia difese orbitali"},{id:"mining-hub",label:"Hub minerario",description:"Incrementa la raccolta risorse di sistema (prossimamente).",actionLabel:"Bloccato",enabled:!1,status:"Progetto non sbloccato"}];return f.jsxs("div",{className:"constructor-window",children:[f.jsxs("header",{className:"constructor-window__header",children:[f.jsxs("div",{children:[f.jsx("p",{className:"eyebrow",children:"Nave costruttrice"}),f.jsx("h3",{children:a.name??a.id}),f.jsx("p",{className:"text-muted",children:"Gestione operazioni orbitali e costruzioni di sistema."}),f.jsxs("div",{className:"constructor-detail__tags",children:[f.jsx("span",{className:"pill pill--glass",children:b?.name??a.systemId}),a.targetSystemId?f.jsxs("span",{className:"pill pill--glass",children:["In rotta verso"," ",i.find(I=>I.id===a.targetSystemId)?.name??a.targetSystemId]}):f.jsx("span",{className:"pill pill--glass",children:"In stazione"})]})]}),f.jsxs("div",{className:"constructor-detail__actions",children:[f.jsx("button",{className:"hud-icon-btn","data-tooltip":"Centra",onClick:()=>p?.(a.systemId),children:f.jsx(Hd,{size:14})}),f.jsx("button",{className:"hud-icon-btn","data-tooltip":"Ferma",onClick:()=>m?.(a.id),children:f.jsx(gr,{size:14})})]})]}),f.jsxs("div",{className:"constructor-window__body",children:[f.jsxs("div",{className:"constructor-column",children:[f.jsxs("section",{className:"constructor-card constructor-card--column composition-card",children:[f.jsx("header",{className:"constructor-card__header",children:f.jsx("p",{className:"eyebrow",children:"Composizione"})}),f.jsx("p",{className:"text-muted",children:A()||"Nessuna nave attiva."})]}),f.jsxs("section",{className:"constructor-card constructor-card--column",children:[f.jsx("header",{className:"constructor-card__header",children:f.jsx("p",{className:"eyebrow",children:"Navigazione"})}),f.jsxs("div",{className:"constructor-controls",children:[f.jsx("label",{className:"text-muted",children:"Destinazione"}),f.jsx("select",{value:a.targetSystemId??a.systemId,onChange:I=>r(a.id,I.target.value),children:w.map(I=>f.jsx("option",{value:I.id,children:I.name},I.id))}),f.jsx("label",{className:"text-muted",children:"Aggancio"}),f.jsxs("select",{value:a.anchorPlanetId??"",onChange:I=>c(a.id,I.target.value?I.target.value:null),children:[f.jsx("option",{value:"",children:"Stella"}),T.map(I=>f.jsx("option",{value:I.id,children:I.name},I.id))]})]})]})]}),f.jsxs("section",{className:"constructor-card constructor-card--column constructor-card--projects",children:[f.jsxs("header",{className:"constructor-card__header",children:[f.jsx("p",{className:"eyebrow",children:"Progetti orbitali"}),_?f.jsx("span",{className:"pill",children:"In costruzione"}):f.jsx("span",{className:"pill pill--glass",children:N?"Cantiere attivo":"Pronto"})]}),_&&S?f.jsxs("div",{className:"build-progress",children:[f.jsx("div",{className:"build-progress__bar",children:f.jsx("span",{style:{width:`${D}%`}})}),f.jsxs("p",{className:"text-muted",children:["Progresso: ",D,"%"]})]}):null,f.jsx("div",{className:"build-projects",children:q.map(I=>f.jsxs("div",{className:`build-project ${I.enabled?"":"is-disabled"}`,children:[f.jsxs("div",{children:[f.jsx("p",{className:"build-project__title",children:I.label}),f.jsx("small",{className:"text-muted",children:I.description}),I.status?f.jsx("small",{className:"text-muted",children:I.status}):null]}),f.jsx("button",{className:"panel__action panel__action--compact",onClick:I.onAction,disabled:!I.enabled,children:I.actionLabel})]},I.id))})]})]}),y?f.jsx("p",{className:"panel-message",children:y}):null]})},zw={idle:"In stazione",traveling:"In viaggio",surveying:"Sondando"},Dw=({ship:a,systems:i,onOrder:l,onAnchorChange:o,onToggleAuto:r,onStop:c,onCenter:d,onClose:m})=>{const p=b=>b?i.find(S=>S.id===b)?.name??b:"N/D",y=i.filter(b=>b.visibility!=="unknown"),g=i.find(b=>b.id===a.currentSystemId)?.orbitingPlanets?.map(b=>({id:b.id,name:b.name??b.id}))??[];return f.jsxs("div",{className:"science-detail",children:[f.jsxs("header",{className:"science-detail__header",children:[f.jsxs("div",{className:"science-detail__titleblock",children:[f.jsx("p",{className:"fleet-detail__eyebrow",children:"Dettagli nave scientifica"}),f.jsx("h3",{className:"fleet-detail__title",children:a.name??a.id}),f.jsxs("div",{className:"science-detail__meta",children:[f.jsxs("span",{className:`pill ${a.status!=="idle"?"pill--success":""}`,children:[f.jsx(Jg,{size:14})," ",zw[a.status]]}),f.jsx("span",{className:"pill pill--glass",children:a.anchorPlanetId?"Agganciata a pianeta":"Agganciata a stella"}),f.jsxs("label",{className:"science-detail__toggle",children:[f.jsx("input",{type:"checkbox",checked:a.autoExplore,onChange:b=>r(b.target.checked)}),f.jsx("span",{children:"Auto esplorazione"})]})]})]}),f.jsx("button",{className:"dock-detail__close",onClick:m,"aria-label":"Chiudi dettaglio",children:""})]}),f.jsxs("section",{className:"science-detail__section",children:[f.jsxs("div",{className:"science-detail__row science-detail__row--split",children:[f.jsxs("div",{className:"science-detail__card",children:[f.jsx("span",{className:"text-muted",children:"Sistema attuale"}),f.jsx("p",{className:"science-detail__value",children:p(a.currentSystemId)}),f.jsxs("small",{className:"text-muted",children:["ID: ",a.currentSystemId]})]}),f.jsxs("div",{className:"science-detail__card",children:[f.jsx("span",{className:"text-muted",children:"Destinazione"}),f.jsx("p",{className:"science-detail__value",children:a.targetSystemId?p(a.targetSystemId):"Nessuna"}),f.jsx("small",{className:"text-muted",children:a.ticksRemaining>0?`${a.ticksRemaining} tick`:"N/D"})]})]}),f.jsxs("div",{className:"science-detail__actions",children:[f.jsx("button",{className:"hud-icon-btn",onClick:()=>d?.(a.currentSystemId),"data-tooltip":"Centra sulla nave","aria-label":"Centra nave",children:f.jsx(Hd,{size:14})}),a.targetSystemId?f.jsx("button",{className:"hud-icon-btn",onClick:()=>d?.(a.targetSystemId??a.currentSystemId),"data-tooltip":"Centra destinazione","aria-label":"Centra destinazione",children:f.jsx(tE,{size:14})}):null,f.jsx("button",{className:"hud-icon-btn",onClick:c,"data-tooltip":"Ferma nave","aria-label":"Ferma",children:f.jsx(gr,{size:14})})]}),f.jsxs("div",{className:"science-detail__controls",children:[f.jsxs("label",{className:"science-detail__field",children:[f.jsx("span",{children:"Ordina su sistema"}),f.jsxs("select",{value:a.targetSystemId??"",onChange:b=>l(b.target.value),children:[f.jsx("option",{value:"",children:"Seleziona sistema"}),y.map(b=>f.jsx("option",{value:b.id,children:b.name},b.id))]})]}),f.jsxs("label",{className:"science-detail__field",children:[f.jsx("span",{children:"Aggancio (sistema attuale)"}),f.jsxs("select",{value:a.anchorPlanetId??"",onChange:b=>o(b.target.value?b.target.value:null),children:[f.jsx("option",{value:"",children:"Stella"}),g.map(b=>f.jsx("option",{value:b.id,children:b.name},b.id))]})]}),f.jsxs("div",{className:"science-detail__hint",children:[f.jsx(dE,{size:14}),f.jsx("span",{children:"Ordina verso un sistema rivelato per sondare o visualizzare i dettagli. Usa Auto esplorazione per farla pattugliare automaticamente."})]})]})]})]})},Rw=()=>{jN();const a=$(O=>O.session),i=a?.id,l=$(O=>O.returnToMenu),o=$(O=>O.setSimulationRunning),r=we(Ki),c=we(mr),d=we(Ud),m=we(Bg),p=we(Og),y=j.useMemo(()=>p?Object.values(p.branches).flatMap(O=>O.completed):[],[p]),v=j.useMemo(()=>p?Object.values(p.branches).some(O=>O.completed.includes("colony-foundations")):!1,[p]),[g,b]=j.useState(null),[S,_]=j.useState(0),[N,M]=j.useState(null),[T,w]=j.useState(null),[z,D]=j.useState(null),[A,q]=j.useState(null),[I,G]=j.useState(null),[F,Z]=j.useState(null),[J,ee]=j.useState(!1),[re,de]=j.useState(!1),[Ee,U]=j.useState(!1),[L,K]=j.useState(!1),[fe,te]=j.useState(!1),[Ae,le]=j.useState(!1),[ye,Le]=j.useState(!1),[et,vt]=j.useState(!1),[Qn,Sn]=j.useState(!1),[ga,Zn]=j.useState(!1),[ct,tt]=j.useState(null),Wi=$(O=>O.orderFleetMove),oa=$(O=>O.setFleetPosition),Ji=$(O=>O.mergeFleets),es=$(O=>O.splitFleet),_l=$(O=>O.stopFleet),ts=$(O=>O.buildShipyard),Fn=$(O=>O.config.military.shipDesigns),as=$(O=>O.orderScienceShip),ns=$(O=>O.setScienceShipPosition),yr=$(O=>O.setScienceAutoExplore),vr=$(O=>O.stopScienceShip),ft=$(O=>O.queueDistrictConstruction),br=$(O=>O.removeDistrict),Nl=$(O=>O.promotePopulation),El=$(O=>O.demotePopulation),ra=$(O=>O.config.economy),is=j.useRef(null),ss=j.useRef(null),{warUnread:xr,unreadWarIds:Sr,markWarsRead:Ga}=Ij(a??null),ut=()=>{b(null),M(null),w(null),D(null),q(null),G(null),Z(null)},ca=()=>{M(null),b(null),G(null)};j.useEffect(()=>{i&&o(!0,Date.now())},[i,o]),j.useEffect(()=>{const O=()=>{o(!document.hidden,Date.now())};return document.addEventListener("visibilitychange",O),()=>{document.removeEventListener("visibilitychange",O)}},[o]),j.useEffect(()=>{if(!a){is.current=null;return}if(is.current===a.id)return;const O=a.economy.planets[0]?.systemId??a.galaxy.systems[0]?.id??null;O&&(b(O),G(null),w(null),D(null),Z(null)),is.current=a.id},[a,G,b]);const at=typeof window<"u"?window.innerWidth:1200,ls=typeof window<"u"?window.innerHeight:800,se=((O,oe)=>{const ht=Math.min(O,at-40),Ct=Math.min(oe,ls-80),Jn=Math.max(20,(at-ht)/2),os=Math.max(20,(ls-Ct)/2);return{width:ht,height:Ct,initialX:Jn,initialY:os}})(1e3,700);if(!a)return f.jsxs("div",{className:"game-layout",children:[f.jsx(D0,{}),f.jsxs("div",{className:"floating-panels",children:[f.jsx("p",{className:"text-muted",children:"Nessuna sessione attiva."}),f.jsx("button",{className:"panel__action",onClick:l,children:"Torna al menu"})]})]});const Kn=N?r.find(O=>O.id===N)??null:null,$n=T?r.find(O=>O.id===T)??null:null,qa=z?c.find(O=>O.id===z)??null:null,ya=z&&g?r.find(O=>O.id===g)?.orbitingPlanets.find(O=>O.id===z)??null:null,Wn=qa?r.find(O=>O.id===qa.systemId)??null:g?r.find(O=>O.id===g)??null:null,ua=ct?.kind==="fleet"?a.fleets.find(O=>O.id===ct.fleetId)??null:null,_r=ct?.kind==="fleet"&&ct.source==="construction",va=ct?.kind==="science"?a.scienceShips.find(O=>O.id===ct.shipId)??null:null,bt=A&&a?a.economy.planets.find(O=>O.id===A)??null:null;return f.jsxs("div",{className:"game-layout",children:[f.jsx(D0,{}),f.jsx(Xj,{onOpenMissions:()=>ee(!0),onOpenEvents:()=>de(!0),onOpenDiplomacy:()=>U(!0),onOpenEconomy:()=>K(!0),onOpenResearch:()=>te(!0),onOpenGalaxy:()=>le(!0),onOpenColonization:()=>Le(!0),onOpenBattles:()=>vt(!0),onOpenLog:()=>Sn(!0),showColonization:v}),f.jsxs("div",{className:"side-entity-stack",children:[f.jsx(el,{variant:"colonies",onCenter:(O,oe)=>{b(O),_(ht=>ht+1),G(oe??null),w(null),D(null),tt(null)},onSelect:O=>{O.kind==="colony"&&(D(null),q(O.planetId),tt(null))}}),f.jsx(el,{variant:"fleets",onCenter:O=>{b(O),_(oe=>oe+1),G(null),w(null),D(null),tt(null)},onSelect:O=>{tt(O),G(null)}}),f.jsx(el,{variant:"colonization",onCenter:O=>{b(O),_(oe=>oe+1),G(null),w(null),D(null),tt(null)},onSelect:O=>{tt(O),G(null)}}),f.jsx(el,{variant:"construction",onCenter:O=>{b(O),_(oe=>oe+1),G(null),w(null),D(null),tt(null)},onSelect:O=>{tt(O),G(null)}}),f.jsx(el,{variant:"science",onCenter:O=>{b(O),_(oe=>oe+1),G(null),w(null),D(null),tt(null)},onSelect:O=>{tt(O),G(null)}})]}),f.jsx(zj,{focusSystemId:g,focusPlanetId:I,focusTrigger:S,mapMessage:F,onSelectSystem:O=>{const oe=r.find(Ct=>Ct.id===O);if(!oe)return;const ht=oe.visibility==="surveyed"||d.has(oe.id);D(null),w(ht?O:null),b(O),G(null),Z(ht?null:"Sistema non sondato: esplora con una nave scientifica per ottenere i dettagli.")},onClearFocus:ut,onSelectShipyard:O=>{const oe=r.find(Jn=>Jn.id===O);if(!oe)return;const ht=oe.visibility==="surveyed"||d.has(oe.id),Ct=oe.hasShipyard||!!oe.shipyardBuild;M(ht&&Ct?O:null),w(null),D(null),b(O),G(null)},onSelectPlanet:(O,oe)=>{b(oe),G(O),a?.economy.planets.some(Ct=>Ct.id===O)??!1?(q(O),D(null)):(D(O),q(null)),_(Ct=>Ct+1)}}),f.jsx(UE,{onToggleDebug:()=>Zn(!0),debugOpen:ga,onShowWars:()=>{const O=ss.current;O&&O.scrollIntoView({behavior:"smooth",block:"center"}),Ga()},warUnread:xr}),f.jsxs("div",{className:"floating-panels",children:[f.jsx(Bj,{focusedSystem:$n,focusedPlanet:qa,focusedOrbitingPlanet:ya,focusedPlanetSystem:Wn??null,viewportWidth:at,viewportHeight:ls,onClearFocusTargets:ut,shipyardSystem:Kn,closeShipyard:ca}),J?f.jsx(Lt,{title:"Missioni in corso",initialX:se.initialX,initialY:se.initialY,initialWidth:se.width,initialHeight:se.height,onClose:()=>ee(!1),children:f.jsx(Vj,{})}):null,re?f.jsx(Lt,{title:"Eventi & Anomalie",initialX:se.initialX,initialY:se.initialY,initialWidth:se.width,initialHeight:se.height,onClose:()=>de(!1),children:f.jsx(aw,{})}):null,Ee?f.jsx(Lt,{title:"Diplomazia",initialX:se.initialX,initialY:se.initialY,initialWidth:se.width,initialHeight:se.height,onClose:()=>U(!1),children:f.jsx($j,{})}):null,L?f.jsx(Lt,{title:"Bilancio economico",initialX:se.initialX,initialY:se.initialY,initialWidth:se.width,initialHeight:se.height,onClose:()=>K(!1),children:f.jsx(Jj,{})}):null,fe?f.jsx(Lt,{title:"Ricerca & Tradizioni",initialX:se.initialX,initialY:se.initialY,initialWidth:se.width,initialHeight:se.height,onClose:()=>te(!1),children:f.jsx(nw,{})}):null,Ae?f.jsx(Lt,{title:"Panoramica galassia",initialX:se.initialX,initialY:se.initialY,initialWidth:se.width,initialHeight:se.height,onClose:()=>le(!1),children:f.jsx(ow,{onFocusSystem:O=>{le(!1),b(O),G(null),w(null),D(null)}})}):null,ye?f.jsx(Lt,{title:"Colonizzazione",initialX:se.initialX,initialY:se.initialY,initialWidth:se.width,initialHeight:se.height,onClose:()=>Le(!1),children:f.jsx(fw,{onFocusSystem:O=>{Le(!1),b(O),G(null),w(null),D(null)}})}):null,et?f.jsx(Lt,{title:"Flotte & Battaglie",initialX:se.initialX,initialY:se.initialY,initialWidth:se.width,initialHeight:se.height,onClose:()=>vt(!1),children:f.jsx(Sw,{warEventsRef:ss,unreadWarIds:Sr,onMarkWarRead:Ga})}):null,Qn?f.jsx(Lt,{title:"Log eventi",initialX:se.initialX,initialY:se.initialY,initialWidth:se.width,initialHeight:se.height,onClose:()=>Sn(!1),children:f.jsx(Nw,{})}):null,bt?f.jsx(Lt,{title:`Gestione - ${bt.name}`,initialX:se.initialX,initialY:se.initialY,initialWidth:se.width,initialHeight:se.height,onClose:()=>q(null),children:f.jsx(_w,{planet:bt,systemName:r.find(O=>O.id===bt.systemId)?.name??bt.systemId,onPromote:O=>Nl(bt.id,O),onDemote:O=>El(bt.id,O),automationConfig:ra.populationAutomation,populationJobs:ra.populationJobs,districtDefinitions:ra.districts,canAffordDistricts:Object.fromEntries(ra.districts.map(O=>[O.id,Fi(a.economy,O.cost)])),planetDistrictQueue:a.districtConstructionQueue.filter(O=>O.planetId===bt.id).map(O=>{const oe=ra.districts.find(ht=>ht.id===O.districtId);return{...O,label:oe?.label??O.districtId,progress:1-O.ticksRemaining/Math.max(1,O.totalTicks)}}),populationMessage:null,onQueueDistrict:O=>ft(bt.id,O),onRemoveDistrict:O=>br(bt.id,O)})}):null,ct&&ct.kind==="fleet"?_r?f.jsx(Lt,{title:"Nave costruttrice",initialX:se.initialX,initialY:se.initialY,initialWidth:se.width,initialHeight:se.height,onClose:()=>tt(null),children:ua?f.jsx(Cw,{fleet:ua,systems:r,designs:Fn,completedTechs:y,onOrder:(O,oe)=>Wi(O,oe),onAnchorChange:(O,oe)=>oa(O,oe),onBuildShipyard:(O,oe)=>ts(O,oe),onCenter:O=>{b(O),G(null),w(null),D(null),_(oe=>oe+1)},onStop:O=>_l(O)}):f.jsx("div",{className:"dock-detail__content",children:f.jsx("p",{className:"text-muted",children:"Flotta non trovata."})})}):f.jsx("div",{className:"dock-detail-modal",children:ua?f.jsx(ww,{fleet:ua,fleets:a.fleets,systems:r,scienceShips:m,designs:Fn,completedTechs:y,onOrder:(O,oe)=>Wi(O,oe),onAnchorChange:(O,oe)=>oa(O,oe),onCenter:O=>{b(O),G(null),w(null),D(null),_(oe=>oe+1)},onStop:O=>_l(O),onMerge:(O,oe)=>Ji(O,oe),onSplit:O=>es(O),showConstructionActions:ct?.source==="construction",onBuildShipyard:(O,oe)=>ts(O,oe),onClose:()=>tt(null)}):f.jsx("div",{className:"dock-detail__content",children:f.jsx("p",{className:"text-muted",children:"Flotta non trovata."})})}):null,ct&&ct.kind==="science"?f.jsx("div",{className:"dock-detail-modal",children:va?f.jsx(Dw,{ship:va,systems:r,onOrder:O=>as(va.id,O),onAnchorChange:O=>ns(va.id,O),onToggleAuto:O=>yr(va.id,O),onStop:()=>vr(va.id),onCenter:O=>{b(O),G(null),w(null),D(null),_(oe=>oe+1)},onClose:()=>tt(null)}):f.jsx("div",{className:"dock-detail__content",children:f.jsx("p",{className:"text-muted",children:"Nave non trovata."})})}):null,ga?f.jsx(Lt,{title:"Console debug",initialX:se.initialX,initialY:se.initialY,initialWidth:se.width,initialHeight:se.height,onClose:()=>Zn(!1),children:f.jsx(wN,{})}):null]})]})},qd=a=>a.replace(/\/+/g,"/"),Aw=a=>a.replace(/\/+$/,""),kw=a=>a.replace(/^\/+/,""),ry=a=>{const i=qd(a);return i==="/"?"/":Aw(i)},Ow=a=>kw(qd(a)),Uw=()=>ry("/fls-node-epicronicles/"),na=a=>{const i=ry("/fls-node-epicronicles/"),l=Ow(a),o=`${i}/${l}`;return qd(o)},cy=({background:a,showBrand:i=!0,toast:l=null,children:o})=>f.jsxs("div",{className:"main-menu",style:{backgroundImage:`url(${a})`},children:[f.jsx("div",{className:"main-menu__overlay"}),i?f.jsx("header",{className:"main-menu__brand",children:f.jsx("img",{src:na("/pages/main-menu/logo-full.png"),alt:"FLS Node Epicronicles logo",className:"main-menu__logo"})}):null,f.jsx("div",{className:"main-menu__content",children:o}),l?f.jsx("div",{className:"main-menu__toast",children:l}):null]}),Lw=({background:a,canLoad:i,onStart:l,onLoad:o,toast:r=null})=>f.jsx(cy,{background:a,toast:r,showBrand:!0,children:f.jsxs("div",{className:"main-menu__dock",children:[f.jsx("div",{className:"main-menu__dock-title",children:"Mission Control"}),f.jsx("button",{className:"main-menu__action",onClick:l,children:"Inizia partita"}),f.jsx("button",{className:"main-menu__action",onClick:o,disabled:!i,children:"Carica"})]})}),Bw=({background:a,seed:i,presetId:l,presets:o,galaxyShape:r,onSeedChange:c,onPresetChange:d,onShapeChange:m,onConfirm:p,onBack:y})=>f.jsx(cy,{background:a,showBrand:!1,children:f.jsx("div",{className:"session-setup",children:f.jsxs("div",{className:"setup-card",children:[f.jsxs("div",{className:"setup-card__header",children:[f.jsxs("div",{children:[f.jsx("p",{className:"setup-card__eyebrow",children:"Nuova sessione"}),f.jsx("h1",{className:"setup-card__title",children:"Configura la partita"}),f.jsx("p",{className:"setup-card__subtitle",children:"Imposta seed e preset della galassia prima di partire."})]}),f.jsx("button",{className:"setup-card__link",type:"button",onClick:y,"aria-label":"Torna alla schermata principale",children:"Torna indietro"})]}),f.jsxs("div",{className:"setup-card__form",children:[f.jsxs("label",{className:"setup-card__field",children:[f.jsx("span",{children:"Galaxy seed"}),f.jsx("input",{value:i,onChange:v=>c(v.target.value),"aria-label":"Galaxy seed"})]}),f.jsxs("label",{className:"setup-card__field",children:[f.jsx("span",{children:"Galaxy preset"}),f.jsx("select",{value:l,onChange:v=>d(v.target.value),"aria-label":"Galaxy preset",children:o.map(v=>f.jsxs("option",{value:v.id,children:[v.label," (",v.systemCount," sistemi)"]},v.id))})]}),f.jsxs("label",{className:"setup-card__field",children:[f.jsx("span",{children:"Forma galassia"}),f.jsxs("select",{value:r,onChange:v=>m(v.target.value),"aria-label":"Forma galassia",children:[f.jsx("option",{value:"circle",children:"Tonda"}),f.jsx("option",{value:"spiral",children:"Spirale"})]})]})]}),f.jsx("div",{className:"setup-card__footer",children:f.jsx("button",{className:"setup-card__primary",type:"button",onClick:p,children:"Avvia sessione"})})]})})}),tr=[na("/pages/main-menu/backgrounds/main-menu-background-1.png"),na("/pages/main-menu/backgrounds/main-menu-background-2.png"),na("/pages/main-menu/backgrounds/main-menu-background-3.png"),na("/pages/main-menu/backgrounds/main-menu-background-4.png"),na("/pages/main-menu/backgrounds/main-menu-background-5.png"),na("/pages/main-menu/backgrounds/main-menu-background-6.png"),na("/pages/main-menu/backgrounds/main-menu-background-7.png"),na("/pages/main-menu/backgrounds/main-menu-background-8.png"),na("/pages/main-menu/backgrounds/main-menu-background-9.png"),na("/pages/main-menu/backgrounds/main-menu-background-10.png")],Pw=a=>tr[a%tr.length]??tr[0],Iw=()=>Math.floor(Math.random()*tr.length),Hw=()=>{const a=$(z=>z.startNewSession),i=$(z=>z.loadSession),l=$(z=>z.hasSavedSession),o=$(z=>z.config),[r,c]=j.useState(o.defaultGalaxy.seed),[d,m]=j.useState(o.defaultGalaxy.galaxyShape??"circle"),p=o.galaxyPresets.find(z=>z.id==="standard")?.id??o.galaxyPresets[0]?.id??"standard",[y,v]=j.useState(p),[g,b]=j.useState("landing"),[S,_]=j.useState(null),[N]=j.useState(()=>Iw()),M=j.useMemo(()=>Pw(N),[N]),T=j.useCallback(()=>{const z=i();_(z.success?"Ultimo salvataggio caricato.":"Nessun salvataggio disponibile o file non valido."),b("landing")},[i]),w=j.useCallback(()=>{a({seed:r,presetId:y,galaxyShape:d}),_(null)},[a,r,y,d]);return g==="landing"?f.jsx(Lw,{background:M,canLoad:l(),onStart:()=>{b("setup"),_(null)},onLoad:T,toast:S}):f.jsx(Bw,{background:M,seed:r,presetId:y,presets:o.galaxyPresets,galaxyShape:d,onSeedChange:c,onPresetChange:v,onShapeChange:m,onConfirm:w,onBack:()=>b("landing")})},tl={mainMenu:"/",game:"/game"},Gw=()=>{const a=$(d=>d.view),i=$(d=>d.config.debug.autoStart),l=$(d=>!!d.session),o=$(d=>d.startNewSession),r=wd();j.useEffect(()=>{i&&!l&&o()},[i,l,o]),j.useEffect(()=>{a==="simulation"?r(tl.game,{replace:!0}):r(tl.mainMenu,{replace:!0})},[a,r]);const c=a==="mainMenu";return f.jsx("div",{className:`app-shell ${c?"app-shell--menu":""}`,children:f.jsxs(ux,{children:[f.jsx($o,{path:tl.mainMenu,element:f.jsx(Hw,{})}),f.jsx($o,{path:tl.game,element:a==="simulation"?f.jsx(Rw,{}):f.jsx(e0,{to:tl.mainMenu,replace:!0})}),f.jsx($o,{path:"*",element:f.jsx(e0,{to:c?"/":"/game",replace:!0})})]})})},qw=Uw();K1.createRoot(document.getElementById("root")).render(f.jsx(j.StrictMode,{children:f.jsx(hb,{store:a_,children:f.jsx(Ax,{basename:qw,children:f.jsx(Gw,{})})})}));export{T_ as a,C_ as b,we as c,Xw as d,Og as e,f as j,j as r,Od as s,$ as u};
