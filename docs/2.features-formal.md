Di seguito trovi una versione **SRS (Software Requirements Specification)**, strutturata e numerata, basata sull’analisi funzionale del gioco single player “tipo Stellaris” che abbiamo discusso.

---

# 1. Introduzione

## 1.1 Scopo del documento

SRS per un videogioco di strategia 4X/grand strategy spaziale single player.
Il documento definisce i **requisiti funzionali e non funzionali** del sistema, e una serie di **casi d’uso** principali.

## 1.2 Scopo del sistema

Il sistema permette al giocatore di guidare un impero spaziale, esplorare una galassia generata proceduralmente, colonizzare pianeti, gestire risorse, interagire con imperi IA tramite diplomazia e guerra, sviluppare tecnologia e affrontare crisi di fine partita.

## 1.3 Definizioni, acronimi e abbreviazioni

* **4X**: Explore, Expand, Exploit, Exterminate.
* **FTL**: Faster Than Light, viaggio più rapido della luce.
* **Pop**: unità di popolazione su un pianeta.
* **IA**: Intelligenza Artificiale.
* **RF-XXX-NN**: Requisito Funzionale.
* **RNF-XXX-NN**: Requisito Non Funzionale.
* **UC-XX**: Caso d’uso.

## 1.4 Riferimenti

* Visione di design e analisi funzionale interna (documento sorgente non formale).

## 1.5 Panoramica documento

* Sezione 2: descrizione generale del sistema.
* Sezione 3: requisiti funzionali numerati.
* Sezione 4: requisiti non funzionali.
* Sezione 5: casi d’uso.

---

# 2. Descrizione generale

## 2.1 Prospettiva del prodotto

* Gioco PC single player, **strategia spaziale 4X** in tempo reale con pausa.
* Nessuna componente multiplayer prevista nel perimetro attuale.

## 2.2 Funzioni generali

A livello alto, il sistema offre:

* Generazione procedurale di una galassia.
* Gestione di un impero (pianeti, popolazione, risorse, politiche).
* Esplorazione di sistemi stellari e anomalie.
* Gestione di flotte e combattimenti spaziali.
* Diplomazia e relazioni con imperi IA.
* Ricerca tecnologica e progressione.
* Eventi dinamici, catene narrative e crisi di fine partita.
* Interfaccia utente per controllo e visualizzazione dello stato di gioco.

## 2.3 Tipi di utente

* **Giocatore umano**: unico utente interattivo.
* **Imperi IA**: agenti software che simulano civiltà rivali/alleate.

## 2.4 Vincoli generali

* Modalità **solo offline / single player**.
* Il sistema deve supportare **pausa e variazione velocità** del tempo di gioco.
* Il sistema deve supportare **salvataggio e caricamento** di partite.

## 2.5 Assunzioni e dipendenze

* Si assume la disponibilità di un motore di gioco compatibile (interno o di terze parti).
* Si assume hardware PC consumer moderno (dettagli da definire in altro documento tecnico).

---

# 3. Requisiti funzionali

## 3.1 Gestione e generazione della galassia

**RF-GAL-01**
Il sistema deve permettere al giocatore di configurare i parametri della galassia nella schermata “Nuova partita” (almeno: dimensione, numero di stelle, numero di imperi IA).

**RF-GAL-02**
Il sistema deve generare proceduralmente la galassia sulla base dei parametri selezionati, creando un insieme di sistemi stellari collegati tramite rotte FTL (es. iperlinee).

**RF-GAL-03**
Ogni sistema stellare deve avere almeno i seguenti attributi: identificativo univoco, tipo di stella, elenco di corpi celesti (pianeti, lune, ecc.), eventuali risorse orbitali, eventuali anomalie.

**RF-GAL-04**
Per ogni sistema deve essere tracciato lo stato rispetto a ciascun impero: non scoperto, scoperto (visibile), esplorato (survey), controllato (contiene colonie o stazioni dell’impero).

**RF-GAL-05**
Il sistema deve mantenere la topologia delle connessioni FTL tra sistemi (grafo di adiacenza) per supportare il pathfinding delle flotte.

**RF-GAL-06**
Il sistema deve poter inserire opzionalmente elementi speciali nella galassia (es. buchi neri, sistemi ricchi di risorse, imperi “caduti”), secondo parametri di generazione.

---

## 3.2 Gestione partita (nuova, carica, salvataggio)

**RF-GAM-01**
Il sistema deve fornire un menu principale con almeno: Nuova partita, Carica partita, Opzioni, Esci.

**RF-GAM-02**
Il sistema deve permettere la creazione di una nuova partita, includendo selezione/creazione dell’impero del giocatore e configurazione galassia.

**RF-GAM-03**
Il sistema deve permettere di salvare lo stato della partita su richiesta del giocatore e tramite salvataggi automatici configurabili.

**RF-GAM-04**
Il sistema deve permettere di caricare una partita salvata, ripristinando lo stato di gioco (galassia, impero, IA, eventi).

**RF-GAM-05**
Il sistema deve rilevare e gestire lo stato di **fine partita** (vittoria, sconfitta, abbandono), presentando una schermata riassuntiva.

---

## 3.3 Esplorazione, navi scientifiche e fog of war

**RF-EXP-01**
Il sistema deve creare almeno una nave scientifica iniziale per l’impero del giocatore all’inizio della partita.

**RF-EXP-02**
Il giocatore deve poter selezionare una nave scientifica e impartire l’ordine di muoversi verso un sistema stellare accessibile.

**RF-EXP-03**
Il giocatore deve poter impartire a una nave scientifica l’ordine di esplorare (survey) un sistema, aggiornando lo stato del sistema a “esplorato” al completamento.

**RF-EXP-04**
Il sistema deve implementare una fog of war tale che i sistemi non scoperti non mostrino dettagli (pianeti, risorse, ecc.) al giocatore.

**RF-EXP-05**
Il sistema deve poter generare anomalie durante l’esplorazione dei sistemi; tali anomalie devono essere identificabili e, se analizzate, generare un evento (vedi 3.7).

---

## 3.4 Gestione dell’impero: risorse, pianeti, popolazione

### 3.4.1 Risorse

**RF-IMP-RES-01**
Il sistema deve gestire almeno le seguenti risorse globali: energia, minerali, cibo, punti ricerca (per rami tecnologici), eventuale risorsa politica/influenza.

**RF-IMP-RES-02**
Per ogni risorsa deve essere mantenuto un bilancio per tick di simulazione (produzione totale, consumo totale, variazione netta).

**RF-IMP-RES-03**
Il sistema deve aggiornare lo stock di ciascuna risorsa a ogni tick di simulazione, tenendo conto di produzione, consumo e capacità di stoccaggio.

### 3.4.2 Pianeti e colonizzazione

**RF-IMP-PLA-01**
Ogni pianeta potenzialmente colonizzabile deve avere attributi minimi: tipo di pianeta, dimensione, abitabilità per specie del giocatore, modificatori (es. “ricco di minerali”).

**RF-IMP-PLA-02**
Il sistema deve mettere a disposizione una unità “nave colonia” in grado di ricevere un ordine di colonizzazione verso un pianeta abitabile.

**RF-IMP-PLA-03**
Al completamento della colonizzazione, il pianeta deve essere aggiunto alla lista delle colonie dell’impero e iniziare a produrre/consumare risorse.

**RF-IMP-PLA-04**
Per ogni pianeta colonizzato deve essere disponibile una schermata di dettaglio, con almeno: nome, tipo, popolazione, produzione risorse, distretti/edifici, stabilità.

### 3.4.3 Distretti, edifici e produzione

**RF-IMP-STR-01**
Ogni pianeta deve supportare un numero limitato di **distretti** (es. minerari, energetici, agricoli, abitativi, industriali) che influenzano la produzione di risorse.

**RF-IMP-STR-02**
Il sistema deve permettere al giocatore di avviare la costruzione/demolizione di distretti ed edifici tramite una coda di costruzione per pianeta.

**RF-IMP-STR-03**
La produzione e il consumo di risorse di un pianeta devono essere calcolati in base a distretti, edifici e popolazione assegnata.

### 3.4.4 Popolazione e stabilità

**RF-IMP-POP-01**
Il sistema deve rappresentare la popolazione dei pianeti tramite unità discrete (“Pop”) con attributi minimi: specie, eventuali tratti, etica, occupazione.

**RF-IMP-POP-02**
Il sistema deve assegnare i Pop disponibili ai lavori (es. minatore, ricercatore, burocrate) per determinare la produzione di risorse.

**RF-IMP-POP-03**
Per ogni pianeta devono essere calcolati la **stabilità** e la **felicità media** della popolazione, influenzati da fattori quali: sovrappopolazione, carenze di risorse, politiche, eventi.

**RF-IMP-POP-04**
Il sistema deve applicare effetti alla produzione e all’ordine pubblico del pianeta quando la stabilità scende sotto o sale sopra determinate soglie.

---

## 3.5 Tecnologia, tradizioni e progressione

**RF-TEC-01**
Il sistema deve prevedere almeno tre rami di ricerca tecnologica distinti (ad es. fisica, società, ingegneria).

**RF-TEC-02**
Il giocatore deve poter selezionare una tecnologia da ricercare per ciascun ramo, tra un insieme di tecnologie disponibili e sbloccate da prerequisiti.

**RF-TEC-03**
Al completamento di una ricerca, il sistema deve applicare immediatamente i relativi effetti (sblocco edifici, moduli nave, bonus, ecc.).

**RF-TEC-04**
Il sistema deve fornire una schermata dedicata alla ricerca tecnologica, che mostri le tecnologie in corso, il progresso e i prerequisiti.

**RF-TEC-05**
Il sistema deve supportare almeno un meccanismo di progressione extra-tecnologica (es. “tradizioni” o “perk”) che concedano bonus permanenti sbloccati nel tempo.

---

## 3.6 Diplomazia e relazioni con imperi IA

**RF-DIP-01**
Il sistema deve generare uno o più imperi IA all’inizio di ogni partita, con parametri distintivi (etica, governo, stile di gioco).

**RF-DIP-02**
Per ogni coppia di imperi deve essere mantenuto un valore numerico di **opinione** o relazione, aggiornato nel tempo in base a eventi, etiche e azioni diplomatiche.

**RF-DIP-03**
Il giocatore deve poter accedere a una schermata di diplomazia per ciascun impero IA, visualizzando relazioni attuali, trattati in essere e informazioni essenziali sull’impero.

**RF-DIP-04**
Il giocatore deve poter proporre almeno le seguenti azioni diplomatiche: dichiarare guerra, proporre pace, accettare/rifiutare trattati.

**RF-DIP-05**
Il sistema deve implementare una logica di IA in grado di accettare o rifiutare proposte diplomatiche sulla base di criteri quali: opinione, forza militare relativa, obiettivi, situazione di guerra.

**RF-DIP-06**
Il sistema deve gestire lo **stato di guerra/pace** tra imperi, influenzando il comportamento delle flotte e la possibilità di attraversare i confini.

**RF-DIP-07**
Opzionale ma raccomandato: il sistema deve supportare trattati aggiuntivi (patti di non aggressione, alleanze difensive, accordi commerciali di base, accesso ai confini).

---

## 3.7 Flotte, navi e combattimento

**RF-CMB-01**
Il sistema deve definire un insieme di classi di nave (es. corvette, fregate, incrociatori, ecc.) con parametri di base (punti vita, slot armi, slot difesa).

**RF-CMB-02**
Il sistema deve mettere a disposizione una struttura (cantiere/spazioporto) per la costruzione di navi, con coda di produzione e costi in risorse.

**RF-CMB-03**
Il giocatore deve poter assegnare navi a flotte, creare nuove flotte, scioglierle e impartire ordini di movimento tra sistemi collegati.

**RF-CMB-04**
Quando due flotte appartenenti a imperi in stato di guerra si trovano nello stesso sistema, il sistema deve avviare un combattimento spaziale.

**RF-CMB-05**
Il combattimento deve essere simulato considerando almeno: forza offensiva totale, forza difensiva, modificatori di tecnologia e leader, con risultato in termini di navi danneggiate/distrutte.

**RF-CMB-06**
Il sistema deve notificare al giocatore l’inizio e la fine di ogni battaglia che coinvolga le sue flotte, con un riepilogo dei risultati (perdite proprie e nemiche).

**RF-CMB-07**
Opzionale ma raccomandato: il sistema deve prevedere un **designer navi** che permetta di configurare i moduli (armi, difese, utility) per ogni classe di nave.

---

## 3.8 Eventi, narrazione dinamica e crisi

**RF-EVT-01**
Il sistema deve supportare un meccanismo di generazione di **eventi** in risposta a condizioni di gioco (esplorazione, colonizzazione, guerre, soglie di risorse).

**RF-EVT-02**
Ogni evento deve presentare al giocatore almeno una descrizione testuale e due o più opzioni di risposta, ciascuna con effetti distinti sullo stato di gioco.

**RF-EVT-03**
Il sistema deve supportare **catene di eventi** composte da più step sequenziali, dove le scelte precedenti influenzano gli eventi successivi.

**RF-EVT-04**
Il sistema deve fornire un **log eventi** consultabile, che registri cronologicamente gli eventi rilevanti e le scelte del giocatore.

**RF-EVT-05**
Il sistema deve implementare almeno un tipo di **crisi di fine partita** (endgame crisis) che introduca una minaccia significativa a scala galattica e che possa condurre alla sconfitta o vittoria cooperativa/competitiva degli imperi.

---

## 3.9 Interfaccia utente, controllo del tempo e notifiche

**RF-UI-01**
Il sistema deve fornire una **mappa galattica** interattiva che mostri sistemi stellari, confini imperiali, rotte FTL e principali icone (flotte, eventi, ecc.).

**RF-UI-02**
Il sistema deve mettere a disposizione filtri di visualizzazione della mappa (almeno: mappa politica, mappa economica/risorse, mappa militare).

**RF-UI-03**
Il sistema deve includere schermate dedicate per: riepilogo impero, elenco pianeti, elenco flotte, ricerca tecnologica, diplomazia, log eventi.

**RF-UI-04**
Il giocatore deve poter controllare il **tempo di gioco** (pausa, velocità normale, velocità accelerate) in ogni momento.

**RF-UI-05**
Il sistema deve generare notifiche per eventi importanti (nuova ricerca completata, dichiarazione di guerra, crisi, mancanza grave di risorse), visualizzate in un’area dedicata.

**RF-UI-06**
Il sistema deve permettere al giocatore di configurare la visibilità/priorità di alcune categorie di notifiche (es. criticità vs informative).

**RF-UI-07**
Durante la pausa, il giocatore deve poter impartire qualunque comando di gioco (movimento flotte, costruzioni, scelte di eventi, ecc.), che verrà eseguito alla ripresa del tempo.

---

# 4. Requisiti non funzionali

## 4.1 Performance

**RNF-PERF-01**
Il sistema deve mantenere un framerate accettabile (target da definire nel documento tecnico) anche in late game con il numero massimo di sistemi e imperi IA previsto.

**RNF-PERF-02**
Il tempo di caricamento di una partita salvata non deve superare un limite prefissato (da definire tecnicamente) su hardware di riferimento.

**RNF-PERF-03**
Gli aggiornamenti della simulazione (tick) non devono introdurre pause percepibili all’utente in condizioni di carico normale.

## 4.2 Usabilità

**RNF-USA-01**
Il sistema deve fornire **tooltip contestuali** per tutti gli elementi di interfaccia con funzionalità non ovvie (icone, statistiche, modificatori).

**RNF-USA-02**
Il sistema deve includere una forma di **tutorial** (guidato o tramite suggerimenti iniziali) che introduca i concetti base di esplorazione, colonizzazione, economia e combattimento.

**RNF-USA-03**
Il numero di passaggi per accedere alle informazioni principali (risorse globali, stato di un pianeta, stato di una flotta) non deve superare i 2–3 click a partire dalla schermata principale di gioco.

## 4.3 Affidabilità

**RNF-AFF-01**
Il sistema deve prevenire la corruzione dei file di salvataggio tramite meccanismi appropriati (es. scrittura temporanea + sostituzione atomica).

**RNF-AFF-02**
In caso di crash, il sistema non deve lasciare lo stato del filesystem in condizioni incoerenti (salvataggi incompleti, file temporanei non gestiti).

## 4.4 Manutenibilità e modularità

**RNF-MAN-01**
L’architettura deve separare logicamente i moduli principali (galassia, IA, diplomazia, economia, eventi, UI) per facilitare la manutenzione e l’estensione.

**RNF-MAN-02**
I parametri di bilanciamento (costi risorse, output distretti, valori tecnologie, ecc.) devono essere centralizzati in configurazioni facilmente modificabili (es. file di dati, script).

## 4.5 Estendibilità / modding (opzionale)

**RNF-MOD-01**
Opzionale: il sistema dovrebbe supportare la definizione di contenuti (razze, eventi, tecnologie, tratti, ecc.) tramite file di configurazione esterni senza modificare il codice sorgente.

---

# 5. Casi d’uso (overview)

I casi d’uso dettagliati possono essere tenuti in un documento separato; qui li elenchiamo con una descrizione sintetica.

---

## UC-01 – Avviare una nuova partita

* **Attore primario:** Giocatore
* **Precondizioni:** Il gioco è avviato, il giocatore è nel menu principale.
* **Scenario principale:**

  1. Il giocatore seleziona “Nuova partita”.
  2. Il giocatore seleziona/crea il proprio impero.
  3. Il giocatore configura parametri di galassia e difficoltà.
  4. Il giocatore conferma.
  5. Il sistema genera la galassia e avvia la partita.

---

## UC-02 – Colonizzare un pianeta

* **Attore primario:** Giocatore
* **Precondizioni:** Esiste almeno un pianeta abitabile in un sistema controllato; il giocatore dispone di una nave colonia.
* **Scenario principale:**

  1. Il giocatore seleziona un pianeta abitabile.
  2. Il giocatore impartisce l’ordine di colonizzazione alla nave colonia.
  3. La nave raggiunge il pianeta e inizia la colonizzazione.
  4. La colonizzazione termina con successo.
  5. Il sistema aggiunge il pianeta alla lista delle colonie dell’impero.

---

## UC-03 – Dichiarare guerra a un impero IA

* **Attore primario:** Giocatore
* **Precondizioni:** Esiste almeno un impero IA conosciuto; il rapporto è tale da consentire la dichiarazione di guerra.
* **Scenario principale:**

  1. Il giocatore apre la schermata diplomatica dell’impero IA.
  2. Il giocatore seleziona l’azione “Dichiara guerra”.
  3. Il sistema mostra gli obiettivi di guerra disponibili (se previsti).
  4. Il giocatore conferma la dichiarazione di guerra.
  5. Il sistema imposta lo stato di guerra tra i due imperi e notifica entrambi.

---

## UC-04 – Progettare una nave (se designer attivo)

* **Attore primario:** Giocatore
* **Precondizioni:** Il giocatore ha sbloccato tecnologie per moduli nave.
* **Scenario principale:**

  1. Il giocatore apre il “Designer navi”.
  2. Il giocatore seleziona una classe di nave.
  3. Il giocatore configura moduli (armi, difese, utility).
  4. Il sistema calcola costo e potenza stimata della configurazione.
  5. Il giocatore salva il progetto, che diventa disponibile nei cantieri.

---

## UC-05 - Risolvere un evento

* **Attore primario:** Giocatore
* **Precondizioni:** Viene generato un evento in base allo stato di gioco (esplorazione, crisi, ecc.).
* **Scenario principale:**

  1. Il sistema mostra la finestra dell’evento con descrizione e opzioni.
  2. Il giocatore legge le opzioni disponibili.
  3. Il giocatore seleziona una opzione.
  4. Il sistema applica gli effetti corrispondenti (modifica risorse, relazioni, stabilità, ecc.).
  5. L'evento viene registrato nel log.

---

## Stato attuale prototipo 0.1.0-alpha

1. **Funzionalità completate**
   * Generazione galassia procedurale con stati di visibilità.
   * Simulazione clock + loop TTK, gestione colonie e risorse di base.
   * UI mappa 3D con pannelli modulabili (Colonie, Overview, Navi scientifiche, Flotte, Debug).
   * Controllo manuale delle navi scientifiche e gestione della fog-of-war.
2. **In corso**
   * Diplomazia avanzata, combattimenti, eventi complessi, salvataggi multipli.
   * Tutorial, onboarding e sistemi di IA strategica.
3. **Stack/Tooling**
   * Stato globale migrato a Redux Toolkit; Three.js per la mappa; pannelli ridimensionabili stile desktop.
